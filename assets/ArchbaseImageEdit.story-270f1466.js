import{a as C,j as a}from"./jsx-runtime-29545a09.js";import{b as xe,c as Ee,d as Ce,u as Ie,a as Se}from"./useArchbaseDataSource-0bdc03a6.js";import{D as U,u as Me}from"./useArchbaseDataSourceListener-cbed610e.js";import"./index-1076ae77.js";import{r as g,R as ae}from"./index-76fb7be0.js";import{u as Ne}from"./use-force-update-df6d2b99.js";import{I as Re}from"./Input-abb5d566.js";import{i as S}from"./i18next-a4b2730f.js";import{u as ze}from"./useArchbaseTheme-69c231ab.js";import{I as Ae}from"./IconX-8ec7c03b.js";import{B as de}from"./Button-45c30308.js";import{c as X}from"./createReactComponent-1d99d95b.js";import{T as K}from"./Text-052cbebe.js";import{u as Ve}from"./use-mantine-color-scheme-940af2ab.js";import{r as he,B as Be}from"./polymorphic-factory-e212381f.js";import{T as P}from"./Tooltip-6d7d1342.js";import{A as O}from"./ActionIcon-23bc393d.js";import{I as ke}from"./IconTrash-7ea9d6f5.js";import{i as $e}from"./isBase64-b94d2017.js";import{G as ee,C as j}from"./Grid-72b79d89.js";import{G as ce}from"./Group-ec80c87c.js";import{S as Te}from"./ScrollArea-d1e51cef.js";import{A as qe}from"./ArchbaseObjectInspector-39e1a2c0.js";import{p as De}from"./pessoasData-6b8000da.js";import"./lodash-4d0be66a.js";import"./_commonjsHelpers-de833af9.js";import"./index-83127612.js";import"./create-optional-context-e52a7171.js";import"./use-id-9525279e.js";import"./use-isomorphic-effect-f46ba680.js";import"./Loader-2934e180.js";import"./Transition-7fd90e94.js";import"./index-d3ea75b5.js";import"./use-reduced-motion-94535b68.js";import"./use-media-query-404d9c84.js";import"./use-did-update-4c7f685e.js";import"./UnstyledButton-6bceb5b8.js";import"./index-9d475cdf.js";import"./Mantine.context-0732ca39.js";import"./OptionalPortal-d3ff2b4f.js";import"./use-merged-ref-962e80ee.js";import"./DirectionProvider-3f93a9e9.js";import"./use-floating-auto-update-8b56efba.js";import"./get-style-object-71cabcb5.js";import"./Paper-9304c07a.js";import"./create-safe-context-978e3819.js";import"./get-sorted-breakpoints-91e0685a.js";import"./px-90b8b31c.js";import"./types-5decf4ed.js";var Fe=X("check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]),He=X("cloud-download","IconCloudDownload",[["path",{d:"M19 18a3.5 3.5 0 0 0 0 -7h-1a5 4.5 0 0 0 -11 -2a4.6 4.4 0 0 0 -2.1 8.4",key:"svg-0"}],["path",{d:"M12 13l0 9",key:"svg-1"}],["path",{d:"M9 19l3 3l3 -3",key:"svg-2"}]]),te=X("cloud-upload","IconCloudUpload",[["path",{d:"M7 18a4.6 4.4 0 0 1 0 -9a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7h-1",key:"svg-0"}],["path",{d:"M9 15l3 -3l3 3",key:"svg-1"}],["path",{d:"M12 12l0 9",key:"svg-2"}]]),Le=X("crop","IconCrop",[["path",{d:"M8 5v10a1 1 0 0 0 1 1h10",key:"svg-0"}],["path",{d:"M5 8h10a1 1 0 0 1 1 1v10",key:"svg-1"}]]),We=X("photo-edit","IconPhotoEdit",[["path",{d:"M15 8h.01",key:"svg-0"}],["path",{d:"M11 20h-4a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v4",key:"svg-1"}],["path",{d:"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l3 3",key:"svg-2"}],["path",{d:"M14 14l1 -1c.31 -.298 .644 -.497 .987 -.596",key:"svg-3"}],["path",{d:"M18.42 15.61a2.1 2.1 0 0 1 2.97 2.97l-3.39 3.42h-3v-3l3.42 -3.39z",key:"svg-4"}]]);const _e=25,ye=(r,e=!1,t,i)=>{return new Promise(async(o,s)=>{let l=document.createElement("img");l.src=r+"",l.crossOrigin="Anonymous";let d=t.quality/100,u=t.maintainAspectRatio;l.onload=()=>{var f=document.createElement("canvas");let c=f.getContext("2d"),p=l.width/l.height,x=t.maxWidth,m=t.maxHeight;i!=null&&i.getDimFromImage&&(x=l.width,m=l.height),u?(f.width=x,f.height=x/p,e&&(f.width=m*p,f.height=m)):(f.width=x,f.height=m),t.basicFilters&&(c.filter=n(t.basicFilters)),c.drawImage(l,0,0,f.width,f.height);let z=t.format;var R=f.toDataURL(`image/${z}`,d);o({dataUri:R,width:f.width,height:f.height})}}).then(o=>(t.maxHeight=o.height,t.maxWidth=o.width,{imageUri:o.dataUri,state:be(t,o.dataUri)}));function n(o){return Object.keys(o).map(s=>["blur"].includes(s)?`${s}(${o[s]}px)`:`${s}(${o[s]})`).join("")}},be=(r,e)=>(r.arrayCopiedImages.length<=_e?r.arrayCopiedImages.push({lastImage:e,width:r.maxWidth,height:r.maxHeight,quality:r.quality,format:r.format,originImageSrc:r.originImageSrc,basicFilters:r.basicFilters}):r.arrayCopiedImages[r.arrayCopiedImages.length-1]={lastImage:e,width:r.maxWidth,height:r.maxHeight,quality:r.quality,format:r.format,originImageSrc:r.originImageSrc,basicFilters:r.basicFilters},JSON.parse(JSON.stringify(r))),Ue=g.memo(r=>{const{onInputChangedEnd:e,onChangedDelayed:t,onChangedValue:i,delayMs:n,...o}=r,[s,l]=g.useState(r.value),d=g.useRef(),u=g.useRef(!0);g.useRef(!1),g.useEffect(()=>{if(t){if(u.current){u.current=!1;return}return clearTimeout(d.current),d.current=setTimeout(()=>{clearTimeout(d.current),t(s)},n||100),()=>{clearTimeout(d.current)}}},[s]);function f(c){["checkbox","radio"].includes(r.type)?(l(c.target.checked),i&&i(c.target.checked)):(l(c.target.value),i&&i(c.target.value))}return C(ae.Fragment,{children:[e&&a("input",{...o,className:o==null?void 0:o.className,style:o.style,value:r.value,onChange:f,onBlur:c=>{e(c.target.value)},onKeyDown:c=>{c.key=="Enter"&&e(s)}}),!e&&a("input",{...o,className:o==null?void 0:o.className,style:o.style,value:r.value,onChange:f})]})}),D=Ue,ue={contrast:1,blur:0,brightness:1,grayscale:0,invert:0,saturate:1,sepia:0},Pe=g.memo(({color:r,initialState:e=ue,changeFilter:t=()=>{}})=>{const[i,n]=g.useState(e);g.useEffect(()=>{n(e?JSON.parse(JSON.stringify({...i,...e})):ue)},[e]);function o(c){t({...i,contrast:c})}function s(c){t({...i,brightness:c})}function l(c){t({...i,grayscale:c})}function d(c){t({...i,saturate:c})}function u(c){t({...i,sepia:c})}function f(c){t({...i,blur:c})}return C("div",{children:[C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${S.t("Contrast")}`}),a("p",{className:"item-panel",children:(+i.contrast).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(D,{className:"input-range",onChangedDelayed:o,delayMs:100,onChangedValue:c=>{n({...i,contrast:c})},style:{maxWidth:"100%",width:"100%",color:r},type:"range",min:"0",max:"5",step:"0.01",value:i.contrast})}),C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${S.t("Brightness")}`}),a("p",{className:"item-panel",children:(+i.brightness).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(D,{className:"input-range",onChangedDelayed:s,onChangedValue:c=>{n({...i,brightness:c})},style:{maxWidth:"100%",width:"100%",color:r},type:"range",min:"0",max:"5",step:"0.01",value:i.brightness})}),C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${S.t("Grayscale")}`}),a("p",{className:"item-panel",children:(+i.grayscale).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(D,{className:"input-range",onChangedDelayed:l,onChangedValue:c=>{n({...i,grayscale:c})},style:{maxWidth:"100%",width:"100%",color:r},type:"range",min:"0",max:"5",step:"0.01",value:i.grayscale})}),C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${S.t("Saturate")}`}),a("p",{className:"item-panel",children:(+i.saturate).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(D,{className:"input-range",onChangedDelayed:d,onChangedValue:c=>{n({...i,saturate:c})},style:{maxWidth:"100%",width:"100%",color:r},type:"range",min:"0",max:"5",step:"0.01",value:i.saturate})}),C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${S.t("Sepia")}`}),a("p",{className:"item-panel",children:(+i.sepia).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(D,{className:"input-range",onChangedDelayed:u,onChangedValue:c=>{n({...i,sepia:c})},style:{maxWidth:"100%",width:"100%",color:r},type:"range",min:"0",max:"5",step:"0.01",value:i.sepia})}),C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${S.t("Blur")}`}),a("p",{className:"item-panel",children:(+i.blur).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(D,{className:"input-range",onChangedDelayed:f,onChangedValue:c=>{n({...i,blur:c})},style:{maxWidth:"100%",width:"100%",color:r},type:"range",min:"0",max:"5",step:"0.01",value:i.blur})})]})}),Oe=Pe;class Xe{constructor(e,t,i,n){var o=this;this.position=e,this.constraints=t,this.cursor=i,this.eventBus=n,this.el=document.createElement("div"),this.el.className="croppr-handle",this.el.style.cursor=i,this.el.addEventListener("mousedown",s);function s(u){u.stopPropagation(),document.addEventListener("mouseup",l),document.addEventListener("mousemove",d),o.eventBus.dispatchEvent(new CustomEvent("handlestart",{detail:{handle:o}}))}function l(u){u.stopPropagation(),document.removeEventListener("mouseup",l),document.removeEventListener("mousemove",d),o.eventBus.dispatchEvent(new CustomEvent("handleend",{detail:{handle:o}}))}function d(u){u.stopPropagation(),o.eventBus.dispatchEvent(new CustomEvent("handlemove",{detail:{mouseX:u.clientX,mouseY:u.clientY}}))}}}class ie{constructor(e,t,i,n){this.x1=e,this.y1=t,this.x2=i,this.y2=n}set(e=null,t=null,i=null,n=null){return this.x1=e??this.x1,this.y1=t??this.y1,this.x2=i??this.x2,this.y2=n??this.y2,this}width(){return Math.abs(this.x2-this.x1)}height(){return Math.abs(this.y2-this.y1)}resize(e,t,i=[0,0]){const n=this.x1+this.width()*i[0],o=this.y1+this.height()*i[1];return this.x1=n-e*i[0],this.y1=o-t*i[1],this.x2=this.x1+e,this.y2=this.y1+t,this}scale(e,t=[0,0]){const i=this.width()*e,n=this.height()*e;return this.resize(i,n,t),this}move(e=null,t=null){let i=this.width(),n=this.height();return e=e===null?this.x1:e,t=t===null?this.y1:t,this.x1=e,this.y1=t,this.x2=e+i,this.y2=t+n,this}getRelativePoint(e=[0,0]){const t=this.width()*e[0],i=this.height()*e[1];return[t,i]}getAbsolutePoint(e=[0,0]){const t=this.x1+this.width()*e[0],i=this.y1+this.height()*e[1];return[t,i]}constrainToRatio(e,t=[0,0],i="height"){if(e!==null){switch(this.width(),this.height(),i){case"height":this.resize(this.width(),this.width()*e,t);break;case"width":this.resize(this.height()*1/e,this.height(),t);break;default:this.resize(this.width(),this.width()*e,t)}return this}}constrainToBoundary(e,t,i=[0,0]){const[n,o]=this.getAbsolutePoint(i),s=n,l=o,d=e-n,u=t-o,f=-2*i[0]+1,c=-2*i[1]+1;let[p,x]=[null,null];switch(f){case-1:p=s;break;case 0:p=Math.min(s,d)*2;break;case 1:p=d;break}switch(c){case-1:x=l;break;case 0:x=Math.min(l,u)*2;break;case 1:x=u;break}if(this.width()>p){const m=p/this.width();this.scale(m,i)}if(this.height()>x){const m=x/this.height();this.scale(m,i)}return this}constrainToSize(e=null,t=null,i=null,n=null,o=[0,0],s=null){if(s&&(s>1?(e=t*1/s,n=n*s):s<1&&(t=e*s,i=n*1/s)),e&&this.width()>e){const l=e,d=s===null?this.height():t;this.resize(l,d,o)}if(t&&this.height()>t){const l=s===null?this.width():e,d=t;this.resize(l,d,o)}if(i&&this.width()<i){const l=i,d=s===null?this.height():n;this.resize(l,d,o)}if(n&&this.height()<n){const l=s===null?this.width():i,d=n;this.resize(l,d,o)}return this}}function je(r){r.addEventListener("touchstart",ne),r.addEventListener("touchend",ne),r.addEventListener("touchmove",ne)}function ne(r){r.preventDefault();const e=r.changedTouches[0],t={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"};e.target.dispatchEvent(new MouseEvent(t[r.type],{bubbles:!0,cancelable:!0,view:window,clientX:e.clientX,clientY:e.clientY,screenX:e.screenX,screenY:e.screenY}))}const Y=[{position:[0,0],constraints:[1,0,0,1],cursor:"nw-resize"},{position:[.5,0],constraints:[1,0,0,0],cursor:"n-resize"},{position:[1,0],constraints:[1,1,0,0],cursor:"ne-resize"},{position:[1,.5],constraints:[0,1,0,0],cursor:"e-resize"},{position:[1,1],constraints:[0,1,1,0],cursor:"se-resize"},{position:[.5,1],constraints:[0,0,1,0],cursor:"s-resize"},{position:[0,1],constraints:[0,0,1,1],cursor:"sw-resize"},{position:[0,.5],constraints:[0,0,0,1],cursor:"w-resize"}];class re{constructor(e,t,i=!1){if(this.options=re.parseOptions(t||{}),!e.nodeName&&(e=document.querySelector(e),e==null))throw"Unable to find element.";if(!e.getAttribute("src"))throw"Image src not provided.";this._initialized=!1,this._restore={parent:e.parentNode,element:e},i||(e.width===0||e.height===0?e.onload=()=>{this.initialize(e)}:this.initialize(e))}initialize(e){this.createDOM(e),this.options.convertToPixels(this.cropperEl),this.attachHandlerEvents(),this.attachRegionEvents(),this.attachOverlayEvents(),this.box=this.initializeBox(this.options),this.redraw(),this._initialized=!0,this.options.onInitialize!==null&&this.options.onInitialize(this)}createDOM(e){this.containerEl=document.createElement("div"),this.containerEl.className="croppr-container",this.eventBus=this.containerEl,je(this.containerEl),this.cropperEl=document.createElement("div"),this.cropperEl.className="croppr",this.imageEl=document.createElement("img"),this.imageEl.setAttribute("src",e.getAttribute("src")),this.imageEl.setAttribute("alt",e.getAttribute("alt")),this.imageEl.className="croppr-image",this.imageClippedEl=this.imageEl.cloneNode(),this.imageClippedEl.className="croppr-imageClipped",this.regionEl=document.createElement("div"),this.regionEl.innerHTML=new Array(9).fill(1).map(()=>'<div style="border: 1px dashed #fafafa"></div>').join(""),this.regionEl.className="croppr-region",this.overlayEl=document.createElement("div"),this.overlayEl.className="croppr-overlay";let t=document.createElement("div");t.className="croppr-handleContainer",this.handles=[];for(let i=0;i<Y.length;i++){const n=new Xe(Y[i].position,Y[i].constraints,Y[i].cursor,this.eventBus);this.handles.push(n),t.appendChild(n.el)}this.cropperEl.appendChild(this.imageEl),this.cropperEl.appendChild(this.imageClippedEl),this.cropperEl.appendChild(this.regionEl),this.cropperEl.appendChild(this.overlayEl),this.cropperEl.appendChild(t),this.containerEl.appendChild(this.cropperEl),e.parentElement.replaceChild(this.containerEl,e)}setImage(e){return this.imageEl.onload=()=>{this.box=this.initializeBox(this.options),this.redraw()},this.imageEl.src=e,this.imageClippedEl.src=e,this}destroy(){this._restore.parent.replaceChild(this._restore.element,this.containerEl)}initializeBox(e){const t=e.startSize.width,i=e.startSize.height;let n=new ie(0,0,t,i);n.constrainToRatio(e.aspectRatio,[.5,.5]);const o=e.minSize,s=e.maxSize;n.constrainToSize(s.width,s.height,o.width,o.height,[.5,.5],e.aspectRatio);const l=this.cropperEl.offsetWidth,d=this.cropperEl.offsetHeight;n.constrainToBoundary(l,d,[.5,.5]);const u=this.cropperEl.offsetWidth/2-n.width()/2,f=this.cropperEl.offsetHeight/2-n.height()/2;return n.move(u,f),n}redraw(){const e=Math.round(this.box.width()),t=Math.round(this.box.height()),i=Math.round(this.box.x1),n=Math.round(this.box.y1),o=Math.round(this.box.x2),s=Math.round(this.box.y2);window.requestAnimationFrame(()=>{this.regionEl.style.transform=`translate(${i}px, ${n}px)`,this.regionEl.style.width=e+"px",this.regionEl.style.height=t+"px",this.imageClippedEl.style.clip=`rect(${n}px, ${o}px, ${s}px, ${i}px)`;const l=this.box.getAbsolutePoint([.5,.5]),d=l[0]-this.cropperEl.offsetWidth/2>>31,u=l[1]-this.cropperEl.offsetHeight/2>>31,c=-2*((d^u)+u+u+4)+8;for(let p=0;p<this.handles.length;p++){let x=this.handles[p];const m=x.el.offsetWidth,z=x.el.offsetHeight,R=i+e*x.position[0]-m/2,E=n+t*x.position[1]-z/2;x.el.style.transform=`translate(${Math.round(R)}px, ${Math.round(E)}px)`,x.el.style.zIndex=c==p?5:4}})}attachHandlerEvents(){const e=this.eventBus;e.addEventListener("handlestart",this.onHandleMoveStart.bind(this)),e.addEventListener("handlemove",this.onHandleMoveMoving.bind(this)),e.addEventListener("handleend",this.onHandleMoveEnd.bind(this))}attachRegionEvents(){const e=this.eventBus;this.regionEl.addEventListener("mousedown",t),e.addEventListener("regionstart",this.onRegionMoveStart.bind(this)),e.addEventListener("regionmove",this.onRegionMoveMoving.bind(this)),e.addEventListener("regionend",this.onRegionMoveEnd.bind(this));function t(o){o.stopPropagation(),document.addEventListener("mouseup",n),document.addEventListener("mousemove",i),e.dispatchEvent(new CustomEvent("regionstart",{detail:{mouseX:o.clientX,mouseY:o.clientY}}))}function i(o){o.stopPropagation(),e.dispatchEvent(new CustomEvent("regionmove",{detail:{mouseX:o.clientX,mouseY:o.clientY}}))}function n(o){o.stopPropagation(),document.removeEventListener("mouseup",n),document.removeEventListener("mousemove",i),e.dispatchEvent(new CustomEvent("regionend",{detail:{mouseX:o.clientX,mouseY:o.clientY}}))}}attachOverlayEvents(){const t=this;let i=null;this.overlayEl.addEventListener("mousedown",n);function n(l){l.stopPropagation(),document.addEventListener("mouseup",s),document.addEventListener("mousemove",o);const d=t.cropperEl.getBoundingClientRect(),u=l.clientX-d.left,f=l.clientY-d.top;i=t.box,t.box=new ie(u,f,u+1,f+1),t.eventBus.dispatchEvent(new CustomEvent("handlestart",{detail:{handle:t.handles[4]}}))}function o(l){l.stopPropagation(),t.eventBus.dispatchEvent(new CustomEvent("handlemove",{detail:{mouseX:l.clientX,mouseY:l.clientY}}))}function s(l){if(l.stopPropagation(),document.removeEventListener("mouseup",s),document.removeEventListener("mousemove",o),t.box.width()===1&&t.box.height()===1){t.box=i;return}t.eventBus.dispatchEvent(new CustomEvent("handleend",{detail:{mouseX:l.clientX,mouseY:l.clientY}}))}}onHandleMoveStart(e){let t=e.detail.handle;const i=[1-t.position[0],1-t.position[1]];let[n,o]=this.box.getAbsolutePoint(i);this.activeHandle={handle:t,originPoint:i,originX:n,originY:o},this.options.onCropStart!==null&&this.options.onCropStart(this.getValue())}onHandleMoveMoving(e){let{mouseX:t,mouseY:i}=e.detail,n=this.cropperEl.getBoundingClientRect();t=t-n.left,i=i-n.top,t<0?t=0:t>n.width&&(t=n.width),i<0?i=0:i>n.height&&(i=n.height);let o=this.activeHandle.originPoint.slice();const s=this.activeHandle.originX,l=this.activeHandle.originY,d=this.activeHandle.handle,u=d.constraints[0]===1,f=d.constraints[1]===1,c=d.constraints[2]===1,p=d.constraints[3]===1,x=(p||f)&&(u||c);let m=p||f?s:this.box.x1,z=p||f?s:this.box.x2,R=u||c?l:this.box.y1,E=u||c?l:this.box.y2;m=p?t:m,z=f?t:z,R=u?i:R,E=c?i:E;let[I,N]=[!1,!1];if((p||f)&&(I=p?t>s:t<s),(u||c)&&(N=u?i>l:i<l),I){const k=m;m=z,z=k,o[0]=1-o[0]}if(N){const k=R;R=E,E=k,o[1]=1-o[1]}let B=new ie(m,R,z,E);if(this.options.aspectRatio){const k=this.options.aspectRatio;let $=!1;x?$=i>B.y1+k*B.width()||i<B.y2-k*B.width():(u||c)&&($=!0);const F=$?"width":"height";B.constrainToRatio(k,o,F)}const L=this.options.minSize,W=this.options.maxSize;B.constrainToSize(W.width,W.height,L.width,L.height,o,this.options.aspectRatio);const T=this.cropperEl.offsetWidth,_=this.cropperEl.offsetHeight;B.constrainToBoundary(T,_,o),this.box=B,this.redraw(),this.options.onCropMove!==null&&this.options.onCropMove(this.getValue())}onHandleMoveEnd(e){this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue())}onRegionMoveStart(e){let{mouseX:t,mouseY:i}=e.detail,n=this.cropperEl.getBoundingClientRect();t=t-n.left,i=i-n.top,this.currentMove={offsetX:t-this.box.x1,offsetY:i-this.box.y1},this.options.onCropStart!==null&&this.options.onCropStart(this.getValue())}onRegionMoveMoving(e){let{mouseX:t,mouseY:i}=e.detail,{offsetX:n,offsetY:o}=this.currentMove,s=this.cropperEl.getBoundingClientRect();t=t-s.left,i=i-s.top,this.box.move(t-n,i-o),this.box.x1<0&&this.box.move(0,null),this.box.x2>s.width&&this.box.move(s.width-this.box.width(),null),this.box.y1<0&&this.box.move(null,0),this.box.y2>s.height&&this.box.move(null,s.height-this.box.height()),this.redraw(),this.options.onCropMove!==null&&this.options.onCropMove(this.getValue())}onRegionMoveEnd(e){this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue())}getValue(e=null){if(e===null&&(e=this.options.returnMode),e=="real"){const t=this.imageEl.naturalWidth,i=this.imageEl.naturalHeight,{width:n,height:o}=this.imageEl.getBoundingClientRect(),s=t/n,l=i/o;return{x:Math.round(this.box.x1*s),y:Math.round(this.box.y1*l),width:Math.round(this.box.width()*s),height:Math.round(this.box.height()*l)}}else if(e=="ratio"){const{width:t,height:i}=this.imageEl.getBoundingClientRect();return{x:J(this.box.x1/t,3),y:J(this.box.y1/i,3),width:J(this.box.width()/t,3),height:J(this.box.height()/i,3)}}else if(e=="raw")return{x:Math.round(this.box.x1),y:Math.round(this.box.y1),width:Math.round(this.box.width()),height:Math.round(this.box.height())}}static parseOptions(e){const t={aspectRatio:null,maxSize:{width:null,height:null},minSize:{width:null,height:null},startSize:{width:100,height:100,unit:"%"},returnMode:"real",onInitialize:null,onCropStart:null,onCropMove:null,onCropEnd:null};let i=null;e.aspectRatio!==void 0&&(typeof e.aspectRatio=="number"?i=e.aspectRatio:e.aspectRatio instanceof Array&&(i=e.aspectRatio[1]/e.aspectRatio[0]));let n=null;e.maxSize!==void 0&&e.maxSize!==null&&(n={width:e.maxSize[0]||null,height:e.maxSize[1]||null,unit:e.maxSize[2]||"px"});let o=null;e.minSize!==void 0&&e.minSize!==null&&(o={width:e.minSize[0]||null,height:e.minSize[1]||null,unit:e.minSize[2]||"px"});let s=null;e.startSize!==void 0&&e.startSize!==null&&(s={width:e.startSize[0]||null,height:e.startSize[1]||null,unit:e.startSize[2]||"%"});let l=null;typeof e.onInitialize=="function"&&(l=e.onInitialize);let d=null;typeof e.onCropStart=="function"&&(d=e.onCropStart);let u=null;typeof e.onCropEnd=="function"&&(u=e.onCropEnd);let f=null;typeof e.onUpdate=="function"&&(console.warn("Croppr.js: `onUpdate` is deprecated and will be removed in the next major release. Please use `onCropMove` or `onCropEnd` instead."),f=e.onUpdate),typeof e.onCropMove=="function"&&(f=e.onCropMove);let c=null;if(e.returnMode!==void 0){const m=e.returnMode.toLowerCase();if(["real","ratio","raw"].indexOf(m)===-1)throw"Invalid return mode.";c=m}const p=function(m){const z=m.offsetWidth,R=m.offsetHeight,E=["maxSize","minSize","startSize"];for(let I=0;I<E.length;I++){const N=E[I];this[N]!==null&&(this[N].unit=="%"&&(this[N].width!==null&&(this[N].width=this[N].width/100*z),this[N].height!==null&&(this[N].height=this[N].height/100*R)),delete this[N].unit)}},x=(m,z)=>m!==null?m:z;return{aspectRatio:x(i,t.aspectRatio),maxSize:x(n,t.maxSize),minSize:x(o,t.minSize),startSize:x(s,t.startSize),returnMode:x(c,t.returnMode),onInitialize:x(l,t.onInitialize),onCropStart:x(d,t.onCropStart),onCropMove:x(f,t.onCropMove),onCropEnd:x(u,t.onCropEnd),convertToPixels:p}}}function J(r,e){return+(Math.round(r+"e"+e)+"e-"+e)}class Ye extends re{constructor(e,t,i=!1){super(e,t,i)}getValue(e){return super.getValue(e)}setImage(e){return super.setImage(e)}destroy(){return super.destroy()}moveTo(e,t){return this.box.move(e,t),this.redraw(),this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue()),this}resizeTo(e,t,i=[.5,.5]){this.box.resize(e,t,i);const n=this.cropperEl.offsetWidth,o=this.cropperEl.offsetHeight;return this.box.constrainToBoundary(n,o,[.5,.5]),this.redraw(),this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue()),this}scaleBy(e,t=[.5,.5]){return this.box.scale(e,t),this.redraw(),this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue()),this}reset(e){return e&&(this.options={...this.options,newOptions:e}),this.box=this.initializeBox(this.options),this.redraw(),this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue()),this}enableVisibility(e){let t=document.querySelector(".croppr-container");if(!t)throw new Error("THere is not any croppr");e?t.style.display="block":t.style.display="none"}}const oe=g.memo(({src:r,size:e,croppUpdate:t})=>{const[i,n]=g.useState(),[o,s]=g.useState({width:150,height:150}),l=g.useRef(null),d=g.useRef();return g.useEffect(()=>{e&&(s({...e}),l.current&&l.current.resizeTo(e.width,e.height))},[e]),g.useEffect(()=>{r&&n(r)},[r]),g.useEffect(()=>(d.current&&i&&(l.current=new Ye("#croppr",{minSize:[32,32,"px"],startSize:[o.width,o.height,"px"],onInitialize:u=>{t(u==null?void 0:u.getValue())},onCropEnd:u=>{t(u)}})),()=>{var u;return(u=l==null?void 0:l.current)==null?void 0:u.destroy()}),[d.current,i]),a("div",{className:"ArchbaseCropprWrapper",children:a("img",{ref:d,src:i,id:"croppr"})})});try{oe.displayName="ArchbaseCropperWrapper",oe.__docgenInfo={description:"",displayName:"ArchbaseCropperWrapper",props:{src:{defaultValue:null,description:"",name:"src",required:!0,type:{name:"string"}},size:{defaultValue:null,description:"",name:"size",required:!0,type:{name:"any"}},croppUpdate:{defaultValue:null,description:"",name:"croppUpdate",required:!0,type:{name:"(data: { x: number; y: number; width: number; height: number; }) => void"}}}}}catch{}const Je=g.memo(({activeIndex:r=0,children:e,backgroundColor:t="inherit",color:i="#428CFF",indicatorStyle:n="bottomLine",onTabChange:o=f=>{},transitionMs:s=375,borderLine:l=!1,fontColor:d="inherit",lazy:u=!1})=>{const[f,c]=g.useState([]),[p,x]=g.useState(r),m=g.useRef(null);g.useEffect(()=>{const E=e instanceof Array?e:[e];z(E);const I=E.map(N=>({label:N.props.name,icon:N.props.icon,disabled:N.props.disabled}));if(r>I.length-1||r<0)throw new Error(`Intervalo inválido para activeIndex ${r}`);c(I)},[e]),g.useEffect(()=>{var I,N;const E=e instanceof Array?e:[e];if(r>E.length-1||r<0)throw new Error(`Intervalo inválido para activeIndex ${r}`);x((N=(I=E[r])==null?void 0:I.props)!=null&&N.disabled?0:r)},[r]),g.useEffect(()=>{f&&f.length&&o(p)},[p]);function z(E){try{E.map(I=>{if(!I.props.name)throw new Error("Dentro do componente TabContainer só pode ser renderizado o componente TabItem e precisa de um suporte de nome");return!0})}catch{throw new Error("O componente TabContainer deve ter um TabItem como componente filho")}}const R=e instanceof Array?e:[e];return C("div",{ref:m,className:"tab-pp",children:[a("div",{className:"header",style:{backgroundColor:t,borderBottom:l?"1px solid #323232":"undet"},children:f.map((E,I)=>C("button",{onClick:()=>{E.disabled||x(I)},style:{color:I==p&&(n==="simple"||n==="bottomLine")?i:d,backgroundColor:I==p&&n==="button"?i:"inherit"},className:I==p?`itemlabel ${n} active`:"itemlabel",disabled:E.disabled,children:[E.icon," ",E.label,n==="bottomLine"&&a("div",{style:{backgroundColor:i}})]},E.label))}),a("div",{className:"body",children:R.map((E,I)=>I<p?a("div",{style:{transform:"translate3d(-100%, 0px, 0px)",height:"0px",overflow:"hidden",transition:`transform ${s/1e3}s ease`},className:"body-content",children:!u&&E},I):I>p?a("div",{style:{transform:"translate3d(100%, 0px, 0px)",height:"0px",overflow:"hidden",transition:`transform ${s/1e3}s ease`},className:"body-content",children:!u&&E},I):a("div",{style:{visibility:"inherit",overflow:"auto",height:"auto",position:"relative",transition:`transform ${s/1e3}s ease`},className:"body-content",children:E},I))})]})}),Q=g.memo(({name:r,children:e,icon:t=null,type:i="TabItem",disabled:n=!1})=>a("div",{style:{padding:"1rem 0.5rem"},children:e})),Ge=Je;try{Q.displayName="TabItem",Q.__docgenInfo={description:"",displayName:"TabItem",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"string | Element"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"string"}}}}}catch{}const Ke={quality:92,maxHeight:1e3,maxWidth:1e3,cropHeight:150,cropWidth:150,maintainAspectRatio:!0,format:"png",arrayCopiedImages:[],originImageSrc:""},Qe=g.memo(({image:r="",color:e="#1e88e5",initialState:t=Ke,saveUpdates:i=()=>{}})=>{const[n,o]=g.useState(t),[s,l]=g.useState(""),[d,u]=g.useState(!1),[f,c]=g.useState({width:150,height:150}),[p,x]=g.useState(),m=g.useRef(!1),z=["webp","jpeg","png"];g.useEffect(()=>{m.current=window.innerWidth<800,o(JSON.parse(JSON.stringify({...n,...t})))},[t]),g.useEffect(()=>{l(r)},[r]),g.useEffect(()=>{d||c({width:150,height:150})},[d]);async function R(h,y=!1){try{const{state:b,imageUri:v}=await ye(n.originImageSrc,y,h);l(v),o(b)}catch(b){console.log("🚀 ~ file: EditImage.tsx ~ line 73 ~ applyChanges ~ error",b)}}async function E(h){h=Math.max(Math.min(h,100),1);const y={...n,quality:h};o(y);try{await R(y,!1)}catch(b){console.log("onUpdateQuality ~ error",b)}}async function I(h,y=!1){const b=Math.max(Math.min(h,4e3),32),v={...n};if(y){if(v.maxHeight===b)return;v.maxHeight=b}else{if(v.maxWidth===b)return;v.maxWidth=b}o(v);try{await R(v,y)}catch(M){console.log("onChangeSize ~ error",M)}}async function N(h){const y={...n,format:h.target.value};try{o(y),await R(y,!1)}catch(b){console.log("onChangeFormat ~ error",b)}}function B(h,y){h&&(o({...n,cropWidth:h}),c({...f,width:h})),y&&(o({...n,cropHeight:y}),c({...f,height:y}))}function L(){let h=F(n);const y=document.createElement("canvas");return new Promise((b,v)=>{const M=y.getContext("2d"),V=new Image;V.src=s,V.onload=()=>{const w=p==null?void 0:p.width,q=p==null?void 0:p.height;return y.height=q,y.width=w,M.drawImage(V,Math.abs(p==null?void 0:p.x),Math.abs(p==null?void 0:p.y),p==null?void 0:p.width,p==null?void 0:p.height,0,0,p==null?void 0:p.width,p==null?void 0:p.height),b(y.toDataURL(`image/${h.format}`,h.quality))},V.onerror=w=>{v(w)}}).then(b=>{h.maxWidth=y.width,h.maxHeight=y.height,h.originImageSrc=b,h=be(h,b),o(h),l(b),u(!1)}).catch(b=>{console.log(b)})}function W(h){x(h),o({...n,cropHeight:h.height,cropWidth:h.width})}function T(h=!1){u(!1),i(h?{state:n,imageSrc:s}:null)}async function _(){try{let h=F(n);if(h.arrayCopiedImages.length>1){h.arrayCopiedImages.pop();const y=h.arrayCopiedImages[h.arrayCopiedImages.length-1];h={...n,arrayCopiedImages:h.arrayCopiedImages,maxHeight:y.height,maxWidth:y.width,quality:y.quality,format:y.format,originImageSrc:y.originImageSrc,basicFilters:y.basicFilters},o(h),l(y.lastImage)}}catch(h){console.log("🚀 ~ file: edit-image.component.ts ~ line 126 ~ EditImageComponent ~ onRestore ~ e",h)}}async function k(h){try{const y=F(n);y.basicFilters?y.basicFilters={...y.basicFilters,...h}:y.basicFilters=h,await R(y,!1)}catch(y){console.log("🚀 ~ file: EditImage.tsx ~ line 259 ~ onChangeFilters ~ e",y)}}const $=g.useMemo(()=>s&&s.length?Math.ceil(3/4*s.length/1024):"",[s]);function F(h){return JSON.parse(JSON.stringify(h))}return a("div",{className:"ArchbaseEditImage",children:C("div",{id:"popup",className:"popup",children:[a("div",{style:{flexDirection:"row",boxSizing:"border-box",display:"flex",placeContent:"center flex-end",alignItems:"center",padding:"0px 16px"},children:a("button",{className:"icon-btn",onClick:()=>{T(!1)},children:a("span",{className:"material-icons",children:a(Ae,{})})})}),C("div",{className:"image-container",children:[C("div",{className:"image-holder-full",children:[!d&&a("img",{id:"image-full",src:s}),d&&a(oe,{src:s,size:f,croppUpdate:W})]}),C("div",{className:"control-panel",children:[C(Ge,{lazy:!0,borderLine:!0,children:[C(Q,{name:`${S.t("Basic")}`,children:[(!m.current||m.current&&!d)&&C(ae.Fragment,{children:[C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${S.t("Quality")}`}),a("p",{className:"item-panel",children:n.quality+"%"})]}),a("div",{className:"flex-row-start",children:a(D,{readOnly:d,disabled:d,className:"input-range",onChangedDelayed:E,onChangedValue:h=>{o({...n,quality:h})},style:{maxWidth:"100%",width:"100%",color:e},type:"range",min:1,max:100,value:n.quality})}),C("div",{className:"item-panel",style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[`${S.t("Max dimensions")}`,C("div",{style:{display:"flex",alignItems:"center"},children:[a("input",{disabled:d,readOnly:d,type:"checkbox",checked:n.maintainAspectRatio,onChange:h=>o({...n,maintainAspectRatio:h.target.checked}),style:{color:e}}),a("span",{className:"caption",children:`${S.t("aspect-ratio")}`})]})]}),C("div",{className:"flex-row-start",style:{marginTop:"10px",justifyContent:"space-between"},children:[C("div",{className:"form-field",style:{maxWidth:"48%",width:"48%"},children:[a("label",{children:`${S.t("max-width(px)")}`}),a(D,{readOnly:d,disabled:d,placeholder:`${S.t("max-width(px)")}`,value:n.maxWidth,onChangedValue:h=>o({...n,maxWidth:h}),type:"number",min:0,max:2e3,onInputChangedEnd:h=>{I(h,!1)}})]}),C("div",{className:"form-field",style:{maxWidth:"48%",width:"48%"},children:[a("label",{children:`${S.t("max-height(px)")}`}),a(D,{readOnly:d,disabled:d,placeholder:`${S.t("max-height(px)")}`,value:n.maxHeight,onChangedValue:h=>o({...n,maxHeight:h}),type:"number",min:0,max:2e3,onInputChangedEnd:h=>{I(h,!0)}})]})]}),a("p",{className:"item-panel",children:`${S.t("Format")}`}),a("div",{className:"flex-row-start",style:{marginTop:"10px",justifyContent:"space-between"},children:a("div",{className:"form-field",style:{width:"100%"},children:a("select",{disabled:d,value:n.format,onChange:N,children:z.map((h,y)=>a("option",{value:h,children:h},y))})})})]}),a("div",{className:"flex-row-start",style:{marginTop:"5px",justifyContent:"space-between"},children:C("span",{style:{display:"flex",alignItems:"center"},children:[a("input",{type:"checkbox",onChange:h=>{u(h.target.checked)},checked:d,style:{color:e,marginBottom:"3px"}}),a("span",{className:"item-panel",style:{marginLeft:"4px"},children:`${S.t("Crop")}`})]})}),d&&C(ae.Fragment,{children:[C("div",{className:"flex-row-start",style:{marginTop:"10px",justifyContent:"space-between"},children:[C("div",{className:"form-field",style:{maxWidth:"48%",width:"48%"},children:[a("label",{children:`${S.t("width(px)")}`}),a(D,{type:"number",min:0,value:n.cropWidth,onChangedValue:h=>o({...n,cropWidth:h}),onInputChangedEnd:h=>{B(+h,null)},placeholder:`${S.t("width(px)")}`})]}),C("div",{className:"form-field",style:{maxWidth:"48%",width:"48%"},children:[a("label",{children:`${S.t("height(px)")}`}),a(D,{type:"number",min:0,value:n.cropHeight,onInputChangedEnd:h=>{B(null,+h)},onChangedValue:h=>o({...n,cropHeight:h}),placeholder:`${S.t("height(px)")}`})]})]}),a("p",{style:{marginBottom:"4px !important"},children:a(de,{onClick:L,leftSection:a(Le,{color:"orange"}),children:`${S.t("Crop")}`})})]})]}),a(Q,{disabled:d,name:`${S.t("Filters")}`,children:a(Oe,{color:e,initialState:n.basicFilters,changeFilter:k})})]}),a("button",{title:`${S.t("Undo")}`,disabled:n.arrayCopiedImages.length<=1,style:{position:"absolute",right:"10px",top:"30px"},className:"icon-btn",onClick:_,children:a("span",{className:"material-icons",children:`${S.t("Refresh")}`})}),C("div",{className:"flex-row-start",style:{marginTop:"10px",justifyContent:"space-between",alignItems:"center"},children:[a(de,{leftSection:a(Fe,{}),color:"green",onClick:()=>{T(!0)},children:`${S.t("archbase:Apply")}`}),$&&a("p",{className:"caption image-caption",style:{color:$>120?"#f44336":"unset",fontWeight:$>120?"500":"unset"},children:a(K,{children:`${S.t("archbase:size")}: ${$}Kb ${n.format}`})})]})]})]})]})})}),Ze=Qe;const et={objectFit:"cover",hideDeleteBtn:!1,hideDownloadBtn:!1,hideEditBtn:!1,hideAddBtn:!1,compressInitial:null},me={maxHeight:3e3,maxWidth:3e3,cropHeight:150,cropWidth:150,maintainAspectRatio:!0,format:"png",arrayCopiedImages:[],originImageSrc:"",basicFilters:void 0,quality:100},se=g.memo(({config:r={},imageSrcProp:e="",color:t="#1e88e5",imageChanged:i=()=>{}})=>{const n=ze(),{colorScheme:o}=Ve(),[s,l]=g.useState({...me}),[d,u]=g.useState(""),[f,c]=g.useState(!1),[p,x]=g.useState(!1),[m,z]=g.useState(et),R=g.useRef(null),E=g.useRef(""),I=g.useRef(""),N=Date.now().toString(20),B=g.useRef("download");g.useRef(!1),g.useEffect(()=>{W()},[r]),g.useEffect(()=>{L()},[e]);async function L(){if(e){const v=await F(e),M=v.state;M.originImageSrc=e,M.arrayCopiedImages=[{lastImage:v.imageUri,width:M.maxWidth,height:M.maxHeight,quality:M.quality,format:M.format,originImageSrc:e}],u(v.imageUri),l(M),c(!0)}else{const v={...s};v.originImageSrc=null,v.arrayCopiedImages=[],c(!1),u(null),l(v)}}g.useEffect(()=>{i(d)},[d]);function W(){const v={...m,...r};z(v)}function T(v){var M;v.preventDefault(),(M=R==null?void 0:R.current)==null||M.click()}function _(v){var V;const M=(V=v.target)==null?void 0:V.files;if(M){const w=M[0];if(B.current=w.name.split(".")[0],E.current=w.type,!E.current.includes("image"))return;if(I.current=`data:${w.type};base64,`,w){l({...s,format:E.current.split("image/")[1]});const q=new FileReader;q.onload=k.bind(this),q.readAsBinaryString(w)}}}async function k(v){const M=v.target.result,V=btoa(M);let w={...s};const q=I.current+V;if(w.originImageSrc=I.current+V,m.compressInitial){w={...w,quality:Math.min(m.compressInitial||92,100),maintainAspectRatio:!0,format:w.format?w.format:"png"};const A=await ye(w.originImageSrc,!1,w,{getDimFromImage:!0});l(A.state),u(A.imageUri),c(!0),m.onChangeImage&&m.onChangeImage(A.imageUri)}else{const A=document.createElement("img");A.src=q,A.onload=()=>{w.arrayCopiedImages=[],w.maxHeight=A.height,w.maxWidth=A.width,w.format=E.current.split("image/")[1],w.arrayCopiedImages.push({lastImage:q,width:A.width,height:A.height,quality:w.quality,format:E.current.split("image/")[1],originImageSrc:w.originImageSrc}),l(w),u(q),c(!0),m.onChangeImage&&m.onChangeImage(q)}}}const $=g.useMemo(()=>d&&d.length?Math.ceil(3/4*d.length/1024):"",[d]);function F(v){let M={...s},V;if(v.startsWith("data:image/")){const w=v.match(/data:image\/([a-zA-Z]+);base64,/);w&&w[1]?V=w[1]:V="png"}else{const w=v.split(".");V=w[w.length-1],["png","jpeg","webp"].includes(V)||(V="png")}if(M.format=V,r.compressInitial!=null){let w=1;r.compressInitial>=0&&r.compressInitial<=100&&(w=r.compressInitial),M.quality=w}return new Promise((w,q)=>{const A=document.createElement("img");A.crossOrigin="Anonymous",M.maxHeight=A.height,M.maxWidth=A.width,A.onload=()=>{const H=document.createElement("canvas"),ve=H.getContext("2d"),le=1;H.width=A.width*le,H.height=A.height*le,ve.drawImage(A,0,0,H.width,H.height),console.log(M.quality);const we=H.toDataURL(`image/${V}`,M.quality/100);return w({dataUri:we,width:H.width,height:H.height})},A.onerror=H=>q(H.message||`Error loading the src = ${v}`),A.src=v}).then(w=>(M={...M,maxHeight:w.height,maxWidth:w.width},{imageUri:w.dataUri,state:M}))}function h(){x(!0)}function y(v){x(!1),v&&(l(v.state),u(v.imageSrc),m.onChangeImage&&m.onChangeImage(v.imageSrc))}function b(){u(null),c(!1);const v={...s,...me};l(v),x(!1),m.onChangeImage&&m.onChangeImage(void 0)}return C("div",{className:"ArchbaseImagePickerEditor",children:[!f&&a("div",{className:"place-image",children:C("div",{className:"image-holder",style:{width:m.width,height:m.height,borderRadius:m.borderRadius,aspectRatio:m.aspectRatio+"",background:o==="dark"?n.colors.dark[7]:n.white,border:`${he(1)} solid ${o==="dark"?n.colors.dark[4]:n.colors.gray[3]}`},children:[a(P,{withinPortal:!0,withArrow:!0,label:`${S.t("archbase:Upload a image")}`,children:a(O,{component:"button",color:"blue",className:"icon-btn image-upload-btn",onClick:T,children:a(te,{color:"purple"})})}),a("input",{ref:R,type:"file",style:{display:"none"},id:"filePicker-"+N,onChange:_})]})}),f&&C("div",{className:"place-image",children:[C("div",{className:"image-holder-loaded",style:{width:m.width,height:m.height,borderRadius:m.borderRadius,aspectRatio:m.aspectRatio+"",background:o==="dark"?n.colors.dark[7]:n.white,border:`${he(1)} solid ${o==="dark"?n.colors.dark[4]:n.colors.gray[3]}`},children:[a("img",{src:d,alt:"image-loaded",style:{height:m.height,borderRadius:m.borderRadius,objectFit:m.objectFit,background:o==="dark"?n.colors.dark[7]:n.white}}),!m.hideEditBtn&&C(g.Fragment,{children:[a("div",{className:"curtain",onClick:T,children:a(P,{withinPortal:!0,withArrow:!0,label:`${S.t("archbase:Upload a image")}`,children:a(O,{component:"button",color:"blue",children:a(te,{color:"white"})})})}),a("input",{ref:R,type:"file",style:{display:"none"},id:"filePicker-"+N,onChange:_})]})]}),$&&m.showImageSize&&a("div",{className:"caption image-caption",style:{color:$>120?"#f44336":"unset",fontWeight:$>120?"500":"unset"},children:a(K,{children:`${S.t("archbase:size")}: ${$}Kb ${s.format}`})}),C("div",{style:{flexDirection:"row",boxSizing:"border-box",display:"flex",placeContent:"flex-start",alignItems:"flex-start"},className:"editing-bar-btn",children:[!m.hideAddBtn&&a(P,{withinPortal:!0,withArrow:!0,label:`${S.t("archbase:Upload a image")}`,children:a(O,{id:"upload-img",color:"blue",onClick:T,children:a(te,{color:"purple"})})}),!m.hideEditBtn&&a(P,{withinPortal:!0,withArrow:!0,label:`${S.t("archbase:Open the editor panel")}`,children:a(O,{id:"edit-img",color:"blue",onClick:h,children:a(We,{color:"teal"})})}),!m.hideDownloadBtn&&a(P,{withinPortal:!0,withArrow:!0,label:`${S.t("archbase:Download the image")}`,children:a(O,{component:"a",id:"download-img",href:d,color:"green",download:B.current,children:a(He,{color:"green"})})}),!m.hideDeleteBtn&&a(P,{withinPortal:!0,withArrow:!0,label:`${S.t("archbase:Remove")}`,children:a(O,{id:"delete-img",color:"red",onClick:()=>b(),children:a(ke,{color:"#C91A25"})})})]})]}),p&&a(Ze,{saveUpdates:y,color:t,image:d,initialState:s})]})});try{se.displayName="ArchbaseImagePickerEditor",se.__docgenInfo={description:"",displayName:"ArchbaseImagePickerEditor",props:{config:{defaultValue:null,description:"",name:"config",required:!0,type:{name:"ArchbaseImagePickerConf"}},imageSrcProp:{defaultValue:null,description:"",name:"imageSrcProp",required:!1,type:{name:"string"}},color:{defaultValue:null,description:"",name:"color",required:!1,type:{name:"string"}},imageChanged:{defaultValue:null,description:"",name:"imageChanged",required:!1,type:{name:"Function"}}}}}catch{}function Z({width:r=240,height:e=240,dataSource:t,dataField:i,disabled:n,readOnly:o,required:s,label:l,description:d,error:u,src:f,radius:c="4px",aspectRatio:p,objectFit:x="contain",compressInitial:m=80,onChangeImage:z,disabledBase64Convertion:R,innerRef:E,...I}){const[N,B]=g.useState(void 0),L=g.useRef(),[W,T]=g.useState(u),_=Ne();g.useEffect(()=>{T(void 0)},[N]);const k=()=>{let b=N;t&&i&&(b=t.getFieldValue(i),b||(b="")),$e(b)&&!R&&(b=atob(b)),B(b)},$=g.useCallback(()=>{k()},[]),F=g.useCallback(b=>{t&&i&&((b.type===U.dataChanged||b.type===U.recordChanged||b.type===U.afterScroll||b.type===U.afterCancel||b.type===U.afterEdit)&&(k(),_()),b.type===U.onFieldError&&b.fieldName===i&&T(b.error))},[]);xe(()=>{k(),t&&i&&(t.addListener(F),t.addFieldChangeListener(i,$))}),Ee(()=>{k()},[]),Ce(()=>{t&&i&&(t.removeListener(F),t.removeFieldChangeListener(i,$))});const h=b=>{const v=b;B(M=>v),t&&!t.isBrowsing()&&i&&t.getFieldValue(i)!==v&&(v?t.setFieldValue(i,R?v:btoa(v)):t.setFieldValue(i,void 0)),z&&z(b)},y=()=>{let b=o;return t&&!o&&(b=t.isBrowsing()),b};return a("div",{style:{position:"relative",display:"inline-block"},children:a(Re.Wrapper,{withAsterisk:s,label:l,description:d,error:W,ref:E||L,children:a(se,{imageSrcProp:N,config:{borderRadius:c,width:r,height:e,objectFit:x,compressInitial:m,showImageSize:!y(),hideDeleteBtn:y(),hideDownloadBtn:y(),hideEditBtn:y(),hideAddBtn:y(),onChangeImage:h}})})})}try{Z.displayName="ArchbaseImageEdit",Z.__docgenInfo={description:"",displayName:"ArchbaseImageEdit",props:{dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o valor do rich edit",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o valor do rich edit na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"Indicador se o rich edit está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"Indicador se o rich edit é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"Indicador se o preenchimento do rich edit é obrigatório",name:"required",required:!1,type:{name:"boolean"}},style:{defaultValue:null,description:"Estilo do checkbox",name:"style",required:!1,type:{name:"CSSProperties"}},label:{defaultValue:null,description:"Título do rich edit",name:"label",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"Descrição do rich edit",name:"description",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Último erro ocorrido no rich edit",name:"error",required:!1,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!1,type:{name:"string"}},src:{defaultValue:null,description:"Image src",name:"src",required:!1,type:{name:"string"}},alt:{defaultValue:null,description:"Texto alternativo da imagem, usado como título para espaço reservado se a imagem não foi carregada",name:"alt",required:!1,type:{name:"string"}},width:{defaultValue:{value:"240"},description:"Largura da imagem, padrão de 100%, não pode exceder 100%",name:"width",required:!1,type:{name:"string | number"}},height:{defaultValue:{value:"240"},description:"Altura da imagem, o padrão é a altura da imagem original ajustada para determinada largura",name:"height",required:!1,type:{name:"string | number"}},radius:{defaultValue:{value:"4px"},description:"Chave de theme.radius ou qualquer valor CSS válido para definir border-radius, 0 por padrão",name:"radius",required:!1,type:{name:"string | number"}},imageRef:{defaultValue:null,description:"Obter ref do elemento de imagem",name:"imageRef",required:!1,type:{name:"ForwardedRef<HTMLImageElement>"}},caption:{defaultValue:null,description:"Legenda da imagem, exibida abaixo da imagem",name:"caption",required:!1,type:{name:"ReactNode"}},aspectRatio:{defaultValue:null,description:"",name:"aspectRatio",required:!1,type:{name:"number"}},objectFit:{defaultValue:{value:"contain"},description:"",name:"objectFit",required:!1,type:{name:"enum",value:[{value:'"revert"'},{value:'"fill"'},{value:'"cover"'},{value:'"contain"'},{value:'"scale-down"'}]}},compressInitial:{defaultValue:{value:"80"},description:"",name:"compressInitial",required:!1,type:{name:"number"}},onChangeImage:{defaultValue:null,description:"",name:"onChangeImage",required:!1,type:{name:"(image: any) => void"}},disabledBase64Convertion:{defaultValue:null,description:"Desabilita conversão do conteúdo em base64 antes de salvar na fonte de dados",name:"disabledBase64Convertion",required:!1,type:{name:"boolean"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}}}}}catch{}const tt=()=>{const r=Ie(),{dataSource:e}=Se({initialData:it,name:"dsPessoas"});return e!=null&&e.isBrowsing()&&!(e!=null&&e.isEmpty())&&e.edit(),Me({dataSource:e,listener:t=>{switch(t.type){case U.fieldChanged:{r();break}}}}),C(ee,{children:[a(ee.Col,{offset:1,span:4,children:C(j,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[a(j.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:a(ce,{justify:"space-between",children:a(K,{fw:500,children:"Image Editor Component"})})}),a(Be,{style:{height:400},children:a(Z,{dataSource:e,dataField:"foto",width:140,height:150,label:"Foto",description:"teste",error:"tessss"})})]})}),a(ee.Col,{span:4,children:C(j,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[a(j.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:a(ce,{justify:"space-between",children:a(K,{fw:500,children:"DataSource dsPessoas"})})}),a(Te,{style:{height:500},children:a(qe,{data:e})})]})})]})},it=[De[0]],Qt={title:"Editores/Image Edit",component:Z},G={name:"Exemplo simples",render:()=>a(tt,{})};var pe,ge,fe;G.parameters={...G.parameters,docs:{...(pe=G.parameters)==null?void 0:pe.docs,source:{originalSource:`{
  name: 'Exemplo simples',
  render: () => <ArchbaseImageEditExample />
}`,...(fe=(ge=G.parameters)==null?void 0:ge.docs)==null?void 0:fe.source}}};export{G as Primary,Qt as default};
