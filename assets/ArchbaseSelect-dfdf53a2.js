import{j as U}from"./jsx-runtime-c9381026.js";import{l as D}from"./lodash-4d0be66a.js";import{r as o,R as Oe}from"./index-8b3efc3f.js";import{b as Re,d as xe,c as De}from"./useArchbaseDataSource-bc04723a.js";import"./index-9e992aa6.js";import{u as Ie}from"./use-uncontrolled-f56237fb.js";import{D as q,A as I}from"./useArchbaseDataSourceListener-92dd263c.js";import{S as Se}from"./Select-e1edca65.js";function Ae(r,d,n={leading:!1}){const[a,i]=o.useState(r),t=o.useRef(null),l=o.useRef(!0),s=()=>window.clearTimeout(t.current);o.useEffect(()=>s,[]);const p=o.useCallback(f=>{s(),l.current&&n.leading?i(f):t.current=window.setTimeout(()=>{l.current=!0,i(f)},d),l.current=!1},[n.leading]);return[a,p]}function Fe(r){let d=r.map(a=>a.group).filter((a,i,t)=>t.indexOf(a)===i),n=[];return d.forEach(a=>{const i={group:a,items:r.filter(t=>t.group===a).sort((t,l)=>t.label.localeCompare(l.label)).map(t=>({value:t.value,label:t.label,origin:t.origin!==void 0?t.origin:t.value}))};n.push(i)}),n}function Pe(r,d,n,a,i,t){if(!d&&!n&&!r)return[];if(r&&r instanceof I&&a&&i&&t){const l=r;l.first();const s=[];for(;!l.isEOF();)s.push({label:l.getFieldValue(t),value:i(l.getCurrentRecord()),origin:l.getCurrentRecord(),key:D.uniqueId("select")}),l.next();return l.first(),s}return r&&Array.isArray(r)&&r.length>0&&r[0].group?Fe(r):r||(n?Oe.Children.toArray(n).map(l=>{const{label:s,value:p,origin:f,...E}=l.props;return{label:s,value:p,origin:f!==void 0?f:p,key:D.uniqueId("select"),...E}}):d.map(l=>({label:a(l),value:i(l),origin:l,key:D.uniqueId("select")})))}function S({allowDeselect:r=!0,clearable:d=!0,dataSource:n,dataField:a,disabled:i=!1,debounceTime:t=500,readOnly:l=!1,placeholder:s,initialOptions:p=[],searchable:f=!1,label:E,description:W,error:G,icon:Q,iconWidth:Z,required:J,width:K,getOptionLabel:y,getOptionValue:A,optionsLabelField:F,onFocusEnter:P,onFocusExit:T,onSelectValue:N,onClick:X,value:b,defaultValue:Y,filter:Te,size:$,initiallyOpened:ee,itemComponent:C,dropdownOpened:ne,onDropdownOpen:ae,onDropdownClose:le,limit:w=1/0,nothingFound:re,zIndex:Ne,style:te={},dropdownPosition:ke,children:k,innerRef:oe,options:c,customGetDataSourceFieldValue:g,customSetDataSourceFieldValue:z,classNames:ue,styles:ie,converter:O,getConvertedOption:L}){const se=o.useRef(),[m,R]=o.useState(b),[de,ce]=Ae("",t),[pe,_]=o.useState(G),[fe,j]=o.useState(0),v=o.useRef(),[me,ye]=Ie({value:l,defaultValue:l,finalValue:!1}),[ve,qe]=o.useState(w),be=o.useMemo(()=>Pe(c,p,k,y,A,F),[fe,c,p,k,y,A,F]),x=e=>O&&e?O(e):e,Ve=(e,u)=>{const V=u&&u.origin?u.origin:e;R(ze=>V),n&&!n.isBrowsing()&&a&&(g?g():n.getFieldValue(a))!==x(V)&&(z?z(x(V)):n.setFieldValue(a,x(V))),N&&N(V,u?u.origin:void 0)},ge=e=>{T&&T(e)},he=e=>{P&&P(e)},Ee=e=>{v&&v.current&&v.current.scrollTop===v.current.scrollHeight-v.current.offsetHeight&&w!==1/0&&qe(u=>u+w)},Ce=({option:e,checked:u})=>{if(C)return U(C,{...e,checked:u})},we=C?{renderOption:({option:e,checked:u})=>Ce({option:e,checked:u})}:{};o.useEffect(()=>{_(void 0)},[m]);const h=async()=>{let e=b;n&&a&&!n.isEmpty()&&(e=g?g():n.getFieldValue(a),e||(e="")),L&&O&&e&&(e=await L(e)),R(e)},M=o.useCallback(()=>{h()},[]),H=o.useCallback(e=>{n&&a&&((e.type===q.dataChanged||e.type===q.recordChanged||e.type===q.afterScroll||e.type===q.afterCancel)&&h(),e.type===q.onFieldError&&e.fieldName===a&&(_(e.error),j(u=>u+1)))},[]),B=o.useCallback(e=>{n&&a&&e.type===q.dataChanged&&j(u=>u+1)},[]);return Re(()=>{h(),n&&a&&(n.addListener(H),n.addFieldChangeListener(a,M)),c&&c instanceof I&&c.addListener(B)}),o.useEffect(()=>{b!==void 0&&R(b)},[b]),xe(()=>{n&&a&&(n.removeListener(H),n.removeFieldChangeListener(a,M)),c&&c instanceof I&&c.removeListener(B)}),De(()=>{h()},[]),o.useEffect(()=>{let e=l;n&&!l&&(e=n.isBrowsing()),ye(e)},[n==null?void 0:n.isBrowsing()]),U(Se,{classNames:ue,style:te,styles:ie,allowDeselect:r,clearable:d,disabled:i,description:W,placeholder:s,searchable:f,maxDropdownHeight:280,ref:oe||se,label:E,error:pe,data:be,size:$,leftSection:Q,width:K,leftSectionWidth:Z,readOnly:me,required:J,onChange:(e,u)=>Ve(e,u),onClick:X,onBlur:ge,onFocus:he,value:m!==void 0?m:null,onSearchChange:ce,searchValue:m&&y?y(m):de,defaultValue:m&&y?y(m):Y||"",defaultDropdownOpened:ee,dropdownOpened:ne,onDropdownOpen:ae,onDropdownClose:le,limit:ve,nothingFoundMessage:re,scrollAreaProps:{viewportProps:{tabIndex:-1},viewportRef:v,onScrollPositionChange:Ee},...we})}S.displayName="ArchbaseSelect";try{S.displayName="ArchbaseSelect",S.__docgenInfo={description:"",displayName:"ArchbaseSelect",props:{allowDeselect:{defaultValue:{value:"true"},description:"Permite ou não delecionar um item",name:"allowDeselect",required:!1,type:{name:"boolean"}},clearable:{defaultValue:{value:"true"},description:"Indicador se permite limpar o select",name:"clearable",required:!1,type:{name:"boolean"}},dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o item selecionado",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o item selecionado na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},debounceTime:{defaultValue:{value:"500"},description:"Tempo de espero antes de realizar a busca",name:"debounceTime",required:!1,type:{name:"number"}},disabled:{defaultValue:{value:"false"},description:"Indicador se o select está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:{value:"false"},description:"Indicador se o select é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},style:{defaultValue:{value:"{}"},description:"Estilo do select",name:"style",required:!1,type:{name:"MantineStyleProp"}},placeholder:{defaultValue:null,description:"Texto explicativo do select",name:"placeholder",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"Título do select",name:"label",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"Descrição do select",name:"description",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Último erro ocorrido no select",name:"error",required:!1,type:{name:"string"}},searchable:{defaultValue:{value:"false"},description:"Permite pesquisar no select",name:"searchable",required:!1,type:{name:"boolean"}},icon:{defaultValue:null,description:"Icon a esquerda do select",name:"icon",required:!1,type:{name:"ReactNode"}},iconWidth:{defaultValue:null,description:"Largura do icone a esquerda do select",name:"iconWidth",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},value:{defaultValue:null,description:"Valor de entrada controlado",name:"value",required:!1,type:{name:"any"}},defaultValue:{defaultValue:null,description:"Valor padrão de entrada não controlado",name:"defaultValue",required:!1,type:{name:"any"}},filter:{defaultValue:null,description:"Função com base em quais itens no menu suspenso são filtrados",name:"filter",required:!1,type:{name:"(value: string, item: any) => boolean"}},size:{defaultValue:null,description:"Tamanho de entrada",name:"size",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},initiallyOpened:{defaultValue:null,description:"Estado aberto do menu suspenso inicial",name:"initiallyOpened",required:!1,type:{name:"boolean"}},itemComponent:{defaultValue:null,description:"Alterar renderizador de item",name:"itemComponent",required:!1,type:{name:"FC<any>"}},width:{defaultValue:null,description:"Largura do select",name:"width",required:!1,type:{name:"string | number"}},dropdownOpened:{defaultValue:null,description:"Estado do dropdown controlado",name:"dropdownOpened",required:!1,type:{name:"boolean"}},onDropdownOpen:{defaultValue:null,description:"Chamado quando o menu suspenso é aberto",name:"onDropdownOpen",required:!1,type:{name:"() => void"}},onDropdownClose:{defaultValue:null,description:"Chamado quando o menu suspenso é aberto",name:"onDropdownClose",required:!1,type:{name:"() => void"}},limit:{defaultValue:null,description:"Limite a quantidade de itens exibidos por vez para seleção pesquisável",name:"limit",required:!1,type:{name:"number"}},nothingFound:{defaultValue:null,description:"Rótulo nada encontrado",name:"nothingFound",required:!1,type:{name:"ReactNode"}},zIndex:{defaultValue:null,description:"Índice z dropdown",name:"zIndex",required:!1,type:{name:"ZIndex"}},dropdownPosition:{defaultValue:null,description:"Comportamento de posicionamento dropdown",name:"dropdownPosition",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"bottom"'},{value:'"flip"'}]}},onSelectValue:{defaultValue:null,description:"Evento quando um valor é selecionado",name:"onSelectValue",required:!1,type:{name:"(value: O, origin: any) => void"}},onClick:{defaultValue:null,description:"Evento de click",name:"onClick",required:!1,type:{name:"MouseEventHandler<HTMLInputElement>"}},onFocusExit:{defaultValue:null,description:"Evento quando o foco sai do select",name:"onFocusExit",required:!1,type:{name:"FocusEventHandler<T>"}},onFocusEnter:{defaultValue:null,description:"Evento quando o select recebe o foco",name:"onFocusEnter",required:!1,type:{name:"FocusEventHandler<T>"}},initialOptions:{defaultValue:{value:"[]"},description:"Opções de seleção iniciais",name:"initialOptions",required:!1,type:{name:"O[]"}},getOptionLabel:{defaultValue:null,description:"Function que retorna o label de uma opção",name:"getOptionLabel",required:!0,type:{name:"(option: O) => string"}},getOptionValue:{defaultValue:null,description:"Function que retorna o valor de uma opção",name:"getOptionValue",required:!0,type:{name:"(option: O) => string"}},children:{defaultValue:null,description:"Coleção de ArchbaseSelectItem[] que representam as opções do select",name:"children",required:!1,type:{name:"ReactNode | ReactNode[]"}},required:{defaultValue:null,description:"Indica se o select tem o preenchimento obrigatório",name:"required",required:!1,type:{name:"boolean"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}},options:{defaultValue:null,description:"Selecione os dados usados ​​para renderizar itens no menu suspenso",name:"options",required:!1,type:{name:"readonly (string | SelectItem)[] | ArchbaseDataSource<any, any>"}},optionsLabelField:{defaultValue:null,description:"",name:"optionsLabelField",required:!1,type:{name:"string"}},customGetDataSourceFieldValue:{defaultValue:null,description:"",name:"customGetDataSourceFieldValue",required:!1,type:{name:"() => any"}},customSetDataSourceFieldValue:{defaultValue:null,description:"",name:"customSetDataSourceFieldValue",required:!1,type:{name:"(value: any) => void"}},classNames:{defaultValue:null,description:"",name:"classNames",required:!1,type:{name:"Partial<Record<SelectStylesNames, string>> | ((theme: MantineTheme, props: SelectProps, ctx: unknown) => Partial<Record<SelectStylesNames, string>>)"}},styles:{defaultValue:null,description:"",name:"styles",required:!1,type:{name:"Partial<Record<SelectStylesNames, CSSProperties>> | ((theme: MantineTheme, props: SelectProps, ctx: unknown) => Partial<...>)"}},converter:{defaultValue:null,description:`Converte o valor antes de atribuir ao field do registro atual no datasource
Por exemplo: (obj) => obj.id para armazenar apenas o ID de um objeto`,name:"converter",required:!1,type:{name:"(value: O) => any"}},getConvertedOption:{defaultValue:null,description:`Function que busca o valor original antes de converter pelo valor de retorno do converter
Por exemplo: (id) => fetchObjectById(id) para converter ID de volta ao objeto`,name:"getConvertedOption",required:!1,type:{name:"(value: any) => Promise<O>"}}}}}catch{}export{S as A};
