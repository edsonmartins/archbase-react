import{a as E,j as a}from"./jsx-runtime-c9381026.js";import{b as Ee,c as Ce,d as Ie,u as Se,a as Me}from"./useArchbaseDataSource-c5d317be.js";import{D as P,u as Ne}from"./useArchbaseDataSourceListener-92dd263c.js";import"./index-9e992aa6.js";import{r as p,R as oe}from"./index-8b3efc3f.js";import{u as Re}from"./use-force-update-11fe72c1.js";import{I as ze}from"./Input-c2ac992d.js";import{i as M}from"./i18next-a4b2730f.js";import{u as Ae}from"./useArchbaseTheme-cf3712dc.js";import{I as Ve}from"./IconX-efebeb5f.js";import{B as he}from"./Button-115efac8.js";import{c as j}from"./createReactComponent-60e598cf.js";import{T as Q}from"./Text-f3cc4e22.js";import{u as Be}from"./use-mantine-color-scheme-bbd48c20.js";import{r as ce,B as ke}from"./polymorphic-factory-f5c952a9.js";import{T as O}from"./Tooltip-7fe9133b.js";import{A as X}from"./ActionIcon-2f3f1ee4.js";import{I as $e}from"./IconTrash-6b16e91d.js";import{i as Te}from"./isBase64-b94d2017.js";import{G as te}from"./Grid-a32d8833.js";import{C as Y}from"./Card-a798b247.js";import{G as ue}from"./Group-4c03121b.js";import{S as qe}from"./ScrollArea-0e2adf81.js";import{A as Fe}from"./ArchbaseObjectInspector-cc5955d4.js";import{p as De}from"./pessoasData-6b8000da.js";import"./lodash-4d0be66a.js";import"./_commonjsHelpers-de833af9.js";import"./index-1905cc86.js";import"./index-d0400ba7.js";import"./create-optional-context-86e78b6c.js";import"./use-id-3df0f1f4.js";import"./use-isomorphic-effect-aa890e3d.js";import"./Loader-7e5b6750.js";import"./Transition-31651d20.js";import"./index-a38d0dca.js";import"./use-reduced-motion-98306cff.js";import"./use-media-query-78751440.js";import"./use-did-update-bccd292e.js";import"./UnstyledButton-5ed8db2e.js";import"./index-9d475cdf.js";import"./Mantine.context-1df84d45.js";import"./OptionalPortal-a9cf30f8.js";import"./use-merged-ref-add91123.js";import"./DirectionProvider-1e219af7.js";import"./use-floating-auto-update-2dcf8019.js";import"./get-style-object-71cabcb5.js";import"./create-safe-context-941c9e18.js";import"./get-sorted-breakpoints-91e0685a.js";import"./px-90b8b31c.js";import"./Paper-4536b30f.js";import"./types-5decf4ed.js";var He=j("check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]),Le=j("cloud-download","IconCloudDownload",[["path",{d:"M19 18a3.5 3.5 0 0 0 0 -7h-1a5 4.5 0 0 0 -11 -2a4.6 4.4 0 0 0 -2.1 8.4",key:"svg-0"}],["path",{d:"M12 13l0 9",key:"svg-1"}],["path",{d:"M9 19l3 3l3 -3",key:"svg-2"}]]),ie=j("cloud-upload","IconCloudUpload",[["path",{d:"M7 18a4.6 4.4 0 0 1 0 -9a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7h-1",key:"svg-0"}],["path",{d:"M9 15l3 -3l3 3",key:"svg-1"}],["path",{d:"M12 12l0 9",key:"svg-2"}]]),We=j("crop","IconCrop",[["path",{d:"M8 5v10a1 1 0 0 0 1 1h10",key:"svg-0"}],["path",{d:"M5 8h10a1 1 0 0 1 1 1v10",key:"svg-1"}]]),_e=j("photo-edit","IconPhotoEdit",[["path",{d:"M15 8h.01",key:"svg-0"}],["path",{d:"M11 20h-4a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v4",key:"svg-1"}],["path",{d:"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l3 3",key:"svg-2"}],["path",{d:"M14 14l1 -1c.31 -.298 .644 -.497 .987 -.596",key:"svg-3"}],["path",{d:"M18.42 15.61a2.1 2.1 0 0 1 2.97 2.97l-3.39 3.42h-3v-3l3.42 -3.39z",key:"svg-4"}]]);const Ue=25,be=(s,e=!1,t,i)=>{return new Promise(async(o,r)=>{let l=document.createElement("img");l.src=s+"",l.crossOrigin="Anonymous";let h=t.quality/100,c=t.maintainAspectRatio;l.onload=()=>{var g=document.createElement("canvas");let m=g.getContext("2d"),u=l.width/l.height,v=t.maxWidth,C=t.maxHeight;i!=null&&i.getDimFromImage&&(v=l.width,C=l.height),c?(g.width=v,g.height=v/u,e&&(g.width=C*u,g.height=C)):(g.width=v,g.height=C),t.basicFilters&&(m.filter=n(t.basicFilters)),m.drawImage(l,0,0,g.width,g.height);let f=t.format;var A=g.toDataURL(`image/${f}`,h);o({dataUri:A,width:g.width,height:g.height})}}).then(o=>(t.maxHeight=o.height,t.maxWidth=o.width,{imageUri:o.dataUri,state:ve(t,o.dataUri)}));function n(o){return Object.keys(o).map(r=>["blur"].includes(r)?`${r}(${o[r]}px)`:`${r}(${o[r]})`).join("")}},ve=(s,e)=>(s.arrayCopiedImages.length<=Ue?s.arrayCopiedImages.push({lastImage:e,width:s.maxWidth,height:s.maxHeight,quality:s.quality,format:s.format,originImageSrc:s.originImageSrc,basicFilters:s.basicFilters}):s.arrayCopiedImages[s.arrayCopiedImages.length-1]={lastImage:e,width:s.maxWidth,height:s.maxHeight,quality:s.quality,format:s.format,originImageSrc:s.originImageSrc,basicFilters:s.basicFilters},JSON.parse(JSON.stringify(s))),Pe=p.memo(s=>{const{onInputChangedEnd:e,onChangedDelayed:t,onChangedValue:i,delayMs:n,...o}=s,[r,l]=p.useState(s.value),h=p.useRef(),c=p.useRef(!0);p.useRef(!1),p.useEffect(()=>{if(t){if(c.current){c.current=!1;return}return clearTimeout(h.current),h.current=setTimeout(()=>{clearTimeout(h.current),t(r)},n||100),()=>{clearTimeout(h.current)}}},[r]);function g(m){["checkbox","radio"].includes(s.type)?(l(m.target.checked),i&&i(m.target.checked)):(l(m.target.value),i&&i(m.target.value))}return E(oe.Fragment,{children:[e&&a("input",{...o,className:o==null?void 0:o.className,style:o.style,value:s.value,onChange:g,onBlur:m=>{e(m.target.value)},onKeyDown:m=>{m.key=="Enter"&&e(r)}}),!e&&a("input",{...o,className:o==null?void 0:o.className,style:o.style,value:s.value,onChange:g})]})}),F=Pe,me={contrast:1,blur:0,brightness:1,grayscale:0,invert:0,saturate:1,sepia:0},Oe=p.memo(({color:s,initialState:e=me,changeFilter:t=()=>{}})=>{const[i,n]=p.useState(e);p.useEffect(()=>{n(e?JSON.parse(JSON.stringify({...i,...e})):me)},[e]);function o(m){t({...i,contrast:m})}function r(m){t({...i,brightness:m})}function l(m){t({...i,grayscale:m})}function h(m){t({...i,saturate:m})}function c(m){t({...i,sepia:m})}function g(m){t({...i,blur:m})}return E("div",{children:[E("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Contrast")}`}),a("p",{className:"item-panel",children:(+i.contrast).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(F,{className:"input-range",onChangedDelayed:o,delayMs:100,onChangedValue:m=>{n({...i,contrast:m})},style:{maxWidth:"100%",width:"100%",color:s},type:"range",min:"0",max:"5",step:"0.01",value:i.contrast})}),E("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Brightness")}`}),a("p",{className:"item-panel",children:(+i.brightness).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(F,{className:"input-range",onChangedDelayed:r,onChangedValue:m=>{n({...i,brightness:m})},style:{maxWidth:"100%",width:"100%",color:s},type:"range",min:"0",max:"5",step:"0.01",value:i.brightness})}),E("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Grayscale")}`}),a("p",{className:"item-panel",children:(+i.grayscale).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(F,{className:"input-range",onChangedDelayed:l,onChangedValue:m=>{n({...i,grayscale:m})},style:{maxWidth:"100%",width:"100%",color:s},type:"range",min:"0",max:"5",step:"0.01",value:i.grayscale})}),E("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Saturate")}`}),a("p",{className:"item-panel",children:(+i.saturate).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(F,{className:"input-range",onChangedDelayed:h,onChangedValue:m=>{n({...i,saturate:m})},style:{maxWidth:"100%",width:"100%",color:s},type:"range",min:"0",max:"5",step:"0.01",value:i.saturate})}),E("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Sepia")}`}),a("p",{className:"item-panel",children:(+i.sepia).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(F,{className:"input-range",onChangedDelayed:c,onChangedValue:m=>{n({...i,sepia:m})},style:{maxWidth:"100%",width:"100%",color:s},type:"range",min:"0",max:"5",step:"0.01",value:i.sepia})}),E("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Blur")}`}),a("p",{className:"item-panel",children:(+i.blur).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(F,{className:"input-range",onChangedDelayed:g,onChangedValue:m=>{n({...i,blur:m})},style:{maxWidth:"100%",width:"100%",color:s},type:"range",min:"0",max:"5",step:"0.01",value:i.blur})})]})}),Xe=Oe;class je{constructor(e,t,i,n){var o=this;this.position=e,this.constraints=t,this.cursor=i,this.eventBus=n,this.el=document.createElement("div"),this.el.className="croppr-handle",this.el.style.cursor=i,this.el.addEventListener("mousedown",r);function r(c){c.stopPropagation(),document.addEventListener("mouseup",l),document.addEventListener("mousemove",h),o.eventBus.dispatchEvent(new CustomEvent("handlestart",{detail:{handle:o}}))}function l(c){c.stopPropagation(),document.removeEventListener("mouseup",l),document.removeEventListener("mousemove",h),o.eventBus.dispatchEvent(new CustomEvent("handleend",{detail:{handle:o}}))}function h(c){c.stopPropagation(),o.eventBus.dispatchEvent(new CustomEvent("handlemove",{detail:{mouseX:c.clientX,mouseY:c.clientY}}))}}}class ne{constructor(e,t,i,n){this.x1=e,this.y1=t,this.x2=i,this.y2=n}set(e=null,t=null,i=null,n=null){return this.x1=e??this.x1,this.y1=t??this.y1,this.x2=i??this.x2,this.y2=n??this.y2,this}width(){return Math.abs(this.x2-this.x1)}height(){return Math.abs(this.y2-this.y1)}resize(e,t,i=[0,0]){const n=this.x1+this.width()*i[0],o=this.y1+this.height()*i[1];return this.x1=n-e*i[0],this.y1=o-t*i[1],this.x2=this.x1+e,this.y2=this.y1+t,this}scale(e,t=[0,0]){const i=this.width()*e,n=this.height()*e;return this.resize(i,n,t),this}move(e=null,t=null){let i=this.width(),n=this.height();return e=e===null?this.x1:e,t=t===null?this.y1:t,this.x1=e,this.y1=t,this.x2=e+i,this.y2=t+n,this}getRelativePoint(e=[0,0]){const t=this.width()*e[0],i=this.height()*e[1];return[t,i]}getAbsolutePoint(e=[0,0]){const t=this.x1+this.width()*e[0],i=this.y1+this.height()*e[1];return[t,i]}constrainToRatio(e,t=[0,0],i="height"){if(e!==null){switch(this.width(),this.height(),i){case"height":this.resize(this.width(),this.width()*e,t);break;case"width":this.resize(this.height()*1/e,this.height(),t);break;default:this.resize(this.width(),this.width()*e,t)}return this}}constrainToBoundary(e,t,i=[0,0]){const[n,o]=this.getAbsolutePoint(i),r=n,l=o,h=e-n,c=t-o,g=-2*i[0]+1,m=-2*i[1]+1;let[u,v]=[null,null];switch(g){case-1:u=r;break;case 0:u=Math.min(r,h)*2;break;case 1:u=h;break}switch(m){case-1:v=l;break;case 0:v=Math.min(l,c)*2;break;case 1:v=c;break}if(this.width()>u){const C=u/this.width();this.scale(C,i)}if(this.height()>v){const C=v/this.height();this.scale(C,i)}return this}constrainToSize(e=null,t=null,i=null,n=null,o=[0,0],r=null){if(r&&(r>1?(e=t*1/r,n=n*r):r<1&&(t=e*r,i=n*1/r)),e&&this.width()>e){const l=e,h=r===null?this.height():t;this.resize(l,h,o)}if(t&&this.height()>t){const l=r===null?this.width():e,h=t;this.resize(l,h,o)}if(i&&this.width()<i){const l=i,h=r===null?this.height():n;this.resize(l,h,o)}if(n&&this.height()<n){const l=r===null?this.width():i,h=n;this.resize(l,h,o)}return this}}function Ye(s){s.addEventListener("touchstart",ae),s.addEventListener("touchend",ae),s.addEventListener("touchmove",ae)}function ae(s){s.preventDefault();const e=s.changedTouches[0],t={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"};e.target.dispatchEvent(new MouseEvent(t[s.type],{bubbles:!0,cancelable:!0,view:window,clientX:e.clientX,clientY:e.clientY,screenX:e.screenX,screenY:e.screenY}))}const J=[{position:[0,0],constraints:[1,0,0,1],cursor:"nw-resize"},{position:[.5,0],constraints:[1,0,0,0],cursor:"n-resize"},{position:[1,0],constraints:[1,1,0,0],cursor:"ne-resize"},{position:[1,.5],constraints:[0,1,0,0],cursor:"e-resize"},{position:[1,1],constraints:[0,1,1,0],cursor:"se-resize"},{position:[.5,1],constraints:[0,0,1,0],cursor:"s-resize"},{position:[0,1],constraints:[0,0,1,1],cursor:"sw-resize"},{position:[0,.5],constraints:[0,0,0,1],cursor:"w-resize"}];class le{constructor(e,t,i=!1){if(this.options=le.parseOptions(t||{}),!e.nodeName&&(e=document.querySelector(e),e==null))throw"Unable to find element.";if(!e.getAttribute("src"))throw"Image src not provided.";this._initialized=!1,this._restore={parent:e.parentNode,element:e},i||(e.width===0||e.height===0?e.onload=()=>{this.initialize(e)}:this.initialize(e))}initialize(e){this.createDOM(e),this.options.convertToPixels(this.cropperEl),this.attachHandlerEvents(),this.attachRegionEvents(),this.attachOverlayEvents(),this.box=this.initializeBox(this.options),this.redraw(),this._initialized=!0,this.options.onInitialize!==null&&this.options.onInitialize(this)}createDOM(e){this.containerEl=document.createElement("div"),this.containerEl.className="croppr-container",this.eventBus=this.containerEl,Ye(this.containerEl),this.cropperEl=document.createElement("div"),this.cropperEl.className="croppr",this.imageEl=document.createElement("img"),this.imageEl.setAttribute("src",e.getAttribute("src")),this.imageEl.setAttribute("alt",e.getAttribute("alt")),this.imageEl.className="croppr-image",this.imageClippedEl=this.imageEl.cloneNode(),this.imageClippedEl.className="croppr-imageClipped",this.regionEl=document.createElement("div"),this.regionEl.innerHTML=new Array(9).fill(1).map(()=>'<div style="border: 1px dashed #fafafa"></div>').join(""),this.regionEl.className="croppr-region",this.overlayEl=document.createElement("div"),this.overlayEl.className="croppr-overlay";let t=document.createElement("div");t.className="croppr-handleContainer",this.handles=[];for(let i=0;i<J.length;i++){const n=new je(J[i].position,J[i].constraints,J[i].cursor,this.eventBus);this.handles.push(n),t.appendChild(n.el)}this.cropperEl.appendChild(this.imageEl),this.cropperEl.appendChild(this.imageClippedEl),this.cropperEl.appendChild(this.regionEl),this.cropperEl.appendChild(this.overlayEl),this.cropperEl.appendChild(t),this.containerEl.appendChild(this.cropperEl),e.parentElement.replaceChild(this.containerEl,e)}setImage(e){return this.imageEl.onload=()=>{this.box=this.initializeBox(this.options),this.redraw()},this.imageEl.src=e,this.imageClippedEl.src=e,this}destroy(){this._restore.parent.replaceChild(this._restore.element,this.containerEl)}initializeBox(e){const t=e.startSize.width,i=e.startSize.height;let n=new ne(0,0,t,i);n.constrainToRatio(e.aspectRatio,[.5,.5]);const o=e.minSize,r=e.maxSize;n.constrainToSize(r.width,r.height,o.width,o.height,[.5,.5],e.aspectRatio);const l=this.cropperEl.offsetWidth,h=this.cropperEl.offsetHeight;n.constrainToBoundary(l,h,[.5,.5]);const c=this.cropperEl.offsetWidth/2-n.width()/2,g=this.cropperEl.offsetHeight/2-n.height()/2;return n.move(c,g),n}redraw(){const e=Math.round(this.box.width()),t=Math.round(this.box.height()),i=Math.round(this.box.x1),n=Math.round(this.box.y1),o=Math.round(this.box.x2),r=Math.round(this.box.y2);window.requestAnimationFrame(()=>{this.regionEl.style.transform=`translate(${i}px, ${n}px)`,this.regionEl.style.width=e+"px",this.regionEl.style.height=t+"px",this.imageClippedEl.style.clip=`rect(${n}px, ${o}px, ${r}px, ${i}px)`;const l=this.box.getAbsolutePoint([.5,.5]),h=l[0]-this.cropperEl.offsetWidth/2>>31,c=l[1]-this.cropperEl.offsetHeight/2>>31,m=-2*((h^c)+c+c+4)+8;for(let u=0;u<this.handles.length;u++){let v=this.handles[u];const C=v.el.offsetWidth,f=v.el.offsetHeight,A=i+e*v.position[0]-C/2,w=n+t*v.position[1]-f/2;v.el.style.transform=`translate(${Math.round(A)}px, ${Math.round(w)}px)`,v.el.style.zIndex=m==u?5:4}})}attachHandlerEvents(){const e=this.eventBus;e.addEventListener("handlestart",this.onHandleMoveStart.bind(this)),e.addEventListener("handlemove",this.onHandleMoveMoving.bind(this)),e.addEventListener("handleend",this.onHandleMoveEnd.bind(this))}attachRegionEvents(){const e=this.eventBus;this.regionEl.addEventListener("mousedown",t),e.addEventListener("regionstart",this.onRegionMoveStart.bind(this)),e.addEventListener("regionmove",this.onRegionMoveMoving.bind(this)),e.addEventListener("regionend",this.onRegionMoveEnd.bind(this));function t(o){o.stopPropagation(),document.addEventListener("mouseup",n),document.addEventListener("mousemove",i),e.dispatchEvent(new CustomEvent("regionstart",{detail:{mouseX:o.clientX,mouseY:o.clientY}}))}function i(o){o.stopPropagation(),e.dispatchEvent(new CustomEvent("regionmove",{detail:{mouseX:o.clientX,mouseY:o.clientY}}))}function n(o){o.stopPropagation(),document.removeEventListener("mouseup",n),document.removeEventListener("mousemove",i),e.dispatchEvent(new CustomEvent("regionend",{detail:{mouseX:o.clientX,mouseY:o.clientY}}))}}attachOverlayEvents(){const t=this;let i=null;this.overlayEl.addEventListener("mousedown",n);function n(l){l.stopPropagation(),document.addEventListener("mouseup",r),document.addEventListener("mousemove",o);const h=t.cropperEl.getBoundingClientRect(),c=l.clientX-h.left,g=l.clientY-h.top;i=t.box,t.box=new ne(c,g,c+1,g+1),t.eventBus.dispatchEvent(new CustomEvent("handlestart",{detail:{handle:t.handles[4]}}))}function o(l){l.stopPropagation(),t.eventBus.dispatchEvent(new CustomEvent("handlemove",{detail:{mouseX:l.clientX,mouseY:l.clientY}}))}function r(l){if(l.stopPropagation(),document.removeEventListener("mouseup",r),document.removeEventListener("mousemove",o),t.box.width()===1&&t.box.height()===1){t.box=i;return}t.eventBus.dispatchEvent(new CustomEvent("handleend",{detail:{mouseX:l.clientX,mouseY:l.clientY}}))}}onHandleMoveStart(e){let t=e.detail.handle;const i=[1-t.position[0],1-t.position[1]];let[n,o]=this.box.getAbsolutePoint(i);this.activeHandle={handle:t,originPoint:i,originX:n,originY:o},this.options.onCropStart!==null&&this.options.onCropStart(this.getValue())}onHandleMoveMoving(e){let{mouseX:t,mouseY:i}=e.detail,n=this.cropperEl.getBoundingClientRect();t=t-n.left,i=i-n.top,t<0?t=0:t>n.width&&(t=n.width),i<0?i=0:i>n.height&&(i=n.height);let o=this.activeHandle.originPoint.slice();const r=this.activeHandle.originX,l=this.activeHandle.originY,h=this.activeHandle.handle,c=h.constraints[0]===1,g=h.constraints[1]===1,m=h.constraints[2]===1,u=h.constraints[3]===1,v=(u||g)&&(c||m);let C=u||g?r:this.box.x1,f=u||g?r:this.box.x2,A=c||m?l:this.box.y1,w=c||m?l:this.box.y2;C=u?t:C,f=g?t:f,A=c?i:A,w=m?i:w;let[I,z]=[!1,!1];if((u||g)&&(I=u?t>r:t<r),(c||m)&&(z=c?i>l:i<l),I){const T=C;C=f,f=T,o[0]=1-o[0]}if(z){const T=A;A=w,w=T,o[1]=1-o[1]}let B=new ne(C,A,f,w);if(this.options.aspectRatio){const T=this.options.aspectRatio;let $=!1;v?$=i>B.y1+T*B.width()||i<B.y2-T*B.width():(c||m)&&($=!0);const q=$?"width":"height";B.constrainToRatio(T,o,q)}const D=this.options.minSize,_=this.options.maxSize;B.constrainToSize(_.width,_.height,D.width,D.height,o,this.options.aspectRatio);const U=this.cropperEl.offsetWidth,H=this.cropperEl.offsetHeight;B.constrainToBoundary(U,H,o),this.box=B,this.redraw(),this.options.onCropMove!==null&&this.options.onCropMove(this.getValue())}onHandleMoveEnd(e){this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue())}onRegionMoveStart(e){let{mouseX:t,mouseY:i}=e.detail,n=this.cropperEl.getBoundingClientRect();t=t-n.left,i=i-n.top,this.currentMove={offsetX:t-this.box.x1,offsetY:i-this.box.y1},this.options.onCropStart!==null&&this.options.onCropStart(this.getValue())}onRegionMoveMoving(e){let{mouseX:t,mouseY:i}=e.detail,{offsetX:n,offsetY:o}=this.currentMove,r=this.cropperEl.getBoundingClientRect();t=t-r.left,i=i-r.top,this.box.move(t-n,i-o),this.box.x1<0&&this.box.move(0,null),this.box.x2>r.width&&this.box.move(r.width-this.box.width(),null),this.box.y1<0&&this.box.move(null,0),this.box.y2>r.height&&this.box.move(null,r.height-this.box.height()),this.redraw(),this.options.onCropMove!==null&&this.options.onCropMove(this.getValue())}onRegionMoveEnd(e){this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue())}getValue(e=null){if(e===null&&(e=this.options.returnMode),e=="real"){const t=this.imageEl.naturalWidth,i=this.imageEl.naturalHeight,{width:n,height:o}=this.imageEl.getBoundingClientRect(),r=t/n,l=i/o;return{x:Math.round(this.box.x1*r),y:Math.round(this.box.y1*l),width:Math.round(this.box.width()*r),height:Math.round(this.box.height()*l)}}else if(e=="ratio"){const{width:t,height:i}=this.imageEl.getBoundingClientRect();return{x:G(this.box.x1/t,3),y:G(this.box.y1/i,3),width:G(this.box.width()/t,3),height:G(this.box.height()/i,3)}}else if(e=="raw")return{x:Math.round(this.box.x1),y:Math.round(this.box.y1),width:Math.round(this.box.width()),height:Math.round(this.box.height())}}static parseOptions(e){const t={aspectRatio:null,maxSize:{width:null,height:null},minSize:{width:null,height:null},startSize:{width:100,height:100,unit:"%"},returnMode:"real",onInitialize:null,onCropStart:null,onCropMove:null,onCropEnd:null};let i=null;e.aspectRatio!==void 0&&(typeof e.aspectRatio=="number"?i=e.aspectRatio:e.aspectRatio instanceof Array&&(i=e.aspectRatio[1]/e.aspectRatio[0]));let n=null;e.maxSize!==void 0&&e.maxSize!==null&&(n={width:e.maxSize[0]||null,height:e.maxSize[1]||null,unit:e.maxSize[2]||"px"});let o=null;e.minSize!==void 0&&e.minSize!==null&&(o={width:e.minSize[0]||null,height:e.minSize[1]||null,unit:e.minSize[2]||"px"});let r=null;e.startSize!==void 0&&e.startSize!==null&&(r={width:e.startSize[0]||null,height:e.startSize[1]||null,unit:e.startSize[2]||"%"});let l=null;typeof e.onInitialize=="function"&&(l=e.onInitialize);let h=null;typeof e.onCropStart=="function"&&(h=e.onCropStart);let c=null;typeof e.onCropEnd=="function"&&(c=e.onCropEnd);let g=null;typeof e.onUpdate=="function"&&(console.warn("Croppr.js: `onUpdate` is deprecated and will be removed in the next major release. Please use `onCropMove` or `onCropEnd` instead."),g=e.onUpdate),typeof e.onCropMove=="function"&&(g=e.onCropMove);let m=null;if(e.returnMode!==void 0){const C=e.returnMode.toLowerCase();if(["real","ratio","raw"].indexOf(C)===-1)throw"Invalid return mode.";m=C}const u=function(C){const f=C.offsetWidth,A=C.offsetHeight,w=["maxSize","minSize","startSize"];for(let I=0;I<w.length;I++){const z=w[I];this[z]!==null&&(this[z].unit=="%"&&(this[z].width!==null&&(this[z].width=this[z].width/100*f),this[z].height!==null&&(this[z].height=this[z].height/100*A)),delete this[z].unit)}},v=(C,f)=>C!==null?C:f;return{aspectRatio:v(i,t.aspectRatio),maxSize:v(n,t.maxSize),minSize:v(o,t.minSize),startSize:v(r,t.startSize),returnMode:v(m,t.returnMode),onInitialize:v(l,t.onInitialize),onCropStart:v(h,t.onCropStart),onCropMove:v(g,t.onCropMove),onCropEnd:v(c,t.onCropEnd),convertToPixels:u}}}function G(s,e){return+(Math.round(s+"e"+e)+"e-"+e)}class Je extends le{constructor(e,t,i=!1){super(e,t,i)}getValue(e){return super.getValue(e)}setImage(e){return super.setImage(e)}destroy(){return super.destroy()}moveTo(e,t){return this.box.move(e,t),this.redraw(),this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue()),this}resizeTo(e,t,i=[.5,.5]){this.box.resize(e,t,i);const n=this.cropperEl.offsetWidth,o=this.cropperEl.offsetHeight;return this.box.constrainToBoundary(n,o,[.5,.5]),this.redraw(),this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue()),this}scaleBy(e,t=[.5,.5]){return this.box.scale(e,t),this.redraw(),this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue()),this}reset(e){return e&&(this.options={...this.options,newOptions:e}),this.box=this.initializeBox(this.options),this.redraw(),this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue()),this}enableVisibility(e){let t=document.querySelector(".croppr-container");if(!t)throw new Error("THere is not any croppr");e?t.style.display="block":t.style.display="none"}}const se=p.memo(({src:s,size:e,croppUpdate:t})=>{const[i,n]=p.useState(),[o,r]=p.useState({width:150,height:150}),l=p.useRef(null),h=p.useRef();return p.useEffect(()=>{e&&(r({...e}),l.current&&l.current.resizeTo(e.width,e.height))},[e]),p.useEffect(()=>{s&&n(s)},[s]),p.useEffect(()=>(h.current&&i&&(l.current=new Je("#croppr",{minSize:[32,32,"px"],startSize:[o.width,o.height,"px"],onInitialize:c=>{t(c==null?void 0:c.getValue())},onCropEnd:c=>{t(c)}})),()=>{var c;return(c=l==null?void 0:l.current)==null?void 0:c.destroy()}),[h.current,i]),a("div",{className:"ArchbaseCropprWrapper",children:a("img",{ref:h,src:i,id:"croppr"})})});try{se.displayName="ArchbaseCropperWrapper",se.__docgenInfo={description:"",displayName:"ArchbaseCropperWrapper",props:{src:{defaultValue:null,description:"",name:"src",required:!0,type:{name:"string"}},size:{defaultValue:null,description:"",name:"size",required:!0,type:{name:"any"}},croppUpdate:{defaultValue:null,description:"",name:"croppUpdate",required:!0,type:{name:"(data: { x: number; y: number; width: number; height: number; }) => void"}}}}}catch{}const Ge=p.memo(({activeIndex:s=0,children:e,backgroundColor:t="inherit",color:i="#428CFF",indicatorStyle:n="bottomLine",onTabChange:o=g=>{},transitionMs:r=375,borderLine:l=!1,fontColor:h="inherit",lazy:c=!1})=>{const[g,m]=p.useState([]),[u,v]=p.useState(s),C=p.useRef(null);p.useEffect(()=>{const w=e instanceof Array?e:[e];f(w);const I=w.map(z=>({label:z.props.name,icon:z.props.icon,disabled:z.props.disabled}));if(s>I.length-1||s<0)throw new Error(`Intervalo inválido para activeIndex ${s}`);m(I)},[e]),p.useEffect(()=>{var I,z;const w=e instanceof Array?e:[e];if(s>w.length-1||s<0)throw new Error(`Intervalo inválido para activeIndex ${s}`);v((z=(I=w[s])==null?void 0:I.props)!=null&&z.disabled?0:s)},[s]),p.useEffect(()=>{g&&g.length&&o(u)},[u]);function f(w){try{w.map(I=>{if(!I.props.name)throw new Error("Dentro do componente TabContainer só pode ser renderizado o componente TabItem e precisa de um suporte de nome");return!0})}catch{throw new Error("O componente TabContainer deve ter um TabItem como componente filho")}}const A=e instanceof Array?e:[e];return E("div",{ref:C,className:"tab-pp",children:[a("div",{className:"header",style:{backgroundColor:t,borderBottom:l?"1px solid #323232":"undet"},children:g.map((w,I)=>E("button",{onClick:()=>{w.disabled||v(I)},style:{color:I==u&&(n==="simple"||n==="bottomLine")?i:h,backgroundColor:I==u&&n==="button"?i:"inherit"},className:I==u?`itemlabel ${n} active`:"itemlabel",disabled:w.disabled,children:[w.icon," ",w.label,n==="bottomLine"&&a("div",{style:{backgroundColor:i}})]},w.label))}),a("div",{className:"body",children:A.map((w,I)=>I<u?a("div",{style:{transform:"translate3d(-100%, 0px, 0px)",height:"0px",overflow:"hidden",transition:`transform ${r/1e3}s ease`},className:"body-content",children:!c&&w},I):I>u?a("div",{style:{transform:"translate3d(100%, 0px, 0px)",height:"0px",overflow:"hidden",transition:`transform ${r/1e3}s ease`},className:"body-content",children:!c&&w},I):a("div",{style:{visibility:"inherit",overflow:"auto",height:"auto",position:"relative",transition:`transform ${r/1e3}s ease`},className:"body-content",children:w},I))})]})}),Z=p.memo(({name:s,children:e,icon:t=null,type:i="TabItem",disabled:n=!1})=>a("div",{style:{padding:"1rem 0.5rem"},children:e})),Ke=Ge;try{Z.displayName="TabItem",Z.__docgenInfo={description:"",displayName:"TabItem",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"string | Element"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"string"}}}}}catch{}const Qe={quality:92,maxHeight:1e3,maxWidth:1e3,cropHeight:150,cropWidth:150,maintainAspectRatio:!0,format:"png",arrayCopiedImages:[],originImageSrc:""},Ze=p.memo(({image:s="",color:e="#1e88e5",initialState:t=Qe,saveUpdates:i=()=>{}})=>{const[n,o]=p.useState(t),[r,l]=p.useState(""),[h,c]=p.useState(!1),[g,m]=p.useState({width:150,height:150}),[u,v]=p.useState(),C=p.useRef(!1),f=["webp","jpeg","png"];p.useEffect(()=>{C.current=window.innerWidth<800,o(JSON.parse(JSON.stringify({...n,...t})))},[t]),p.useEffect(()=>{l(s)},[s]),p.useEffect(()=>{h||m({width:150,height:150})},[h]);async function A(d,y=!1){try{const{state:R,imageUri:S}=await be(n.originImageSrc,y,d);l(S),o(R)}catch(R){console.log("🚀 ~ file: EditImage.tsx ~ line 73 ~ applyChanges ~ error",R)}}async function w(d){d=Math.max(Math.min(d,100),1);const y={...n,quality:d};o(y);try{await A(y,!1)}catch(R){console.log("onUpdateQuality ~ error",R)}}async function I(d,y=!1){const R=Math.max(Math.min(d,4e3),32),S={...n};if(y){if(S.maxHeight===R)return;S.maxHeight=R}else{if(S.maxWidth===R)return;S.maxWidth=R}o(S);try{await A(S,y)}catch(x){console.log("onChangeSize ~ error",x)}}async function z(d){const y={...n,format:d.target.value};try{o(y),await A(y,!1)}catch(R){console.log("onChangeFormat ~ error",R)}}function B(d,y){d&&(o({...n,cropWidth:d}),m({...g,width:d})),y&&(o({...n,cropHeight:y}),m({...g,height:y}))}function D(){let d=q(n);const y=document.createElement("canvas");return new Promise((R,S)=>{const x=y.getContext("2d"),N=new Image;N.src=r,N.onload=()=>{const k=u==null?void 0:u.width,b=u==null?void 0:u.height;return y.height=b,y.width=k,x.drawImage(N,Math.abs(u==null?void 0:u.x),Math.abs(u==null?void 0:u.y),u==null?void 0:u.width,u==null?void 0:u.height,0,0,u==null?void 0:u.width,u==null?void 0:u.height),R(y.toDataURL(`image/${d.format}`,d.quality))},N.onerror=k=>{S(k)}}).then(R=>{d.maxWidth=y.width,d.maxHeight=y.height,d.originImageSrc=R,d=ve(d,R),o(d),l(R),c(!1)}).catch(R=>{console.log(R)})}function _(d){v(d),o({...n,cropHeight:d.height,cropWidth:d.width})}function U(d=!1){c(!1),i(d?{state:n,imageSrc:r}:null)}async function H(){try{let d=q(n);if(d.arrayCopiedImages.length>1){d.arrayCopiedImages.pop();const y=d.arrayCopiedImages[d.arrayCopiedImages.length-1];d={...n,arrayCopiedImages:d.arrayCopiedImages,maxHeight:y.height,maxWidth:y.width,quality:y.quality,format:y.format,originImageSrc:y.originImageSrc,basicFilters:y.basicFilters},o(d),l(y.lastImage)}}catch(d){console.log("🚀 ~ file: edit-image.component.ts ~ line 126 ~ EditImageComponent ~ onRestore ~ e",d)}}async function T(d){try{const y=q(n);y.basicFilters?y.basicFilters={...y.basicFilters,...d}:y.basicFilters=d,await A(y,!1)}catch(y){console.log("🚀 ~ file: EditImage.tsx ~ line 259 ~ onChangeFilters ~ e",y)}}const $=p.useMemo(()=>r&&r.length?Math.ceil(3/4*r.length/1024):"",[r]);function q(d){return JSON.parse(JSON.stringify(d))}return a("div",{className:"ArchbaseEditImage",children:E("div",{id:"popup",className:"popup",children:[a("div",{style:{flexDirection:"row",boxSizing:"border-box",display:"flex",placeContent:"center flex-end",alignItems:"center",padding:"0px 16px"},children:a("button",{className:"icon-btn",onClick:()=>{U(!1)},children:a("span",{className:"material-icons",children:a(Ve,{})})})}),E("div",{className:"image-container",children:[E("div",{className:"image-holder-full",children:[!h&&a("img",{id:"image-full",src:r}),h&&a(se,{src:r,size:g,croppUpdate:_})]}),E("div",{className:"control-panel",children:[E(Ke,{lazy:!0,borderLine:!0,children:[E(Z,{name:`${M.t("Basic")}`,children:[(!C.current||C.current&&!h)&&E(oe.Fragment,{children:[E("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Quality")}`}),a("p",{className:"item-panel",children:n.quality+"%"})]}),a("div",{className:"flex-row-start",children:a(F,{readOnly:h,disabled:h,className:"input-range",onChangedDelayed:w,onChangedValue:d=>{o({...n,quality:d})},style:{maxWidth:"100%",width:"100%",color:e},type:"range",min:1,max:100,value:n.quality})}),E("div",{className:"item-panel",style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[`${M.t("Max dimensions")}`,E("div",{style:{display:"flex",alignItems:"center"},children:[a("input",{disabled:h,readOnly:h,type:"checkbox",checked:n.maintainAspectRatio,onChange:d=>o({...n,maintainAspectRatio:d.target.checked}),style:{color:e}}),a("span",{className:"caption",children:`${M.t("aspect-ratio")}`})]})]}),E("div",{className:"flex-row-start",style:{marginTop:"10px",justifyContent:"space-between"},children:[E("div",{className:"form-field",style:{maxWidth:"48%",width:"48%"},children:[a("label",{children:`${M.t("max-width(px)")}`}),a(F,{readOnly:h,disabled:h,placeholder:`${M.t("max-width(px)")}`,value:n.maxWidth,onChangedValue:d=>o({...n,maxWidth:d}),type:"number",min:0,max:2e3,onInputChangedEnd:d=>{I(d,!1)}})]}),E("div",{className:"form-field",style:{maxWidth:"48%",width:"48%"},children:[a("label",{children:`${M.t("max-height(px)")}`}),a(F,{readOnly:h,disabled:h,placeholder:`${M.t("max-height(px)")}`,value:n.maxHeight,onChangedValue:d=>o({...n,maxHeight:d}),type:"number",min:0,max:2e3,onInputChangedEnd:d=>{I(d,!0)}})]})]}),a("p",{className:"item-panel",children:`${M.t("Format")}`}),a("div",{className:"flex-row-start",style:{marginTop:"10px",justifyContent:"space-between"},children:a("div",{className:"form-field",style:{width:"100%"},children:a("select",{disabled:h,value:n.format,onChange:z,children:f.map((d,y)=>a("option",{value:d,children:d},y))})})})]}),a("div",{className:"flex-row-start",style:{marginTop:"5px",justifyContent:"space-between"},children:E("span",{style:{display:"flex",alignItems:"center"},children:[a("input",{type:"checkbox",onChange:d=>{c(d.target.checked)},checked:h,style:{color:e,marginBottom:"3px"}}),a("span",{className:"item-panel",style:{marginLeft:"4px"},children:`${M.t("Crop")}`})]})}),h&&E(oe.Fragment,{children:[E("div",{className:"flex-row-start",style:{marginTop:"10px",justifyContent:"space-between"},children:[E("div",{className:"form-field",style:{maxWidth:"48%",width:"48%"},children:[a("label",{children:`${M.t("width(px)")}`}),a(F,{type:"number",min:0,value:n.cropWidth,onChangedValue:d=>o({...n,cropWidth:d}),onInputChangedEnd:d=>{B(+d,null)},placeholder:`${M.t("width(px)")}`})]}),E("div",{className:"form-field",style:{maxWidth:"48%",width:"48%"},children:[a("label",{children:`${M.t("height(px)")}`}),a(F,{type:"number",min:0,value:n.cropHeight,onInputChangedEnd:d=>{B(null,+d)},onChangedValue:d=>o({...n,cropHeight:d}),placeholder:`${M.t("height(px)")}`})]})]}),a("p",{style:{marginBottom:"4px !important"},children:a(he,{onClick:D,leftSection:a(We,{color:"orange"}),children:`${M.t("Crop")}`})})]})]}),a(Z,{disabled:h,name:`${M.t("Filters")}`,children:a(Xe,{color:e,initialState:n.basicFilters,changeFilter:T})})]}),a("button",{title:`${M.t("Undo")}`,disabled:n.arrayCopiedImages.length<=1,style:{position:"absolute",right:"10px",top:"30px"},className:"icon-btn",onClick:H,children:a("span",{className:"material-icons",children:`${M.t("Refresh")}`})}),E("div",{className:"flex-row-start",style:{marginTop:"10px",justifyContent:"space-between",alignItems:"center"},children:[a(he,{leftSection:a(He,{}),color:"green",onClick:()=>{U(!0)},children:`${M.t("archbase:Apply")}`}),$&&a("p",{className:"caption image-caption",style:{color:$>120?"#f44336":"unset",fontWeight:$>120?"500":"unset"},children:a(Q,{children:`${M.t("archbase:size")}: ${$}Kb ${n.format}`})})]})]})]})]})})}),et=Ze;const tt={objectFit:"cover",hideDeleteBtn:!1,hideDownloadBtn:!1,hideEditBtn:!1,hideAddBtn:!1,compressInitial:null},pe={maxHeight:3e3,maxWidth:3e3,cropHeight:150,cropWidth:150,maintainAspectRatio:!0,format:"png",arrayCopiedImages:[],originImageSrc:"",basicFilters:void 0,quality:100},re=p.memo(({config:s={},imageSrcProp:e="",color:t="#1e88e5",imageChanged:i=()=>{},variant:n="transparent"})=>{const o=Ae(),{colorScheme:r}=Be(),[l,h]=p.useState({...pe}),[c,g]=p.useState(""),[m,u]=p.useState(!1),[v,C]=p.useState(!1),[f,A]=p.useState(tt),w=p.useRef(null),I=p.useRef(""),z=p.useRef(""),B=Date.now().toString(20),D=p.useRef("download");p.useRef(!1),p.useEffect(()=>{U()},[s]),p.useEffect(()=>{_()},[e]);async function _(){if(e){const x=await d(e),N=x.state;N.originImageSrc=e,N.arrayCopiedImages=[{lastImage:x.imageUri,width:N.maxWidth,height:N.maxHeight,quality:N.quality,format:N.format,originImageSrc:e}],g(x.imageUri),h(N),u(!0)}else{const x={...l};x.originImageSrc=null,x.arrayCopiedImages=[],u(!1),g(null),h(x)}}p.useEffect(()=>{i(c)},[c]);function U(){const x={...f,...s};A(x)}function H(x){var N;x.preventDefault(),(N=w==null?void 0:w.current)==null||N.click()}function T(x){var k;const N=(k=x.target)==null?void 0:k.files;if(N){const b=N[0];if(D.current=b.name.split(".")[0],I.current=b.type,!I.current.includes("image"))return;if(z.current=`data:${b.type};base64,`,b){const W=new FileReader;W.onload=$.bind(this),W.readAsBinaryString(b)}}}async function $(x){const N=x.target.result,k=btoa(N);let b={...l};const W=z.current+k;if(b.originImageSrc=z.current+k,b.format=I.current.split("image/")[1],f.compressInitial){b={...b,quality:Math.min(f.compressInitial||92,100),maintainAspectRatio:!0,format:b.format?b.format:"png"};const V=await be(b.originImageSrc,!1,b,{getDimFromImage:!0});h(V.state),g(V.imageUri),u(!0),f.onChangeImage&&f.onChangeImage(V.imageUri)}else{const V=document.createElement("img");V.src=W,V.onload=()=>{b.arrayCopiedImages=[],b.maxHeight=V.height,b.maxWidth=V.width,b.format=I.current.split("image/")[1],b.arrayCopiedImages.push({lastImage:W,width:V.width,height:V.height,quality:b.quality,format:I.current.split("image/")[1],originImageSrc:b.originImageSrc}),h(b),g(W),u(!0),f.onChangeImage&&f.onChangeImage(W)}}}const q=p.useMemo(()=>c&&c.length?Math.ceil(3/4*c.length/1024):"",[c]);function d(x){let N={...l},k;if(x.startsWith("data:image/")){const b=x.match(/data:image\/([a-zA-Z]+);base64,/);b&&b[1]?k=b[1]:k="png"}else{const b=x.split(".");k=b[b.length-1],["png","jpeg","webp"].includes(k)||(k="png")}if(N.format=k,s.compressInitial!=null){let b=1;s.compressInitial>=0&&s.compressInitial<=100&&(b=s.compressInitial),N.quality=b}return new Promise((b,W)=>{const V=document.createElement("img");V.crossOrigin="Anonymous",N.maxHeight=V.height,N.maxWidth=V.width,V.onload=()=>{const L=document.createElement("canvas"),we=L.getContext("2d"),de=1;L.width=V.width*de,L.height=V.height*de,we.drawImage(V,0,0,L.width,L.height);const xe=L.toDataURL(`image/${k}`,N.quality/100);return b({dataUri:xe,width:L.width,height:L.height})},V.onerror=L=>W(L.message||`Error loading the src = ${x}`),V.src=x}).then(b=>(N={...N,maxHeight:b.height,maxWidth:b.width},{imageUri:b.dataUri,state:N}))}function y(){C(!0)}function R(x){C(!1),x&&(h(x.state),g(x.imageSrc),f.onChangeImage&&f.onChangeImage(x.imageSrc))}function S(){g(null),u(!1);const x={...l,...pe};h(x),C(!1),f.onChangeImage&&f.onChangeImage(void 0)}return E("div",{className:"ArchbaseImagePickerEditor",children:[!m&&a("div",{className:"place-image",children:E("div",{className:"image-holder",style:{width:f.width,height:f.height,borderRadius:f.borderRadius,aspectRatio:f.aspectRatio+"",background:r==="dark"?o.colors.dark[7]:o.white,border:`${ce(1)} solid ${r==="dark"?o.colors.dark[4]:o.colors.gray[3]}`},children:[a(O,{withinPortal:!0,withArrow:!0,label:`${M.t("archbase:Upload a image")}`,children:a(X,{component:"button",color:"blue",variant:n,className:"icon-btn image-upload-btn",onClick:H,children:a(ie,{color:"purple"})})}),a("input",{ref:w,type:"file",style:{display:"none"},id:"filePicker-"+B,onChange:T})]})}),m&&E("div",{className:"place-image",children:[E("div",{className:"image-holder-loaded",style:{width:f.width,height:f.height,borderRadius:f.borderRadius,aspectRatio:f.aspectRatio+"",background:r==="dark"?o.colors.dark[7]:o.white,border:`${ce(1)} solid ${r==="dark"?o.colors.dark[4]:o.colors.gray[3]}`},children:[a("img",{src:c,alt:"image-loaded",style:{height:f.height,borderRadius:f.borderRadius,objectFit:f.objectFit,background:r==="dark"?o.colors.dark[7]:o.white}}),!f.hideEditBtn&&E(p.Fragment,{children:[a("div",{className:"curtain",onClick:H,children:a(O,{withinPortal:!0,withArrow:!0,label:`${M.t("archbase:Upload a image")}`,children:a(X,{component:"button",color:"blue",variant:n,children:a(ie,{color:"white"})})})}),a("input",{ref:w,type:"file",style:{display:"none"},id:"filePicker-"+B,onChange:T})]})]}),q&&f.showImageSize&&a("div",{className:"caption image-caption",style:{color:q>120?"#f44336":"unset",fontWeight:q>120?"500":"unset"},children:a(Q,{children:`${M.t("archbase:size")}: ${q}Kb ${l.format}`})}),E("div",{style:{flexDirection:"row",boxSizing:"border-box",display:"flex",placeContent:"flex-start",alignItems:"flex-start"},className:"editing-bar-btn",children:[!f.hideAddBtn&&a(O,{withinPortal:!0,withArrow:!0,label:`${M.t("archbase:Upload a image")}`,children:a(X,{id:"upload-img",color:"blue",variant:n,onClick:H,children:a(ie,{color:"purple"})})}),!f.hideEditBtn&&a(O,{withinPortal:!0,withArrow:!0,label:`${M.t("archbase:Open the editor panel")}`,children:a(X,{id:"edit-img",color:"blue",variant:n,onClick:y,children:a(_e,{color:"teal"})})}),!f.hideDownloadBtn&&a(O,{withinPortal:!0,withArrow:!0,label:`${M.t("archbase:Download the image")}`,children:a(X,{component:"a",id:"download-img",href:c,color:"green",download:D.current,variant:n,children:a(Le,{color:"green"})})}),!f.hideDeleteBtn&&a(O,{withinPortal:!0,withArrow:!0,label:`${M.t("archbase:Remove")}`,children:a(X,{id:"delete-img",color:"red",variant:n,onClick:()=>S(),children:a($e,{color:"#C91A25"})})})]})]}),v&&a(et,{saveUpdates:R,color:t,image:c,initialState:l})]})});try{re.displayName="ArchbaseImagePickerEditor",re.__docgenInfo={description:"",displayName:"ArchbaseImagePickerEditor",props:{config:{defaultValue:null,description:"",name:"config",required:!0,type:{name:"ArchbaseImagePickerConf"}},imageSrcProp:{defaultValue:null,description:"",name:"imageSrcProp",required:!1,type:{name:"string"}},color:{defaultValue:null,description:"",name:"color",required:!1,type:{name:"string"}},imageChanged:{defaultValue:null,description:"",name:"imageChanged",required:!1,type:{name:"Function"}},variant:{defaultValue:null,description:"",name:"variant",required:!1,type:{name:"enum",value:[{value:'"light"'},{value:'"filled"'},{value:'"outline"'},{value:'"default"'},{value:'"transparent"'},{value:'"white"'},{value:'"subtle"'},{value:'"gradient"'}]}}}}}catch{}function ee({width:s=240,height:e=240,dataSource:t,dataField:i,disabled:n,readOnly:o,required:r,label:l,description:h,error:c,src:g,radius:m="4px",aspectRatio:u,objectFit:v="contain",compressInitial:C=80,onChangeImage:f,disabledBase64Convertion:A,innerRef:w,variant:I,...z}){const[B,D]=p.useState(void 0),_=p.useRef(),[U,H]=p.useState(c),T=Re();p.useEffect(()=>{H(void 0)},[B]);const $=()=>{let S=B;t&&i&&(S=t.getFieldValue(i),S||(S="")),Te(S)&&!A&&(S=atob(S)),D(S)},q=p.useCallback(()=>{$()},[]),d=p.useCallback(S=>{t&&i&&((S.type===P.dataChanged||S.type===P.recordChanged||S.type===P.afterScroll||S.type===P.afterCancel||S.type===P.afterEdit)&&($(),T()),S.type===P.onFieldError&&S.fieldName===i&&H(S.error))},[]);Ee(()=>{$(),t&&i&&(t.addListener(d),t.addFieldChangeListener(i,q))}),Ce(()=>{$()},[]),Ie(()=>{t&&i&&(t.removeListener(d),t.removeFieldChangeListener(i,q))});const y=S=>{const x=S;D(N=>x),t&&!t.isBrowsing()&&i&&t.getFieldValue(i)!==x&&(x?t.setFieldValue(i,A?x:btoa(x)):t.setFieldValue(i,void 0)),f&&f(S)},R=()=>{let S=o;return t&&!o&&(S=t.isBrowsing()),S};return a("div",{style:{position:"relative",display:"inline-block"},children:a(ze.Wrapper,{withAsterisk:r,label:l,description:h,error:U,ref:w||_,children:a(re,{imageSrcProp:B,variant:I,config:{borderRadius:m,width:s,height:e,objectFit:v,compressInitial:C,showImageSize:!R(),hideDeleteBtn:R(),hideDownloadBtn:R(),hideEditBtn:R(),hideAddBtn:R(),onChangeImage:y}})})})}try{ee.displayName="ArchbaseImageEdit",ee.__docgenInfo={description:"",displayName:"ArchbaseImageEdit",props:{dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o valor do rich edit",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o valor do rich edit na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"Indicador se o rich edit está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"Indicador se o rich edit é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"Indicador se o preenchimento do rich edit é obrigatório",name:"required",required:!1,type:{name:"boolean"}},style:{defaultValue:null,description:"Estilo do checkbox",name:"style",required:!1,type:{name:"CSSProperties"}},label:{defaultValue:null,description:"Título do rich edit",name:"label",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"Descrição do rich edit",name:"description",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Último erro ocorrido no rich edit",name:"error",required:!1,type:{name:"string"}},variant:{defaultValue:null,description:'Controla a aparência dos botões, sendo padrão "transparent". ("filled" | "light" | "outline" | "transparent" | "white" | "subtle" | "default" | "gradient")',name:"variant",required:!1,type:{name:"enum",value:[{value:'"light"'},{value:'"filled"'},{value:'"outline"'},{value:'"default"'},{value:'"transparent"'},{value:'"white"'},{value:'"subtle"'},{value:'"gradient"'}]}},src:{defaultValue:null,description:"Image src",name:"src",required:!1,type:{name:"string"}},alt:{defaultValue:null,description:"Texto alternativo da imagem, usado como título para espaço reservado se a imagem não foi carregada",name:"alt",required:!1,type:{name:"string"}},width:{defaultValue:{value:"240"},description:"Largura da imagem, padrão de 100%, não pode exceder 100%",name:"width",required:!1,type:{name:"string | number"}},height:{defaultValue:{value:"240"},description:"Altura da imagem, o padrão é a altura da imagem original ajustada para determinada largura",name:"height",required:!1,type:{name:"string | number"}},radius:{defaultValue:{value:"4px"},description:"Chave de theme.radius ou qualquer valor CSS válido para definir border-radius, 0 por padrão",name:"radius",required:!1,type:{name:"string | number"}},imageRef:{defaultValue:null,description:"Obter ref do elemento de imagem",name:"imageRef",required:!1,type:{name:"ForwardedRef<HTMLImageElement>"}},caption:{defaultValue:null,description:"Legenda da imagem, exibida abaixo da imagem",name:"caption",required:!1,type:{name:"ReactNode"}},aspectRatio:{defaultValue:null,description:"",name:"aspectRatio",required:!1,type:{name:"number"}},objectFit:{defaultValue:{value:"contain"},description:"",name:"objectFit",required:!1,type:{name:"enum",value:[{value:'"revert"'},{value:'"fill"'},{value:'"cover"'},{value:'"contain"'},{value:'"scale-down"'}]}},compressInitial:{defaultValue:{value:"80"},description:"",name:"compressInitial",required:!1,type:{name:"number"}},onChangeImage:{defaultValue:null,description:"",name:"onChangeImage",required:!1,type:{name:"(image: any) => void"}},disabledBase64Convertion:{defaultValue:null,description:"Desabilita conversão do conteúdo em base64 antes de salvar na fonte de dados",name:"disabledBase64Convertion",required:!1,type:{name:"boolean"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}}}}}catch{}const it=()=>{const s=Se(),{dataSource:e}=Me({initialData:nt,name:"dsPessoas"});return e!=null&&e.isBrowsing()&&!(e!=null&&e.isEmpty())&&e.edit(),Ne({dataSource:e,listener:t=>{switch(t.type){case P.fieldChanged:{s();break}}}}),E(te,{children:[a(te.Col,{offset:1,span:4,children:E(Y,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[a(Y.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:a(ue,{justify:"space-between",children:a(Q,{fw:500,children:"Image Editor Component"})})}),a(ke,{style:{height:400},children:a(ee,{dataSource:e,dataField:"foto",width:140,height:150,label:"Foto",description:"teste",error:"tessss"})})]})}),a(te.Col,{span:4,children:E(Y,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[a(Y.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:a(ue,{justify:"space-between",children:a(Q,{fw:500,children:"DataSource dsPessoas"})})}),a(qe,{style:{height:500},children:a(Fe,{data:e})})]})})]})},nt=[De[0]],ti={title:"Editores/Image Edit",component:ee},K={name:"Exemplo simples",render:()=>a(it,{})};var ge,fe,ye;K.parameters={...K.parameters,docs:{...(ge=K.parameters)==null?void 0:ge.docs,source:{originalSource:`{
  name: 'Exemplo simples',
  render: () => <ArchbaseImageEditExample />
}`,...(ye=(fe=K.parameters)==null?void 0:fe.docs)==null?void 0:ye.source}}};export{K as Primary,ti as default};
