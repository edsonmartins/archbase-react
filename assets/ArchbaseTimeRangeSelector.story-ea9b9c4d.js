import{a as u,j as r,F as ee}from"./jsx-runtime-c9381026.js";import{r as c}from"./index-8b3efc3f.js";import{B as P}from"./polymorphic-factory-bf652503.js";import{T as v}from"./Text-70cb1fd9.js";import{P as O}from"./Popover-62e4c870.js";import{T as te}from"./Tooltip-051468cd.js";import{B as _}from"./Button-04a737e5.js";import{I as re}from"./IconCalendar-5a729921.js";import{S as ne}from"./Stack-ac31e4d3.js";import{S as ae}from"./Select-77291262.js";import{G as b}from"./Group-5b3c182b.js";import{D as j}from"./DatePickerInput-a654b9c5.js";import{T as B}from"./TimeInput-feead10c.js";import{A as N}from"./ActionIcon-aabf0409.js";import{I as M}from"./IconClock-04b0092d.js";import{r as J,t as K}from"./index-d0400ba7.js";import{t as oe}from"./index-07970463.js";import{G as F}from"./Grid-93307f43.js";import{C}from"./Card-171745c8.js";import{S as z}from"./ScrollArea-518af3d9.js";import{S as ie}from"./Space-a5b43da0.js";import{A as se}from"./ArchbaseObjectInspector-191de42c.js";import"./_commonjsHelpers-de833af9.js";import"./Mantine.context-41afb47e.js";import"./OptionalPortal-8c3f6fc2.js";import"./index-a38d0dca.js";import"./use-isomorphic-effect-aa890e3d.js";import"./use-merged-ref-a374cf59.js";import"./use-resolved-styles-api-07b5b463.js";import"./DirectionProvider-1e219af7.js";import"./use-floating-auto-update-002b1cce.js";import"./floating-ui.react-e0c547c4.js";import"./use-did-update-bccd292e.js";import"./FocusTrap-c341c68f.js";import"./Transition-e462ee3e.js";import"./use-reduced-motion-73d958ef.js";import"./use-media-query-91643880.js";import"./create-safe-context-941c9e18.js";import"./noop-1bad6ac0.js";import"./use-uncontrolled-f56237fb.js";import"./use-id-f896cdc5.js";import"./get-style-object-71cabcb5.js";import"./Loader-a46c68a6.js";import"./UnstyledButton-5ea781f1.js";import"./createReactComponent-60e598cf.js";import"./index-9d475cdf.js";import"./OptionsDropdown-64d05981.js";import"./CheckIcon-c538e622.js";import"./Combobox-614068dc.js";import"./Input-7a6e621e.js";import"./create-optional-context-86e78b6c.js";import"./InputBase-46c7ce5b.js";import"./use-input-props-5361677b.js";import"./dayjs.min-5b59225a.js";import"./pick-calendar-levels-props-31ce4af0.js";import"./DatesProvider-b737956c.js";import"./AccordionChevron-759bd79d.js";import"./clamp-73f6bef2.js";import"./DatePicker-7aa0aff2.js";import"./Modal-0c51d204.js";import"./Paper-e7399838.js";import"./use-window-event-860a85e7.js";import"./get-sorted-breakpoints-e9679440.js";import"./px-90b8b31c.js";import"./use-mantine-color-scheme-12883fe8.js";function le(e,i){J(2,arguments);var n=oe(e),m=K(i);return isNaN(m)?new Date(NaN):(m&&n.setDate(n.getDate()+m),n)}function y(e,i){J(2,arguments);var n=K(i);return le(e,-n)}const x=e=>{if(!e)return"";const i=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0");return`${i}:${n}`},L=e=>e?e.toLocaleDateString():"",ce=(e,i)=>{if(!e||!i)return"Selecionar intervalo";const n=L(e),m=x(e),f=L(i),d=x(i);return n===f?`${n} ${m} - ${d}`:`${n} ${m} - ${f} ${d}`},me=(e,i)=>{if(!e||!i)return"Nenhum intervalo selecionado";const n=e.toLocaleString(),m=i.toLocaleString();return`De: ${n}
Até: ${m}`},I=({ranges:e,onRangeChange:i,defaultRangeValue:n,label:m,popoverTitle:f="Intervalo de tempo",width:d=300,position:A="bottom",componentRef:g})=>{const[a,k]=c.useState(n||(e.length>0?e[0].value:"")),[l,D]=c.useState({start:null,end:null}),[s,h]=c.useState({start:null,end:null}),[Q,S]=c.useState(!1),$=c.useRef(null),E=c.useRef(null),w=c.useRef({updateCurrentRange:()=>s,getCurrentRange:()=>({selectedValue:a,range:s})}),W=c.useMemo(()=>{const t=e.find(o=>o.value===a);return t&&a!=="custom"?t.label:ce(s.start,s.end)},[a,s,e]);c.useEffect(()=>{w.current={...w.current,updateCurrentRange:()=>{if(a&&a!=="custom"){const t=e.find(o=>o.value===a);if(t){const o=t.rangeFunction(new Date);return h(o),i&&i(a,o),o}}return s},getCurrentRange:()=>({selectedValue:a,range:s})}},[a,e,i,s]),c.useEffect(()=>{g&&(g.current={updateCurrentRange:()=>w.current.updateCurrentRange(),getCurrentRange:()=>w.current.getCurrentRange()})},[g]),c.useEffect(()=>{if(n&&(a!==n||s.start===null)){const t=e.find(o=>o.value===n);if(t){const{start:o,end:p}=t.rangeFunction(new Date);(s.start!==o||s.end!==p)&&h({start:o,end:p})}else n==="custom"&&l.start&&l.end&&h({start:l.start,end:l.end})}},[n,e]);const X=()=>{h({start:l.start,end:l.end}),S(!1),i&&i("custom",{start:l.start,end:l.end})},Y=t=>{if(k(t),t!=="custom"){const o=e.find(p=>p.value===t);if(o){const{start:p,end:R}=o.rangeFunction(new Date);h({start:p,end:R}),S(!1),i&&i(t,{start:p,end:R})}}else!l.start&&!l.end&&s.start&&s.end&&D({start:s.start,end:s.end})},q=(t,o)=>{const[p,R]=t.split(":").map(Number),V=new Date((o?l.start:l.end)||new Date);V.setHours(p,R),D(Z=>({...Z,[o?"start":"end"]:new Date(V)}))};return u(P,{children:[m&&r(v,{size:"sm",fw:500,mb:6,children:m}),u(O,{position:A,opened:Q,onChange:S,width:d,trapFocus:!0,shadow:"md",withinPortal:!0,closeOnEscape:!0,closeOnClickOutside:!1,children:[r(O.Target,{children:r(te,{label:me(s.start,s.end),position:"top",openDelay:300,disabled:!s.start||!s.end,multiline:!0,children:r(_,{variant:"light",rightSection:r(re,{size:16}),style:{width:d},onClick:()=>S(t=>!t),children:W})})}),r(O.Dropdown,{children:u(P,{p:"xs",children:[r(v,{size:"sm",fw:500,mb:"md",children:f}),u(ne,{gap:"xs",w:"100%",children:[r(ae,{label:"Selecione um intervalo",placeholder:"Selecionado...",value:a,onChange:Y,data:[...e.map(({value:t,label:o})=>({value:t,label:o})),{value:"custom",label:"Customizado"}],style:{width:"100%"}}),a==="custom"&&u(ee,{children:[u(b,{grow:!0,mt:"xs",children:[r(j,{label:"Data inicial",value:l.start,onChange:t=>D(o=>({...o,start:t})),style:{flex:1},popoverProps:{withinPortal:!1,closeOnClickOutside:!1}}),r(B,{label:"Hora inicial",value:x(l.start),onChange:t=>q(t.currentTarget.value,!0),rightSection:r(N,{onClick:()=>{var t;return(t=$.current)==null?void 0:t.click()},children:r(M,{size:"1rem",stroke:1.5})}),ref:$,style:{width:"100px"}})]}),u(b,{grow:!0,mt:"xs",children:[r(j,{label:"Data final",value:l.end,onChange:t=>D(o=>({...o,end:t})),style:{flex:1},popoverProps:{withinPortal:!1,closeOnClickOutside:!1}}),r(B,{label:"Hora final",value:x(l.end),onChange:t=>q(t.currentTarget.value,!1),rightSection:r(N,{onClick:()=>{var t;return(t=E.current)==null?void 0:t.click()},children:r(M,{size:"1rem",stroke:1.5})}),ref:E,style:{width:"100px"}})]}),u(b,{justify:"flex-end",mt:"md",children:[r(_,{onClick:()=>S(!1),variant:"outline",mr:"xs",children:"Cancelar"}),r(_,{onClick:X,children:"Aplicar"})]})]})]})]})})]})]})};try{I.displayName="ArchbaseTimeRangeSelector",I.__docgenInfo={description:"",displayName:"ArchbaseTimeRangeSelector",props:{ranges:{defaultValue:null,description:"",name:"ranges",required:!0,type:{name:"RangeOption[]"}},onRangeChange:{defaultValue:null,description:"",name:"onRangeChange",required:!1,type:{name:"(selectedValue: string, range: { start: Date; end: Date; }) => void"}},defaultRangeValue:{defaultValue:null,description:"",name:"defaultRangeValue",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"string"}},popoverTitle:{defaultValue:{value:"Intervalo de tempo"},description:"",name:"popoverTitle",required:!1,type:{name:"string"}},width:{defaultValue:{value:"300"},description:"",name:"width",required:!1,type:{name:"string | number"}},position:{defaultValue:{value:"bottom"},description:"",name:"position",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"right"'},{value:'"bottom"'},{value:'"left"'}]}},componentRef:{defaultValue:null,description:"",name:"componentRef",required:!1,type:{name:"MutableRefObject<ArchbaseTimeRangeSelectorRef>"}}}}}catch{}const ue=()=>{const e="últimos 7 dias",i="últimos 30 dias",n="último dia",[m,f]=c.useState(e),[d,A]=c.useState({start:y(new Date,7),end:new Date}),g=c.useMemo(()=>[{label:n,value:n,rangeFunction:a=>({start:y(a,1),end:a})},{label:e,value:e,rangeFunction:a=>({start:y(a,7),end:a})},{label:i,value:i,rangeFunction:a=>({start:y(a,30),end:a})}],[]);return u(F,{children:[r(F.Col,{offset:1,span:4,children:u(C,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[r(C.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:r(b,{justify:"space-between",children:r(v,{fw:500,children:"Time Range Selector Component"})})}),r(P,{style:{height:500},children:r(z,{h:500,p:20,children:r(I,{defaultRangeValue:e,ranges:g,onRangeChange:(a,k)=>{f(a),A(k)}})})})]})}),r(F.Col,{offset:1,span:4,children:u(C,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[r(C.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:r(b,{justify:"space-between",children:r(v,{fw:500,children:"Resultado"})})}),u(z,{h:300,children:[r(ie,{h:20}),r(v,{children:m}),r(se,{data:d})]})]})})]})},Ct={title:"Editores/TimeRangeSeletor",component:I},T={name:"Exemplo simples",render:()=>r(ue,{})};var G,H,U;T.parameters={...T.parameters,docs:{...(G=T.parameters)==null?void 0:G.docs,source:{originalSource:`{
  name: 'Exemplo simples',
  render: () => <ArchbaseTimeRangeSelectorExample />
}`,...(U=(H=T.parameters)==null?void 0:H.docs)==null?void 0:U.source}}};export{T as Primary,Ct as default};
