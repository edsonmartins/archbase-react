{"version":3,"file":"useArchbaseDataSource-86b4bc22.js","sources":["../../src/components/hooks/useArchbaseDataSource.ts"],"sourcesContent":["import { useEffect, useState } from 'react'\nimport { ArchbaseDataSource, DataSourceOptions, IDataSourceValidator } from '../datasource/ArchbaseDataSource'\nimport { ArchbaseStateValues } from '../template'\nimport { ArchbaseStore } from './useArchbaseStore'\n\nexport type UseArchbaseDataSourceProps<T, ID> = {\n  store?: ArchbaseStore\n  initialData: any[]\n  initialDataSource?: ArchbaseDataSource<T, ID> | undefined\n  name: string\n  label?: string\n  onLoadComplete?: (dataSource: ArchbaseDataSource<T, ID>) => void\n  validator?: IDataSourceValidator\n}\n\nexport type UseArchbaseDataSourceReturnType<T, ID> = {\n  dataSource: ArchbaseDataSource<T, ID>\n}\n\nexport const useArchbaseDataSource = <T, ID>(\n  props: UseArchbaseDataSourceProps<T, ID>\n): UseArchbaseDataSourceReturnType<T, ID> => {\n  const { initialData, name, label, initialDataSource, onLoadComplete, store, validator } = props\n  const buildDataSource = () =>{\n    if (store && store.existsValue(name)){\n      return store.getValue(name);\n    }\n    if (initialDataSource){\n      return initialDataSource;\n    }\n    return new ArchbaseDataSource<T, ID>(name, {\n      records: initialData,\n      grandTotalRecords: initialData.length,\n      currentPage : 0,\n      totalPages: 0,\n      pageSize: 0,\n      validator\n    }, label)\n  }\n  const [dataSource, setDataSource] = useState<ArchbaseDataSource<T, ID>>(\n    buildDataSource()\n  )\n\n  useEffect(() => {\n    if (store){\n      store.setValue(name,dataSource);\n    }\n    if (onLoadComplete) {\n      onLoadComplete(dataSource)\n    }\n  }, [name])\n\n  return { dataSource }\n}\n"],"names":["useArchbaseDataSource","props","initialData","name","label","initialDataSource","onLoadComplete","store","validator","buildDataSource","ArchbaseDataSource","dataSource","setDataSource","useState","useEffect"],"mappings":"+FAmBa,MAAAA,EACXC,GAC2C,CACrC,KAAA,CAAE,YAAAC,EAAa,KAAAC,EAAM,MAAAC,EAAO,kBAAAC,EAAmB,eAAAC,EAAgB,MAAAC,EAAO,UAAAC,CAAc,EAAAP,EACpFQ,EAAkB,IAClBF,GAASA,EAAM,YAAYJ,CAAI,EAC1BI,EAAM,SAASJ,CAAI,EAExBE,GAGG,IAAIK,EAA0BP,EAAM,CACzC,QAASD,EACT,kBAAmBA,EAAY,OAC/B,YAAc,EACd,WAAY,EACZ,SAAU,EACV,UAAAM,GACCJ,CAAK,EAEJ,CAACO,EAAYC,CAAa,EAAIC,EAAA,SAClCJ,EAAgB,CAAA,EAGlBK,OAAAA,EAAAA,UAAU,IAAM,CACVP,GACIA,EAAA,SAASJ,EAAKQ,CAAU,EAE5BL,GACFA,EAAeK,CAAU,CAC3B,EACC,CAACR,CAAI,CAAC,EAEF,CAAE,WAAAQ,CAAW,CACtB"}