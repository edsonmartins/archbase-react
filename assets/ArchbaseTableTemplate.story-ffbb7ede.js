import{j as a,a as w}from"./jsx-runtime-c9381026.js";import{A as ge,T as ve,C as Fe,a as V,b as Te}from"./masker-42e04915.js";import{t as v}from"./i18next-a4b2730f.js";import{B as Ve}from"./polymorphic-factory-bf652503.js";import{B as we}from"./Badge-9d9d4017.js";import{u as xe}from"./useArchbaseRemoteServiceApi-5974aa1a.js";import{A as Ee}from"./DemoIOCTypes-d657846a.js";import{u as qe,a as Re}from"./useArchbaseDataSource-c5d317be.js";import{u as Se}from"./useArchbaseRemoteDataSource-d81fd1bf.js";import{A as Ne,u as Ie}from"./useArchbaseLocalFilterDataSource-aed4bc57.js";import{u as U,D as Pe}from"./useArchbaseDataSourceListener-92dd263c.js";import{u as Ae}from"./useArchbaseStore-7a40a785.js";import{r as F}from"./index-8b3efc3f.js";import{P as D}from"./types-5decf4ed.js";import"./index-9e992aa6.js";import{u as De}from"./useArchbaseTheme-b06b98b5.js";/* empty css                 */import"./ArchbaseGlobalFilter-4d7cf956.js";import{f as G}from"./index-7792ba32.js";import{b as d,e as _e}from"./index-f91c0534.js";import{u as Ce}from"./use-mantine-color-scheme-12883fe8.js";import{P as Be}from"./Paper-e7399838.js";import{A as $e}from"./ArchbaseAlert-73f96c50.js";import{I as ke}from"./IconBug-b91acd15.js";import{F as Le}from"./Flex-ffd42070.js";import{B as q}from"./Button-92934f28.js";import{I as Me}from"./IconPlus-ae63da25.js";import{I as Ue,a as Ge}from"./IconEye-fd34f1b1.js";import{I as He}from"./IconTrash-6b16e91d.js";import{u as je}from"./ArchbaseAppContext-a0328177.js";import{G as H}from"./Grid-93307f43.js";import{p as ze}from"./pessoasData-6b8000da.js";import{A as We}from"./ArchbaseNotifications-9b045634.js";import"./_commonjsHelpers-de833af9.js";import"./iframe-9b4f9a64.js";import"../sb-preview/runtime.js";import"./index-d0400ba7.js";import"./index-a38d0dca.js";import"./DirectionProvider-1e219af7.js";import"./create-safe-context-941c9e18.js";import"./Menu-316143ba.js";import"./create-scoped-keydown-handler-870d0701.js";import"./use-resolved-styles-api-07b5b463.js";import"./Popover-f9771438.js";import"./OptionalPortal-8c3f6fc2.js";import"./Mantine.context-41afb47e.js";import"./use-isomorphic-effect-aa890e3d.js";import"./use-merged-ref-a374cf59.js";import"./use-floating-auto-update-1c50c118.js";import"./use-did-update-bccd292e.js";import"./FocusTrap-c341c68f.js";import"./Transition-fcb0e8e9.js";import"./use-reduced-motion-73d958ef.js";import"./use-media-query-91643880.js";import"./noop-1bad6ac0.js";import"./use-uncontrolled-f56237fb.js";import"./use-id-f896cdc5.js";import"./UnstyledButton-5ea781f1.js";import"./Accordion-dd4792ed.js";import"./AccordionChevron-759bd79d.js";import"./get-style-object-71cabcb5.js";import"./Text-70cb1fd9.js";import"./Tooltip-3000dbce.js";import"./Switch-9fe6c888.js";import"./InputsGroupFieldset-d2b47ae0.js";import"./Input-7a6e621e.js";import"./create-optional-context-86e78b6c.js";import"./createReactComponent-60e598cf.js";import"./index-9d475cdf.js";import"./IconChevronDown-98fe7a40.js";import"./IconChevronLeft-e342e4db.js";import"./IconChevronRight-7b46ea5c.js";import"./IconDeviceFloppy-e64fda70.js";import"./IconDots-c503a9bc.js";import"./IconFilter-b6b2ffb4.js";import"./IconSearch-4ec0977e.js";import"./IconX-efebeb5f.js";import"./LoadingOverlay-9291b93c.js";import"./Loader-a46c68a6.js";import"./Select-783a2eee.js";import"./OptionsDropdown-32503dd2.js";import"./CheckIcon-c538e622.js";import"./ScrollArea-d2c70305.js";import"./Combobox-d5a4e168.js";import"./InputBase-46c7ce5b.js";import"./use-input-props-5361677b.js";import"./MultiSelect-3e31f72b.js";import"./TextInput-7248445a.js";import"./ActionIcon-bbc9f6f7.js";import"./Radio-e91a6821.js";import"./get-contrast-color-8b9a39df.js";import"./get-auto-contrast-value-58024fc4.js";import"./Checkbox-dc8773fd.js";import"./Alert-70fde736.js";import"./Stack-ac31e4d3.js";import"./use-debounced-value-a36920eb.js";import"./Modal-9ec5811f.js";import"./use-window-event-860a85e7.js";import"./Progress-b3485ef3.js";import"./Group-5b3c182b.js";import"./dayjs.min-5b59225a.js";import"./pick-calendar-levels-props-31ce4af0.js";import"./DatesProvider-b737956c.js";import"./clamp-73f6bef2.js";import"./assign-time-c53cee85.js";import"./use-move-ed5fccfc.js";import"./useTranslation-263f67a6.js";import"./context-3b2264a0.js";import"./px-90b8b31c.js";import"./Chip-22800b99.js";import"./DatePickerInput-12950d62.js";import"./DatePicker-b4383bc8.js";import"./IconRefresh-112158d7.js";import"./string-utils-046f5c60.js";import"./index-1905cc86.js";import"./index-07970463.js";import"./index-bd3702cd.js";import"./setPrototypeOf-375db7f1.js";import"./isNativeReflectConstruct-4e5fac16.js";import"./createClass-0cf05130.js";import"./ArchbaseErrorHelper-1b9b234b.js";import"./ArchbaseIOCTypes-dfd3b385.js";import"./IsNotEmpty-d2b4946f.js";import"./v4-4a60fe23.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./lodash-4d0be66a.js";import"./index-2e8af730.js";import"./Card-171745c8.js";import"./Space-a5b43da0.js";import"./ArchbaseList-0dc98350.js";import"./Image-e087d856.js";import"./ArchbaseDateTimePickerRange-f1102f5a.js";import"./TimeInput-feead10c.js";import"./IconCalendar-cbd6718a.js";import"./ArchbaseSwitch-eaa256cd.js";import"./use-force-update-11fe72c1.js";import"./ArchbaseSelect-48b070e9.js";import"./ArchbaseSelectItem-d056b8eb.js";import"./ArchbaseEdit-4157d7e3.js";import"./ArchbaseDialog-c59b7d30.js";import"./index-673ae7f2.js";import"./use-local-storage-3e1e375d.js";import"./get-sorted-breakpoints-e9679440.js";import"./notifications.store-2c4c9735.js";import"./store-704b6bc9.js";function _({currentValue:o,values:s}){const n=s.findIndex(r=>r.value.toString()===o);return n!==-1?a(Ve,{children:a(we,{color:s[n].color,children:v(s[n].label)})}):null}try{_.displayName="ArchbaseItemRender",_.__docgenInfo={description:"",displayName:"ArchbaseItemRender",props:{currentValue:{defaultValue:null,description:"",name:"currentValue",required:!0,type:{name:"string"}},values:{defaultValue:null,description:"",name:"values",required:!0,type:{name:"ArchbaseItemRenderType[]"}}}}}catch{}function Je(o){const s=[];if(o.filter.rules){const n=Q(o.filter.condition,o.filter.rules);return o.sort&&o.sort.sortFields&&o.sort.sortFields.forEach(r=>{r.selected&&s.push(r.name+":"+r.asc_desc)}),{expressionNode:n,sortStrings:s}}return null}function Q(o,s){let n=d.and;o==="or"&&(n=d.or);const r=[];return s.forEach(t=>{if(t.field&&!t.disabled){let e=t.value,p=t.value2;e&&e!==""&&(typeof e=="number"||e instanceof Date)&&(t.dataType==="date"||t.dataType==="date_time")&&(e=j(t,e)),p&&p!==""&&(typeof p=="number"||p instanceof Date)&&(t.dataType==="date"||t.dataType==="date_time")&&(p=j(t,p)),t.operator==="null"?r.push(d.eq(t.field,"null")):t.operator==="notNull"?r.push(d.neq(t.field,"null")):t.operator==="contains"&&e&&e!==""?r.push(d.eq(t.field,`^*${e}*`)):t.operator==="startsWith"&&e&&e!==""?r.push(d.eq(t.field,`^${e}*`)):t.operator==="endsWith"&&e&&e!==""&&(typeof e=="string"||typeof e=="number")?r.push(d.eq(t.field,`^*${e}`)):t.operator==="="&&e&&e!==""&&(typeof e=="string"||typeof e=="number")?r.push(d.eq(t.field,e)):t.operator==="!="&&e&&e!==""&&(typeof e=="string"||typeof e=="number")?r.push(d.neq(t.field,e)):t.operator==="<"&&e&&e!==""&&(typeof e=="string"||typeof e=="number")?r.push(d.lt(t.field,e)):t.operator===">"&&e&&e!==""&&(typeof e=="string"||typeof e=="number")?r.push(d.gt(t.field,e)):t.operator==="<="&&e&&e!==""&&(typeof e=="string"||typeof e=="number")?r.push(d.le(t.field,e)):t.operator===">="&&e&&e!==""&&(typeof e=="string"||typeof e=="number")?r.push(d.ge(t.field,e)):t.operator==="between"&&e&&e!==""&&p&&p!==""&&(typeof e=="string"||typeof e=="number")&&(typeof p=="string"||typeof p=="number")?r.push(d.bt(t.field,e,p)):t.operator==="notBetween"&&e&&e!==""&&p&&p!==""&&(typeof e=="string"||typeof e=="number")&&(typeof p=="string"||typeof p=="number")?r.push(d.nb(t.field,e,p)):t.operator==="inList"&&e&&e!==""&&Array.isArray(e)?r.push(d.in(t.field,e)):t.operator==="notInList"&&e&&e!==""&&Array.isArray(e)&&r.push(d.out(t.field,e))}t.rules&&!t.disabled&&r.push(Q(t.condition,t.rules))}),n(...r)}function j(o,s){if(o.dataType==="date")return G(s,{representation:"date"});if(o.dataType==="date_time")return G(s,{representation:"complete"})}const Ke=(o,s,n)=>{var r;if(!o||!s||!s.existsValue(`${o.viewName}_${o.componentName}`)){let t=-1,e;return n&&n.getFilters().length>0&&(t=0,e=JSON.parse((r=n.getFirstFilter())==null?void 0:r.filter)),{activeFilterIndex:t,expandedFilter:!1,currentFilter:e}}return s.getValue(`${o.viewName}_${o.componentName}`)};function S({title:o,printTitle:s,dataSource:n,filterOptions:r,pageSize:t,columns:e,filterFields:p,logoPrint:N,userActions:i,userRowActions:m,innerRef:I,isLoading:c=!1,isLoadingFilter:x=!1,isError:C=!1,enableTopToolbar:Y=!0,error:B="",clearError:$=()=>{},filterType:T,width:X="100%",height:Z="100%",onSearchByFilter:k,withBorder:L=!0,filterPersistenceDelegator:M,variant:y,store:f,cellPadding:O,bottomToolbarMinHeight:ee,enableRowSelection:te,tableHeadCellPadding:re,renderDetailPanel:ae,renderTopToolbar:ie,dragRowOptions:oe,onSelectedRowsChanged:ne}){const g=je(),le=F.useRef();F.useRef(),De(),Ce();const[u,E]=F.useState({activeFilterIndex:-1,currentFilter:void 0,expandedFilter:!1});F.useEffect(()=>{const l=Ke(r,f,M);E(l)},[x]);const se=({row:l})=>{if(!m&&!(m!=null&&m.actions))return;const h=m.actions;return a(h,{onEditRow:m.onEditRow,onRemoveRow:m.onRemoveRow,onViewRow:m.onViewRow,row:l,variant:y??g.variant})},pe=(l,h)=>{const b={...u,currentFilter:l,activeFilterIndex:h};E(b),f&&r&&(f==null||f.setValue(`${r.viewName}_${r.componentName}`,b))},me=l=>{const h={...u,expandedFilter:l};E(h),f&&r&&(f==null||f.setValue(`${r.viewName}_${r.componentName}`,h))},de=(l,h)=>{const b={...u,currentFilter:l,activeFilterIndex:h};E(b),f&&r&&(f==null||f.setValue(`${r.viewName}_${r.componentName}`,b))},ue=()=>{if(u.currentFilter)if(k)k();else if(u.currentFilter.filter.filterType==="quick"){const l=n.getOptions();u.currentFilter.filter.quickFilterText&&u.currentFilter.filter.quickFilterText!==""?(l.filter=JSON.stringify({search:u.currentFilter.filter.quickFilterText,fields:u.currentFilter.filter.quickFilterFieldsText}),l.sort=u.currentFilter.sort.quickFilterSort?u.currentFilter.sort.quickFilterSort.split(","):[]):(l.filter=void 0,l.sort=void 0),n.refreshData(l)}else{const l=Je(u.currentFilter);if(l&&l.expressionNode){const h=_e(l.expressionNode),b=n.getOptions();b.filter=h,b.sort=l==null?void 0:l.sortStrings,n.refreshData(b)}}};let P,A;const ce=l=>{P=l},fe=l=>{A=l},he=()=>{A&&A()},be=()=>{P&&P()},ye=()=>{if(T==="none")return a("div",{});if(T==="advanced")return a(Ne,{id:r==null?void 0:r.componentName,viewName:r==null?void 0:r.viewName,apiVersion:r==null?void 0:r.apiVersion,ref:le,variant:y??g.variant,expandedFilter:u.expandedFilter,persistenceDelegator:M,currentFilter:u.currentFilter,activeFilterIndex:u.activeFilterIndex,onSelectedFilter:de,onFilterChanged:pe,onSearchByFilter:ue,onToggleExpandedFilter:me,onExport:he,onPrint:be,showExportButton:!0,showPrintButton:!0,width:"560px",height:"170px",children:p})};return w(Be,{withBorder:L,ref:I,style:{overflow:"none",height:"calc(100% - 4px)"},children:[C?a($e,{autoClose:2e4,withCloseButton:!0,withBorder:!0,icon:a(ke,{size:"1.4rem"}),title:v("archbase:WARNING"),titleColor:"rgb(250, 82, 82)",variant:y??g.variant,onClose:()=>$&&$(),children:a("span",{children:B})}):null,w(ge,{printTitle:s||o,logoPrint:N,width:X,height:Z,withBorder:L,dataSource:n,withColumnBorders:!0,variant:y??g.variant,striped:!0,isLoading:c,enableTopToolbar:Y,renderTopToolbar:ie,pageSize:t,isError:C,enableGlobalFilter:T==="normal",renderToolbarInternalActions:T==="advanced"||T==="none"?ye:void 0,renderRowActions:se,error:a("span",{children:B}),onExport:fe,onPrint:ce,cellPadding:O,bottomToolbarMinHeight:ee,enableRowSelection:te,tableHeadCellPadding:re,renderDetailPanel:ae,enableRowActions:!!m,dragRowOptions:oe,onSelectedRowsChanged:ne,children:[e,i!=null&&i.visible?a(ve,{children:w(F.Fragment,{children:[a("h3",{className:"only-print",children:s||o}),a("div",{className:"no-print",children:w(Le,{gap:"8px",rowGap:"8px",children:[i.customUserActions&&i.customUserActionsPosition==="left"?i.customUserActions:null,i.onAddExecute?a(q,{color:"green",variant:y??g.variant,leftSection:a(Me,{}),onClick:()=>i&&i.onAddExecute&&i.onAddExecute(),children:v("archbase:New")}):null,i.onEditExecute?a(q,{color:"blue",leftSection:a(Ue,{}),disabled:!n.isBrowsing()||n.isEmpty(),variant:y??g.variant,onClick:()=>i&&i.onEditExecute&&i.onEditExecute(),children:v("archbase:Edit")}):null,i.onRemoveExecute?a(q,{color:"red",leftSection:a(He,{}),disabled:!(i!=null&&i.allowRemove)||!n.isBrowsing()||n.isEmpty(),variant:y??g.variant,onClick:()=>i&&i.onRemoveExecute&&i.onRemoveExecute(),children:v("archbase:Remove")}):null,i.onViewExecute?a(q,{color:"gray.7",leftSection:a(Ge,{}),disabled:!n.isBrowsing()||n.isEmpty(),variant:y??g.variant,onClick:()=>i&&i.onViewExecute&&i.onViewExecute(),children:v("archbase:View")}):null,i.customUserActions&&i.customUserActionsPosition==="right"?i.customUserActions:null]})})]})}):null]})]})}try{S.displayName="ArchbaseTableTemplate",S.__docgenInfo={description:"",displayName:"ArchbaseTableTemplate",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},printTitle:{defaultValue:null,description:"",name:"printTitle",required:!1,type:{name:"string"}},logoPrint:{defaultValue:null,description:"",name:"logoPrint",required:!1,type:{name:"string"}},variant:{defaultValue:null,description:"",name:"variant",required:!1,type:{name:"enum",value:[{value:'"light"'},{value:'"filled"'},{value:'"outline"'},{value:'"default"'},{value:'"transparent"'},{value:'"white"'},{value:'"subtle"'},{value:'"gradient"'}]}},dataSource:{defaultValue:null,description:"",name:"dataSource",required:!0,type:{name:"ArchbaseDataSource<T, ID>"}},dataSourceEdition:{defaultValue:null,description:"",name:"dataSourceEdition",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},store:{defaultValue:null,description:"",name:"store",required:!1,type:{name:"ArchbaseStateValues"}},filterType:{defaultValue:null,description:"",name:"filterType",required:!0,type:{name:"enum",value:[{value:'"none"'},{value:'"normal"'},{value:'"advanced"'}]}},filterOptions:{defaultValue:null,description:"",name:"filterOptions",required:!1,type:{name:"FilterOptions"}},filterPersistenceDelegator:{defaultValue:null,description:"",name:"filterPersistenceDelegator",required:!1,type:{name:"ArchbaseQueryFilterDelegator"}},pageSize:{defaultValue:null,description:"",name:"pageSize",required:!1,type:{name:"number"}},columns:{defaultValue:null,description:"",name:"columns",required:!0,type:{name:"ReactNode"}},filterFields:{defaultValue:null,description:"",name:"filterFields",required:!1,type:{name:"ReactNode"}},userActions:{defaultValue:null,description:"",name:"userActions",required:!1,type:{name:"UserActionsOptions"}},userRowActions:{defaultValue:null,description:"",name:"userRowActions",required:!1,type:{name:"UserRowActionsOptions<T>"}},innerRef:{defaultValue:null,description:"",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}},isLoading:{defaultValue:{value:"false"},description:"",name:"isLoading",required:!1,type:{name:"boolean"}},isLoadingFilter:{defaultValue:{value:"false"},description:"",name:"isLoadingFilter",required:!1,type:{name:"boolean"}},isError:{defaultValue:{value:"false"},description:"",name:"isError",required:!1,type:{name:"boolean"}},error:{defaultValue:{value:""},description:"",name:"error",required:!1,type:{name:"string"}},clearError:{defaultValue:{value:"() => {}"},description:"",name:"clearError",required:!1,type:{name:"() => void"}},width:{defaultValue:{value:"100%"},description:"",name:"width",required:!1,type:{name:"string | number"}},height:{defaultValue:{value:"100%"},description:"",name:"height",required:!1,type:{name:"string | number"}},onSearchByFilter:{defaultValue:null,description:"",name:"onSearchByFilter",required:!1,type:{name:"() => void"}},withBorder:{defaultValue:{value:"true"},description:"",name:"withBorder",required:!1,type:{name:"boolean"}},enableTopToolbar:{defaultValue:{value:"true"},description:"",name:"enableTopToolbar",required:!1,type:{name:"boolean"}},cellPadding:{defaultValue:null,description:"",name:"cellPadding",required:!1,type:{name:"string | number"}},bottomToolbarMinHeight:{defaultValue:null,description:"",name:"bottomToolbarMinHeight",required:!1,type:{name:"string | number"}},enableRowSelection:{defaultValue:null,description:"",name:"enableRowSelection",required:!1,type:{name:"boolean"}},tableHeadCellPadding:{defaultValue:null,description:"",name:"tableHeadCellPadding",required:!1,type:{name:"string | number"}},renderDetailPanel:{defaultValue:null,description:"",name:"renderDetailPanel",required:!1,type:{name:"(props: { row: MRT_Row<T>; table: MRT_TableInstance<T>; }) => ReactNode"}},renderTopToolbar:{defaultValue:null,description:"",name:"renderTopToolbar",required:!1,type:{name:"ReactNode | ((props: { table: MRT_TableInstance<T>; }) => ReactNode)"}},dragRowOptions:{defaultValue:null,description:"",name:"dragRowOptions",required:!1,type:{name:"DragRowOptionsProps<T>"}},onSelectedRowsChanged:{defaultValue:null,description:"",name:"onSelectedRowsChanged",required:!1,type:{name:"(rows: T[]) => void"}}}}}catch{}const Qe=[],z=[{value:D.APROVADO.toString(),label:"Aprovado",color:"green"},{value:D.REJEITADO.toString(),label:"Rejeitado",color:"red"},{value:D.PENDENTE.toString(),label:"Pendente",color:"orange"}],Ye=()=>{const o=qe(),s=Ae("pessoaStore"),n=xe(Ee.Pessoa),{dataSource:r,isLoading:t,error:e,isError:p,clearError:N}=Se({name:"dsPessoas",service:n,pageSize:15,loadOnStart:!0,store:s,onLoadComplete:c=>{console.log(c)},onDestroy:c=>{},onError:(c,x)=>{We.showError(v("WARNING"),c,x)}});U({dataSource:r,listener:c=>{}});const{dataSource:i}=Ie({initialData:Qe,name:"dsFilters"}),{dataSource:m}=Re({initialData:Xe,name:"dsPessoas"});m!=null&&m.isBrowsing()&&!(m!=null&&m.isEmpty())&&m.edit(),U({dataSource:m,listener:c=>{switch(c.type){case Pe.fieldChanged:{o();break}}}});const I=F.useMemo(()=>w(Fe,{children:[a(V,{dataField:"id",dataType:"uuid",header:"Id",enableClickToCopy:!0}),a(V,{dataField:"nome",dataType:"text",header:"Nome da pessoa"}),a(V,{dataField:"data_nasc",dataType:"date",header:"Data nascimento",inputFilterType:"date"}),a(V,{dataField:"creditoOK",dataType:"boolean",header:"Crédito OK?"}),a(V,{dataField:"status",dataType:"enum",inputFilterType:"select",enumValues:z,header:"Status",render:c=>a(_,{currentValue:`${c.getValue()}`,values:z})})]}),[]);return a(H,{children:a(H.Col,{span:12,h:"100vh",children:a(S,{title:"Pessoas",dataSource:r,pageSize:15,cellPadding:4,bottomToolbarMinHeight:48,isLoading:t,error:e,isError:p,clearError:N,filterOptions:{activeFilterIndex:0,enabledAdvancedFilter:!1,apiVersion:"1.01",componentName:"templateTableExemplo",viewName:"templateTableView"},columns:I,userRowActions:{actions:Te,onAddRow:()=>{},onEditRow:()=>{},onRemoveRow:()=>{},onViewRow:()=>{}},filterType:"advanced",filterPersistenceDelegator:i,renderDetailPanel:({row:c,table:x})=>a("div",{children:c.original.nome})})})})},Xe=[ze[0]],Ca={title:"Modelos/Table template",component:S},R={name:"Exemplo simples",render:()=>a(Ye,{})};var W,J,K;R.parameters={...R.parameters,docs:{...(W=R.parameters)==null?void 0:W.docs,source:{originalSource:`{
  name: 'Exemplo simples',
  render: () => <ArchbaseTableTemplateExample />
}`,...(K=(J=R.parameters)==null?void 0:J.docs)==null?void 0:K.source}}};export{R as Primary,Ca as default};
