import{j as r,a as d}from"./jsx-runtime-c9381026.js";import{b as D,c as z,d as B,u as T,a as g}from"./useArchbaseDataSource-c5d317be.js";import{a as E,i as f,D as u,u as _}from"./useArchbaseDataSourceListener-92dd263c.js";import"./index-9e992aa6.js";import{A as G}from"./ArchbaseEdit-fef96be6.js";import{r as v}from"./index-8b3efc3f.js";import{A as M}from"./ArchbaseSelect-5e2b80d5.js";import{G as h}from"./Grid-93307f43.js";import{C as m}from"./Card-171745c8.js";import{G as w}from"./Group-5b3c182b.js";import{T as S}from"./Text-70cb1fd9.js";import{B as H}from"./polymorphic-factory-bf652503.js";import{F as U}from"./Flex-ffd42070.js";import{S as W}from"./ScrollArea-96f13bef.js";import{A as Z}from"./ArchbaseObjectInspector-191de42c.js";import{p as J}from"./pessoasData-6b8000da.js";import{p as K}from"./pedidosData-e328d4f3.js";import"./i18next-a4b2730f.js";import"./lodash-4d0be66a.js";import"./_commonjsHelpers-de833af9.js";import"./index-1905cc86.js";import"./index-d0400ba7.js";import"./use-mantine-color-scheme-12883fe8.js";import"./noop-1bad6ac0.js";import"./Mantine.context-41afb47e.js";import"./use-media-query-91643880.js";import"./use-force-update-11fe72c1.js";import"./TextInput-7248445a.js";import"./InputBase-46c7ce5b.js";import"./Input-7a6e621e.js";import"./create-optional-context-86e78b6c.js";import"./use-resolved-styles-api-07b5b463.js";import"./UnstyledButton-5ea781f1.js";import"./use-id-f896cdc5.js";import"./use-isomorphic-effect-aa890e3d.js";import"./use-input-props-5361677b.js";import"./Tooltip-051468cd.js";import"./OptionalPortal-8c3f6fc2.js";import"./index-a38d0dca.js";import"./use-merged-ref-a374cf59.js";import"./use-floating-auto-update-002b1cce.js";import"./DirectionProvider-1e219af7.js";import"./floating-ui.react-e0c547c4.js";import"./use-did-update-bccd292e.js";import"./Transition-e462ee3e.js";import"./use-reduced-motion-73d958ef.js";import"./get-style-object-71cabcb5.js";import"./ActionIcon-aabf0409.js";import"./Loader-a46c68a6.js";import"./use-uncontrolled-f56237fb.js";import"./Select-e1edca65.js";import"./OptionsDropdown-39724fef.js";import"./CheckIcon-c538e622.js";import"./Combobox-614068dc.js";import"./Popover-62e4c870.js";import"./FocusTrap-c341c68f.js";import"./create-safe-context-941c9e18.js";import"./get-sorted-breakpoints-e9679440.js";import"./px-90b8b31c.js";import"./Paper-e7399838.js";import"./types-5decf4ed.js";const A=(t,n)=>typeof t=="function"?t(n):f.getNestedProperty(n,t);function p(t,n,a){const i=[];return t&&t.getTotalRecords()>0&&t.browseRecords().map(o=>{if(a&&!a.includes(".")){if(!o.hasOwnProperty(a)||!o[a])throw new E("Foi encontrado um registro sem ID no dataSource passado para o Select.");if(typeof n!="function"&&(!o.hasOwnProperty(n)||!o[n]))throw new E("Foi encontrado um registro sem o texto no dataSource passado para a Select.")}i.push({label:o.label?o.label:A(n,o),disabled:o.disabled,value:f.getNestedProperty(o,a),origin:o})}),i}function y({lookupDataSource:t,lookupDataFieldText:n,lookupDataFieldId:a,simpleValue:i,children:o,dataSource:l,dataField:s,options:Y,error:x,getOptionValue:V,...L}){const[N,b]=v.useState(()=>p(t,n,a)),[F,R]=v.useState(x),q=e=>{t&&((e.type===u.dataChanged||e.type===u.fieldChanged||e.type===u.recordChanged||e.type===u.afterScroll||e.type===u.afterCancel)&&t&&b(p(t,n,a)),e.type===u.onFieldError&&e.fieldName===s&&R(e.error))},j=()=>{let e="";return l&&s&&(e=l.getFieldValue(s),e&&!i?typeof n=="function"?e=n(l.getCurrentRecord()):e=f.getNestedProperty(e,a):e||(e="")),e},I=e=>{e!==void 0&&e!==""&&e!==null?t&&a&&t.locate({[a]:f.getNestedProperty(e,a)})&&l&&s&&(i?l.setFieldValue(s,V(e)):l.setFieldValue(s,t.getCurrentRecord())):l&&s&&l.setFieldValue(s,null)};return D(()=>{b(p(t,n,a)),t&&t.addListener(q)}),z(()=>{b(p(t,n,a))},[]),B(()=>{t&&t.removeListener(q)}),r(M,{...L,getOptionLabel:e=>e.label?e.label:A(n,e),getOptionValue:V,dataSource:l,dataField:s,customGetDataSourceFieldValue:j,customSetDataSourceFieldValue:I,options:N,error:F,children:o})}try{y.displayName="ArchbaseLookupSelect",y.__docgenInfo={description:"",displayName:"ArchbaseLookupSelect",props:{lookupDataSource:{defaultValue:null,description:"",name:"lookupDataSource",required:!0,type:{name:"ArchbaseDataSource<O, ID>"}},lookupDataFieldText:{defaultValue:null,description:"",name:"lookupDataFieldText",required:!0,type:{name:"string | ((record: any) => string)"}},lookupDataFieldId:{defaultValue:null,description:"",name:"lookupDataFieldId",required:!0,type:{name:"string"}},simpleValue:{defaultValue:null,description:"",name:"simpleValue",required:!1,type:{name:"boolean"}},value:{defaultValue:null,description:"Valor de entrada controlado",name:"value",required:!1,type:{name:"any"}},children:{defaultValue:null,description:"Coleção de ArchbaseSelectItem[] que representam as opções do select",name:"children",required:!1,type:{name:"ReactNode | ReactNode[]"}},options:{defaultValue:null,description:"Selecione os dados usados ​​para renderizar itens no menu suspenso",name:"options",required:!1,type:{name:"readonly (string | SelectItem)[] | ArchbaseDataSource<any, any>"}},width:{defaultValue:null,description:"Largura do select",name:"width",required:!1,type:{name:"string | number"}},style:{defaultValue:null,description:"Estilo do select",name:"style",required:!1,type:{name:"MantineStyleProp"}},onClick:{defaultValue:null,description:"Evento de click",name:"onClick",required:!1,type:{name:"MouseEventHandler<HTMLInputElement>"}},dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o item selecionado",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},error:{defaultValue:null,description:"Último erro ocorrido no select",name:"error",required:!1,type:{name:"string"}},size:{defaultValue:null,description:"Tamanho de entrada",name:"size",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},icon:{defaultValue:null,description:"Icon a esquerda do select",name:"icon",required:!1,type:{name:"ReactNode"}},zIndex:{defaultValue:null,description:"Índice z dropdown",name:"zIndex",required:!1,type:{name:"ZIndex"}},allowDeselect:{defaultValue:null,description:"Permite ou não delecionar um item",name:"allowDeselect",required:!1,type:{name:"boolean"}},clearable:{defaultValue:null,description:"Indicador se permite limpar o select",name:"clearable",required:!1,type:{name:"boolean"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o item selecionado na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},debounceTime:{defaultValue:null,description:"Tempo de espero antes de realizar a busca",name:"debounceTime",required:!1,type:{name:"number"}},disabled:{defaultValue:null,description:"Indicador se o select está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"Indicador se o select é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},placeholder:{defaultValue:null,description:"Texto explicativo do select",name:"placeholder",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"Título do select",name:"label",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"Descrição do select",name:"description",required:!1,type:{name:"string"}},searchable:{defaultValue:null,description:"Permite pesquisar no select",name:"searchable",required:!1,type:{name:"boolean"}},iconWidth:{defaultValue:null,description:"Largura do icone a esquerda do select",name:"iconWidth",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},defaultValue:{defaultValue:null,description:"Valor padrão de entrada não controlado",name:"defaultValue",required:!1,type:{name:"any"}},filter:{defaultValue:null,description:"Função com base em quais itens no menu suspenso são filtrados",name:"filter",required:!1,type:{name:"(value: string, item: any) => boolean"}},initiallyOpened:{defaultValue:null,description:"Estado aberto do menu suspenso inicial",name:"initiallyOpened",required:!1,type:{name:"boolean"}},itemComponent:{defaultValue:null,description:"Alterar renderizador de item",name:"itemComponent",required:!1,type:{name:"FC<any>"}},onDropdownOpen:{defaultValue:null,description:"Chamado quando o menu suspenso é aberto",name:"onDropdownOpen",required:!1,type:{name:"() => void"}},onDropdownClose:{defaultValue:null,description:"Chamado quando o menu suspenso é aberto",name:"onDropdownClose",required:!1,type:{name:"() => void"}},limit:{defaultValue:null,description:"Limite a quantidade de itens exibidos por vez para seleção pesquisável",name:"limit",required:!1,type:{name:"number"}},nothingFound:{defaultValue:null,description:"Rótulo nada encontrado",name:"nothingFound",required:!1,type:{name:"ReactNode"}},dropdownPosition:{defaultValue:null,description:"Comportamento de posicionamento dropdown",name:"dropdownPosition",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"bottom"'},{value:'"flip"'}]}},onSelectValue:{defaultValue:null,description:"Evento quando um valor é selecionado",name:"onSelectValue",required:!1,type:{name:"(value: O, origin: any) => void"}},onFocusExit:{defaultValue:null,description:"Evento quando o foco sai do select",name:"onFocusExit",required:!1,type:{name:"FocusEventHandler<T>"}},onFocusEnter:{defaultValue:null,description:"Evento quando o select recebe o foco",name:"onFocusEnter",required:!1,type:{name:"FocusEventHandler<T>"}},initialOptions:{defaultValue:null,description:"Opções de seleção iniciais",name:"initialOptions",required:!1,type:{name:"O[]"}},getOptionValue:{defaultValue:null,description:"Function que retorna o valor de uma opção",name:"getOptionValue",required:!0,type:{name:"(option: O) => string"}},required:{defaultValue:null,description:"Indica se o select tem o preenchimento obrigatório",name:"required",required:!1,type:{name:"boolean"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}},converter:{defaultValue:null,description:`Converte o valor antes de atribuir ao field do registro atual no datasource
Por exemplo: (obj) => obj.id para armazenar apenas o ID de um objeto`,name:"converter",required:!1,type:{name:"(value: O) => any"}},getConvertedOption:{defaultValue:null,description:`Function que busca o valor original antes de converter pelo valor de retorno do converter
Por exemplo: (id) => fetchObjectById(id) para converter ID de volta ao objeto`,name:"getConvertedOption",required:!1,type:{name:"(value: any) => Promise<O>"}},classNames:{defaultValue:null,description:"",name:"classNames",required:!1,type:{name:"Partial<Record<SelectStylesNames, string>> | ((theme: MantineTheme, props: SelectProps, ctx: unknown) => Partial<Record<SelectStylesNames, string>>)"}},styles:{defaultValue:null,description:"",name:"styles",required:!1,type:{name:"Partial<Record<SelectStylesNames, CSSProperties>> | ((theme: MantineTheme, props: SelectProps, ctx: unknown) => Partial<...>)"}},dropdownOpened:{defaultValue:null,description:"Estado do dropdown controlado",name:"dropdownOpened",required:!1,type:{name:"boolean"}},optionsLabelField:{defaultValue:null,description:"",name:"optionsLabelField",required:!1,type:{name:"string"}},customGetDataSourceFieldValue:{defaultValue:null,description:"",name:"customGetDataSourceFieldValue",required:!1,type:{name:"() => any"}},customSetDataSourceFieldValue:{defaultValue:null,description:"",name:"customSetDataSourceFieldValue",required:!1,type:{name:"(value: any) => void"}}}}}catch{}const Q=K,X=()=>{const t=T(),{dataSource:n}=g({initialData:J,name:"dsPessoas"}),{dataSource:a}=g({initialData:Q,name:"dsPedidos"});return a!=null&&a.isBrowsing()&&!(a!=null&&a.isEmpty())&&a.edit(),_({dataSource:a,listener:i=>{switch(i.type){case u.fieldChanged:{t();break}}}}),d(h,{children:[r(h.Col,{offset:1,span:6,children:d(m,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[r(m.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:r(w,{justify:"space-between",children:r(S,{fw:500,children:"Lookup Edit Component"})})}),r(H,{style:{height:100},children:d(U,{justify:"flex-start",align:"center",direction:"row",wrap:"nowrap",gap:"xs",children:[r(y,{label:"Código",dataSource:a,dataField:"cliente",lookupDataSource:n,lookupDataFieldText:"nome",lookupDataFieldId:"id",required:!0,width:300,getOptionLabel:i=>i.nome,getOptionValue:i=>i}),r(G,{label:"Nome",dataSource:a,dataField:"cliente.nome",disabled:!0,width:500})]})})]})}),r(h.Col,{span:4,children:d(m,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[r(m.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:r(w,{justify:"space-between",children:r(S,{fw:500,children:"DataSource dsPedidos"})})}),r(W,{style:{height:500},children:r(Z,{data:a})})]})})]})},ia={title:"Editores/Lookup Select",component:y},c={name:"Exemplo simples",render:()=>r(X,{})};var O,C,P;c.parameters={...c.parameters,docs:{...(O=c.parameters)==null?void 0:O.docs,source:{originalSource:`{
  name: 'Exemplo simples',
  render: () => <ArchbaseLookupSelectExample />
}`,...(P=(C=c.parameters)==null?void 0:C.docs)==null?void 0:P.source}}};export{c as Primary,ia as default};
