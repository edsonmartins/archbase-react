{"version":3,"file":"ArchbasePanelTemplate.story-bfab1d93.js","sources":["../../src/components/template/ArchbasePanelTemplate.tsx"],"sourcesContent":["import {\n  ArchbaseAction,\n  ArchbaseActionButtons,\n  ArchbaseActionButtonsOptions,\n} from '@components/buttons/ArchbaseActionButtons';\nimport { MantineNumberSize, Pagination, Variants } from '@mantine/core';\nimport { IconEdit, IconEye, IconPlus, IconTrash } from '@tabler/icons-react';\nimport { t } from 'i18next';\nimport React, { CSSProperties, ReactNode, useMemo, useRef, useState } from 'react';\nimport { useArchbaseAppContext } from '../core';\nimport type { ArchbaseDataSource } from '../datasource';\nimport {\n  ArchbaseQueryBuilder,\n  ArchbaseQueryFilter,\n  ArchbaseQueryFilterDelegator,\n  ArchbaseQueryFilterState,\n  FilterOptions,\n} from '../querybuilder';\nimport { ArchbaseSpaceTemplate, ArchbaseSpaceTemplateOptions } from './ArchbaseSpaceTemplate';\nimport { ArchbaseDebugOptions } from './ArchbaseTemplateCommonTypes';\n\nexport interface UserActionsOptions {\n  visible?: boolean;\n  labelAdd?: string;\n  labelEdit?: string;\n  labelRemove?: string;\n  labelView?: string;\n  allowAdd?: boolean;\n  allowEdit?: boolean;\n  allowView?: boolean;\n  allowRemove?: boolean;\n  onAddExecute?: () => void;\n  onEditExecute?: () => void;\n  onRemoveExecute?: () => void;\n  onView?: () => void;\n  customUserActions?: ArchbaseAction[];\n  positionCustomUserActions?: 'before' | 'after';\n}\n\nconst defaultUserActions: UserActionsOptions = {\n  visible: true,\n  allowAdd: true,\n  allowEdit: true,\n  allowView: true,\n  allowRemove: true,\n  positionCustomUserActions: 'after',\n};\n\nexport interface UserRowActionsOptions<T> {\n  actions?: any;\n  onAddRow?: (row: T) => void;\n  onEditRow?: (row: T) => void;\n  onRemoveRow?: (row: T) => void;\n  onViewRow?: (row: T) => void;\n  variant?: Variants<'filled' | 'outline' | 'light' | 'white' | 'default' | 'subtle' | 'gradient'>;\n}\n\nexport interface ArchbasePanelTemplateProps<T, ID> {\n  title: string;\n  dataSource: ArchbaseDataSource<T, ID>;\n  dataSourceEdition?: ArchbaseDataSource<T, ID> | undefined;\n  variant?: Variants<'filled' | 'outline' | 'light' | 'white' | 'default' | 'subtle' | 'gradient'>;\n  filterOptions: FilterOptions;\n  pageSize?: number;\n  filterFields: ReactNode | undefined;\n  filterPersistenceDelegator: ArchbaseQueryFilterDelegator;\n  userActions?: UserActionsOptions;\n  /** ReferÃªncia para o componente interno */\n  innerRef?: React.RefObject<HTMLInputElement> | undefined;\n  isLoading?: boolean;\n  isError?: boolean;\n  error?: string | undefined;\n  clearError?: () => void;\n  width?: number | string | undefined;\n  height?: number | string | undefined;\n  withBorder?: boolean;\n  withPagination?: boolean;\n  children?: React.ReactNode;\n  radius?: MantineNumberSize;\n  debug?: boolean;\n  actionsButtonsOptions?: ArchbaseActionButtonsOptions;\n  spaceOptions?: ArchbaseSpaceTemplateOptions;\n  style?: CSSProperties;\n  debugOptions?: ArchbaseDebugOptions;\n}\n\nexport function ArchbasePanelTemplate<T extends object, ID>({\n  title,\n  dataSource,\n  //  dataSourceEdition,\n  filterOptions,\n  //pageSize,\n  filterFields,\n  innerRef,\n  //isLoading = false,\n  isError = false,\n  error = '',\n  clearError = () => {},\n  width = '100%',\n  height = '100%',\n  withBorder = true,\n  filterPersistenceDelegator,\n  withPagination = true,\n  children,\n  radius,\n  userActions,\n  debug = false,\n  variant,\n  actionsButtonsOptions,\n  spaceOptions,\n  style,\n  debugOptions,\n}: ArchbasePanelTemplateProps<T, ID>) {\n  const appContext = useArchbaseAppContext();\n  const innerComponentRef = innerRef || useRef<any>();\n  const filterRef = useRef<any>();\n  const [filterState, setFilterState] = useState<ArchbaseQueryFilterState>({\n    activeFilterIndex: -1,\n    expandedFilter: false,\n  });\n  const userActionsBuilded: ArchbaseAction[] = useMemo(() => {\n    const userActionsEnd = { ...defaultUserActions, ...userActions };\n\n    const defaultActions: ArchbaseAction[] = [\n      userActionsEnd.allowAdd\n        ? {\n            id: '1',\n            icon: <IconPlus />,\n            color: 'green',\n            label: userActionsEnd.labelAdd ? userActionsEnd.labelAdd : t('archbase:New'),\n            executeAction: () => userActionsEnd && userActionsEnd!.onAddExecute,\n            enabled: true,\n            hint: 'Clique para criar.',\n          }\n        : undefined,\n      userActionsEnd.allowEdit\n        ? {\n            id: '2',\n            icon: <IconEdit />,\n            color: 'blue',\n            label: userActionsEnd.labelEdit ? userActionsEnd.labelEdit : t('archbase:Edit'),\n            executeAction: () => userActionsEnd && userActionsEnd!.onEditExecute,\n            enabled: !dataSource.isEmpty() && dataSource.isBrowsing(),\n            hint: 'Clique para editar.',\n          }\n        : undefined,\n      userActionsEnd.allowRemove\n        ? {\n            id: '3',\n            icon: <IconTrash />,\n            color: 'red',\n            label: userActionsEnd.labelRemove ? userActionsEnd.labelRemove : t('archbase:Remove'),\n            executeAction: () => userActionsEnd && userActionsEnd!.onRemoveExecute,\n            enabled: !dataSource.isEmpty() && dataSource.isBrowsing(),\n            hint: 'Clique para remover.',\n          }\n        : undefined,\n      userActionsEnd.allowView\n        ? {\n            id: '4',\n            icon: <IconEye />,\n            color: 'green',\n            label: userActionsEnd.labelView ? userActionsEnd.labelView : t('archbase:View'),\n            executeAction: () => userActionsEnd && userActionsEnd!.onView,\n            enabled: !dataSource.isEmpty() && dataSource.isBrowsing(),\n            hint: 'Clique para visualizar.',\n          }\n        : undefined,\n    ];\n\n    if (userActionsEnd.customUserActions && userActionsEnd.positionCustomUserActions === 'before') {\n      return [...userActionsEnd.customUserActions, ...defaultActions];\n    }\n\n    if (userActionsEnd.customUserActions && userActionsEnd.positionCustomUserActions === 'after') {\n      return [...defaultActions, ...userActionsEnd.customUserActions];\n    }\n\n    return defaultActions;\n  }, [userActions, dataSource]);\n\n  const handleFilterChanged = (filter: ArchbaseQueryFilter, activeFilterIndex: number) => {\n    setFilterState({ ...filterState, currentFilter: filter, activeFilterIndex });\n  };\n\n  const handleToggleExpandedFilter = (expanded: boolean) => {\n    setFilterState({ ...filterState, expandedFilter: expanded });\n  };\n\n  const handleSelectedFilter = (filter: ArchbaseQueryFilter, activeFilterIndex: number) => {\n    setFilterState({ ...filterState, currentFilter: filter, activeFilterIndex });\n  };\n\n  const handleSearchByFilter = () => {};\n  const defaultActionsButtonsOptions: ArchbaseActionButtonsOptions = {\n    menuButtonColor: 'blue.5',\n    menuPosition: 'left',\n  };\n\n  const defaultSpaceTemplateOptions: ArchbaseSpaceTemplateOptions = {\n    headerFlexGrow: 'left',\n    footerFlexGrow: 'right',\n    // footerGridColumns: {},\n  };\n\n  const _actionsButtonsOptions = { ...defaultActionsButtonsOptions, ...actionsButtonsOptions };\n  const _spaceTemplateOptions = { ...defaultSpaceTemplateOptions, ...spaceOptions };\n\n  return (\n    <ArchbaseSpaceTemplate\n      innerRef={innerComponentRef}\n      width={width}\n      height={height}\n      radius={radius}\n      withBorder={withBorder}\n      isError={isError}\n      error={error}\n      clearError={clearError}\n      title={title}\n      defaultDebug={debug}\n      debugOptions={debugOptions}\n      style={style}\n      options={_spaceTemplateOptions}\n      headerLeft={<ArchbaseActionButtons actions={userActionsBuilded} options={_actionsButtonsOptions} />}\n      headerRight={\n        <ArchbaseQueryBuilder\n          id={filterOptions.componentName}\n          viewName={filterOptions.viewName}\n          apiVersion={filterOptions.apiVersion}\n          ref={filterRef}\n          variant={variant ?? appContext.variant}\n          expandedFilter={filterState.expandedFilter}\n          persistenceDelegator={filterPersistenceDelegator}\n          currentFilter={filterState.currentFilter}\n          activeFilterIndex={filterState.activeFilterIndex}\n          onSelectedFilter={handleSelectedFilter}\n          onFilterChanged={handleFilterChanged}\n          onSearchByFilter={handleSearchByFilter}\n          onToggleExpandedFilter={handleToggleExpandedFilter}\n          width={'660px'}\n          height=\"170px\"\n        >\n          {filterFields}\n        </ArchbaseQueryBuilder>\n      }\n      footerRight={withPagination && <Pagination total={10} />}\n    >\n      {children}\n    </ArchbaseSpaceTemplate>\n  );\n}\n"],"names":["defaultUserActions","ArchbasePanelTemplate","title","dataSource","filterOptions","filterFields","innerRef","isError","error","clearError","width","height","withBorder","filterPersistenceDelegator","withPagination","children","radius","userActions","debug","variant","actionsButtonsOptions","spaceOptions","style","debugOptions","appContext","useArchbaseAppContext","innerComponentRef","useRef","filterRef","filterState","setFilterState","useState","userActionsBuilded","useMemo","userActionsEnd","defaultActions","jsx","IconPlus","t","IconEdit","IconTrash","IconEye","handleFilterChanged","filter","activeFilterIndex","handleToggleExpandedFilter","expanded","handleSelectedFilter","handleSearchByFilter","defaultActionsButtonsOptions","defaultSpaceTemplateOptions","_actionsButtonsOptions","_spaceTemplateOptions","ArchbaseSpaceTemplate","ArchbaseActionButtons","ArchbaseQueryBuilder","Pagination"],"mappings":"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"}