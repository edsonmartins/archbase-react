{"version":3,"file":"use-local-storage-1df931ea.js","sources":["../../node_modules/@mantine/hooks/esm/use-local-storage/create-storage.js","../../node_modules/@mantine/hooks/esm/use-local-storage/use-local-storage.js"],"sourcesContent":["import { useCallback, useState, useEffect } from 'react';\nimport { useWindowEvent } from '../use-window-event/use-window-event.js';\n\nfunction serializeJSON(value, hookName) {\n  try {\n    return JSON.stringify(value);\n  } catch (error) {\n    throw new Error(`@mantine/hooks ${hookName}: Failed to serialize the value`);\n  }\n}\nfunction deserializeJSON(value) {\n  try {\n    return JSON.parse(value);\n  } catch (e) {\n    return value;\n  }\n}\nfunction createStorage(type, hookName) {\n  const eventName = type === \"localStorage\" ? \"mantine-local-storage\" : \"mantine-session-storage\";\n  return function useStorage({\n    key,\n    defaultValue = void 0,\n    getInitialValueInEffect = true,\n    deserialize = deserializeJSON,\n    serialize = (value) => serializeJSON(value, hookName)\n  }) {\n    const readStorageValue = useCallback((skipStorage) => {\n      if (typeof window === \"undefined\" || !(type in window) || window[type] === null || skipStorage) {\n        return defaultValue;\n      }\n      const storageValue = window[type].getItem(key);\n      return storageValue !== null ? deserialize(storageValue) : defaultValue;\n    }, [key, defaultValue]);\n    const [value, setValue] = useState(readStorageValue(getInitialValueInEffect));\n    const setStorageValue = useCallback((val) => {\n      if (val instanceof Function) {\n        setValue((current) => {\n          const result = val(current);\n          window[type].setItem(key, serialize(result));\n          window.dispatchEvent(new CustomEvent(eventName, { detail: { key, value: val(current) } }));\n          return result;\n        });\n      } else {\n        window[type].setItem(key, serialize(val));\n        window.dispatchEvent(new CustomEvent(eventName, { detail: { key, value: val } }));\n        setValue(val);\n      }\n    }, [key]);\n    const removeStorageValue = useCallback(() => {\n      window[type].removeItem(key);\n      window.dispatchEvent(new CustomEvent(eventName, { detail: { key, value: defaultValue } }));\n    }, []);\n    useWindowEvent(\"storage\", (event) => {\n      var _a;\n      if (event.storageArea === window[type] && event.key === key) {\n        setValue(deserialize((_a = event.newValue) != null ? _a : void 0));\n      }\n    });\n    useWindowEvent(eventName, (event) => {\n      if (event.detail.key === key) {\n        setValue(event.detail.value);\n      }\n    });\n    useEffect(() => {\n      if (defaultValue !== void 0 && value === void 0) {\n        setStorageValue(defaultValue);\n      }\n    }, [defaultValue, value, setStorageValue]);\n    useEffect(() => {\n      if (getInitialValueInEffect) {\n        setValue(readStorageValue());\n      }\n    }, [key]);\n    return [\n      value === void 0 ? defaultValue : value,\n      setStorageValue,\n      removeStorageValue\n    ];\n  };\n}\n\nexport { createStorage };\n//# sourceMappingURL=create-storage.js.map\n","import { createStorage } from './create-storage.js';\n\nfunction useLocalStorage(props) {\n  return createStorage(\"localStorage\", \"use-local-storage\")(props);\n}\n\nexport { useLocalStorage };\n//# sourceMappingURL=use-local-storage.js.map\n"],"names":["serializeJSON","value","hookName","deserializeJSON","createStorage","type","eventName","key","defaultValue","getInitialValueInEffect","deserialize","serialize","readStorageValue","useCallback","skipStorage","storageValue","setValue","useState","setStorageValue","val","current","result","removeStorageValue","useWindowEvent","event","_a","useEffect","useLocalStorage","props"],"mappings":"2FAGA,SAASA,EAAcC,EAAOC,EAAU,CACtC,GAAI,CACF,OAAO,KAAK,UAAUD,CAAK,CAC5B,MAAe,CACd,MAAM,IAAI,MAAM,kBAAkBC,CAAQ,iCAAiC,CAC5E,CACH,CACA,SAASC,EAAgBF,EAAO,CAC9B,GAAI,CACF,OAAO,KAAK,MAAMA,CAAK,CACxB,MAAW,CACV,OAAOA,CACR,CACH,CACA,SAASG,EAAcC,EAAMH,EAAU,CACrC,MAAMI,EAAYD,IAAS,eAAiB,wBAA0B,0BACtE,OAAO,SAAoB,CACzB,IAAAE,EACA,aAAAC,EAAe,OACf,wBAAAC,EAA0B,GAC1B,YAAAC,EAAcP,EACd,UAAAQ,EAAaV,GAAUD,EAAcC,EAAOC,CAAQ,CACxD,EAAK,CACD,MAAMU,EAAmBC,cAAaC,GAAgB,CACpD,GAAI,OAAO,OAAW,KAAe,EAAET,KAAQ,SAAW,OAAOA,CAAI,IAAM,MAAQS,EACjF,OAAON,EAET,MAAMO,EAAe,OAAOV,CAAI,EAAE,QAAQE,CAAG,EAC7C,OAAOQ,IAAiB,KAAOL,EAAYK,CAAY,EAAIP,CACjE,EAAO,CAACD,EAAKC,CAAY,CAAC,EAChB,CAACP,EAAOe,CAAQ,EAAIC,EAAQ,SAACL,EAAiBH,CAAuB,CAAC,EACtES,EAAkBL,cAAaM,GAAQ,CACvCA,aAAe,SACjBH,EAAUI,GAAY,CACpB,MAAMC,EAASF,EAAIC,CAAO,EAC1B,cAAOf,CAAI,EAAE,QAAQE,EAAKI,EAAUU,CAAM,CAAC,EAC3C,OAAO,cAAc,IAAI,YAAYf,EAAW,CAAE,OAAQ,CAAE,IAAAC,EAAK,MAAOY,EAAIC,CAAO,CAAG,CAAA,CAAE,CAAC,EAClFC,CACjB,CAAS,GAED,OAAOhB,CAAI,EAAE,QAAQE,EAAKI,EAAUQ,CAAG,CAAC,EACxC,OAAO,cAAc,IAAI,YAAYb,EAAW,CAAE,OAAQ,CAAE,IAAAC,EAAK,MAAOY,CAAK,CAAA,CAAE,CAAC,EAChFH,EAASG,CAAG,EAEpB,EAAO,CAACZ,CAAG,CAAC,EACFe,EAAqBT,EAAAA,YAAY,IAAM,CAC3C,OAAOR,CAAI,EAAE,WAAWE,CAAG,EAC3B,OAAO,cAAc,IAAI,YAAYD,EAAW,CAAE,OAAQ,CAAE,IAAAC,EAAK,MAAOC,CAAc,CAAA,CAAE,CAAC,CAC1F,EAAE,CAAE,CAAA,EACL,OAAAe,EAAe,UAAYC,GAAU,CACnC,IAAIC,EACAD,EAAM,cAAgB,OAAOnB,CAAI,GAAKmB,EAAM,MAAQjB,GACtDS,EAASN,GAAae,EAAKD,EAAM,WAAa,KAAOC,EAAK,MAAM,CAAC,CAEzE,CAAK,EACDF,EAAejB,EAAYkB,GAAU,CAC/BA,EAAM,OAAO,MAAQjB,GACvBS,EAASQ,EAAM,OAAO,KAAK,CAEnC,CAAK,EACDE,EAAAA,UAAU,IAAM,CACVlB,IAAiB,QAAUP,IAAU,QACvCiB,EAAgBV,CAAY,CAE/B,EAAE,CAACA,EAAcP,EAAOiB,CAAe,CAAC,EACzCQ,EAAAA,UAAU,IAAM,CACVjB,GACFO,EAASJ,EAAgB,CAAE,CAEnC,EAAO,CAACL,CAAG,CAAC,EACD,CACLN,IAAU,OAASO,EAAeP,EAClCiB,EACAI,CACN,CACA,CACA,CC7EA,SAASK,EAAgBC,EAAO,CAC9B,OAAOxB,EAAc,eAAgB,mBAAmB,EAAEwB,CAAK,CACjE","x_google_ignoreList":[0,1]}