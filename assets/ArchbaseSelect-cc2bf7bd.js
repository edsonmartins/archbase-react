import{j as C}from"./jsx-runtime-c9381026.js";import{r as o,R as M}from"./index-8b3efc3f.js";import{l as w}from"./lodash-4d0be66a.js";import{b as ve,d as he,c as qe}from"./useArchbaseDataSource-c5d317be.js";import"./index-9e992aa6.js";import{a as Ve}from"./ArchbaseAsyncSelect.context-0429ae81.js";import{D as b,A as x}from"./useArchbaseDataSourceListener-92dd263c.js";import{S as Ee}from"./Select-b5581873.js";function ge(r,d,e={leading:!1}){const[n,u]=o.useState(r),t=o.useRef(null),l=o.useRef(!0),s=()=>window.clearTimeout(t.current);o.useEffect(()=>s,[]);const p=o.useCallback(m=>{s(),l.current&&e.leading?u(m):t.current=window.setTimeout(()=>{l.current=!0,u(m)},d),l.current=!1},[e.leading]);return[n,p]}const Ce=M.createContext({}),we=Ce.Provider;function xe(r){let d=r.map(n=>n.group).filter((n,u,t)=>t.indexOf(n)===u),e=[];return d.forEach(n=>{const u={group:n,items:r.filter(t=>t.group===n).sort((t,l)=>t.label.localeCompare(l.label)).map(t=>({value:t.value,label:t.label,origin:t.origin!==void 0?t.origin:t.value}))};e.push(u)}),e}function Oe(r,d,e,n,u,t){if(!d&&!e&&!r)return[];if(r&&r instanceof x&&n&&u&&t){const l=r;l.first();const s=[];for(;!l.isEOF();)s.push({label:l.getFieldValue(t),value:u(l.getCurrentRecord()),origin:l.getCurrentRecord(),key:w.uniqueId("select")}),l.next();return l.first(),s}return r&&Array.isArray(r)&&r.length>0&&r[0].group?xe(r):r||(e?M.Children.toArray(e).map(l=>{const{label:s,value:p,origin:m,...E}=l.props;return{label:s,value:p,origin:m!==void 0?m:p,key:w.uniqueId("select"),...E}}):d.map(l=>({label:n(l),value:u(l),origin:l,key:w.uniqueId("select")})))}function O({allowDeselect:r=!0,clearable:d=!0,dataSource:e,dataField:n,disabled:u=!1,debounceTime:t=500,readOnly:l=!1,placeholder:s,initialOptions:p=[],searchable:m=!1,label:E,description:j,error:W,icon:U,iconWidth:G,required:Q,width:Z,getOptionLabel:h,getOptionValue:R,optionsLabelField:A,onFocusEnter:D,onFocusExit:S,onSelectValue:F,value:I,defaultValue:T,filter:Re,size:J,initiallyOpened:K,itemComponent:g,onDropdownOpen:X,onDropdownClose:Y,limit:$,nothingFound:ee,zIndex:Ae,style:ae={},dropdownPosition:De,children:P,innerRef:ne,options:c,customGetDataSourceFieldValue:q,customSetDataSourceFieldValue:z}){const le=ne||o.useRef(),[f,_]=o.useState(I),[Se,re]=ge("",t),[te,L]=o.useState(W),[oe,N]=o.useState(0),y=o.useRef(),ue=o.useContext(Ve),ie=o.useMemo(()=>Oe(c,p,P,h,R,A),[oe,c,p,P,h,R,A]);o.useEffect(()=>{L(void 0)},[f]);const V=()=>{let a=I;e&&n&&!e.isEmpty()&&(a=q?q():e.getFieldValue(n),a||(a="")),_(a)},k=o.useCallback(()=>{V()},[]),H=o.useCallback(a=>{e&&n&&((a.type===b.dataChanged||a.type===b.recordChanged||a.type===b.afterScroll||a.type===b.afterCancel)&&V(),a.type===b.onFieldError&&a.fieldName===n&&(L(a.error),N(i=>i+1)))},[]),B=o.useCallback(a=>{e&&n&&a.type===b.dataChanged&&N(i=>i+1)},[]);ve(()=>{V(),e&&n&&(e.addListener(H),e.addFieldChangeListener(n,k)),c&&c instanceof x&&c.addListener(B)}),he(()=>{e&&n&&(e.removeListener(H),e.removeFieldChangeListener(n,k)),c&&c instanceof x&&c.removeListener(B)}),qe(()=>{V()},[]);const se=(a,i)=>{const v=i.origin;_(Fe=>v),e&&!e.isBrowsing()&&n&&(q?q():e.getFieldValue(n))!==v&&(z?z(v):e.setFieldValue(n,v)),F&&F(v,i?i.origin:void 0)},de=a=>{S&&S(a)},ce=a=>{D&&D(a)},pe=()=>{},me=a=>{y&&y.current&&y.current.scrollTop===y.current.scrollHeight-y.current.offsetHeight&&ue.handleDropdownScrollEnded()},fe=()=>{let a=l;return e&&!l&&(a=e.isBrowsing()),a},ye=({option:a,checked:i})=>{if(g)return C(g,{...a,checked:i})},be=g?{renderOption:({option:a,checked:i})=>ye({option:a,checked:i})}:{};return C(we,{value:{handleDropdownScrollEnded:pe},children:C(Ee,{style:ae,allowDeselect:r,clearable:d,disabled:u,description:j,placeholder:s,searchable:m,maxDropdownHeight:280,ref:le,label:E,error:te,data:ie,size:J,leftSection:U,width:Z,leftSectionWidth:G,readOnly:fe(),required:Q,onChange:se,onBlur:de,onFocus:ce,value:f,onSearchChange:re,defaultValue:f?h(f):T,searchValue:f?h(f):T,defaultDropdownOpened:K,onDropdownOpen:X,onDropdownClose:Y,limit:$,nothingFoundMessage:ee,scrollAreaProps:{viewportProps:{tabIndex:-1},viewportRef:y,onScrollPositionChange:me},...be})})}O.displayName="ArchbaseSelect";try{O.displayName="ArchbaseSelect",O.__docgenInfo={description:"",displayName:"ArchbaseSelect",props:{allowDeselect:{defaultValue:{value:"true"},description:"Permite ou não delecionar um item",name:"allowDeselect",required:!1,type:{name:"boolean"}},clearable:{defaultValue:{value:"true"},description:"Indicador se permite limpar o select",name:"clearable",required:!1,type:{name:"boolean"}},dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o item selecionado",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o item selecionado na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},debounceTime:{defaultValue:{value:"500"},description:"Tempo de espero antes de realizar a busca",name:"debounceTime",required:!1,type:{name:"number"}},disabled:{defaultValue:{value:"false"},description:"Indicador se o select está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:{value:"false"},description:"Indicador se o select é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},style:{defaultValue:{value:"{}"},description:"Estilo do select",name:"style",required:!1,type:{name:"MantineStyleProp"}},placeholder:{defaultValue:null,description:"Texto explicativo do select",name:"placeholder",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"Título do select",name:"label",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"Descrição do select",name:"description",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Último erro ocorrido no select",name:"error",required:!1,type:{name:"string"}},searchable:{defaultValue:{value:"false"},description:"Permite pesquisar no select",name:"searchable",required:!1,type:{name:"boolean"}},icon:{defaultValue:null,description:"Icon a esquerda do select",name:"icon",required:!1,type:{name:"ReactNode"}},iconWidth:{defaultValue:null,description:"Largura do icone a esquerda do select",name:"iconWidth",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},value:{defaultValue:null,description:"Valor de entrada controlado",name:"value",required:!1,type:{name:"any"}},defaultValue:{defaultValue:null,description:"Valor padrão de entrada não controlado",name:"defaultValue",required:!1,type:{name:"any"}},filter:{defaultValue:null,description:"Função com base em quais itens no menu suspenso são filtrados",name:"filter",required:!1,type:{name:"(value: string, item: any) => boolean"}},size:{defaultValue:null,description:"Tamanho de entrada",name:"size",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},initiallyOpened:{defaultValue:null,description:"Estado aberto do menu suspenso inicial",name:"initiallyOpened",required:!1,type:{name:"boolean"}},itemComponent:{defaultValue:null,description:"Alterar renderizador de item",name:"itemComponent",required:!1,type:{name:"FC<any>"}},width:{defaultValue:null,description:"Largura do select",name:"width",required:!1,type:{name:"string | number"}},onDropdownOpen:{defaultValue:null,description:"Chamado quando o menu suspenso é aberto",name:"onDropdownOpen",required:!1,type:{name:"() => void"}},onDropdownClose:{defaultValue:null,description:"Chamado quando o menu suspenso é aberto",name:"onDropdownClose",required:!1,type:{name:"() => void"}},limit:{defaultValue:null,description:"Limite a quantidade de itens exibidos por vez para seleção pesquisável",name:"limit",required:!1,type:{name:"number"}},nothingFound:{defaultValue:null,description:"Rótulo nada encontrado",name:"nothingFound",required:!1,type:{name:"ReactNode"}},zIndex:{defaultValue:null,description:"Índice z dropdown",name:"zIndex",required:!1,type:{name:"ZIndex"}},dropdownPosition:{defaultValue:null,description:"Comportamento de posicionamento dropdown",name:"dropdownPosition",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"bottom"'},{value:'"flip"'}]}},onSelectValue:{defaultValue:null,description:"Evento quando um valor é selecionado",name:"onSelectValue",required:!1,type:{name:"(value: O, origin: any) => void"}},onFocusExit:{defaultValue:null,description:"Evento quando o foco sai do select",name:"onFocusExit",required:!1,type:{name:"FocusEventHandler<T>"}},onFocusEnter:{defaultValue:null,description:"Evento quando o select recebe o foco",name:"onFocusEnter",required:!1,type:{name:"FocusEventHandler<T>"}},initialOptions:{defaultValue:{value:"[]"},description:"Opções de seleção iniciais",name:"initialOptions",required:!1,type:{name:"O[]"}},getOptionLabel:{defaultValue:null,description:"Function que retorna o label de uma opção",name:"getOptionLabel",required:!0,type:{name:"(option: O) => ReactNode"}},getOptionValue:{defaultValue:null,description:"Function que retorna o valor de uma opção",name:"getOptionValue",required:!0,type:{name:"(option: O) => any"}},children:{defaultValue:null,description:"Coleção de ArchbaseSelectItem[] que representam as opções do select",name:"children",required:!1,type:{name:"ReactNode | ReactNode[]"}},required:{defaultValue:null,description:"Indica se o select tem o preenchimento obrigatório",name:"required",required:!1,type:{name:"boolean"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}},options:{defaultValue:null,description:"Selecione os dados usados ​​para renderizar itens no menu suspenso",name:"options",required:!1,type:{name:"readonly (string | SelectItem)[] | ArchbaseDataSource<any, any>"}},optionsLabelField:{defaultValue:null,description:"",name:"optionsLabelField",required:!1,type:{name:"string"}},customGetDataSourceFieldValue:{defaultValue:null,description:"",name:"customGetDataSourceFieldValue",required:!1,type:{name:"() => any"}},customSetDataSourceFieldValue:{defaultValue:null,description:"",name:"customSetDataSourceFieldValue",required:!1,type:{name:"(value: any) => void"}}}}}catch{}export{O as A};
