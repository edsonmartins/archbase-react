import{j as a,a as v}from"./jsx-runtime-29545a09.js";import{A as me}from"./DemoIOCTypes-d657846a.js";import{b as ce,c as fe,d as he,u as ye,a as be}from"./useArchbaseDataSource-0bdc03a6.js";import{D as h,i as Ee,u as ge}from"./useArchbaseDataSourceListener-cbed610e.js";import{u as Ve,p as qe}from"./useArchbaseRemoteServiceApi-05255476.js";import{A as ve}from"./ArchbaseEdit-8e23860f.js";import{r as f}from"./index-76fb7be0.js";import{A as Ae}from"./ArchbaseNumberEdit-06b92a0b.js";import{b as we,B as Ce}from"./polymorphic-factory-e212381f.js";import{u as xe}from"./use-mantine-color-scheme-940af2ab.js";import{T as ke}from"./Tooltip-6d7d1342.js";import{A as Ne}from"./ActionIcon-23bc393d.js";import{I as De}from"./IconSearch-ce888152.js";import{f as A}from"./string-utils-e92dc4e1.js";import{G as L,C as w}from"./Grid-72b79d89.js";import{G as j}from"./Group-ec80c87c.js";import{T as B}from"./Text-052cbebe.js";import{F as Fe}from"./Flex-472ba316.js";import{S as Ie}from"./ScrollArea-d1e51cef.js";import{A as Le}from"./ArchbaseObjectInspector-39e1a2c0.js";import{A as G}from"./ArchbaseNotifications-c6fc9152.js";import{p as Se}from"./pedidosData-e328d4f3.js";import"./i18next-a4b2730f.js";import"./lodash-4d0be66a.js";import"./_commonjsHelpers-de833af9.js";import"./index-83127612.js";import"./index-1076ae77.js";import"./use-force-update-df6d2b99.js";import"./TextInput-256f3fb5.js";import"./InputBase-b1a2e9dc.js";import"./Input-abb5d566.js";import"./create-optional-context-e52a7171.js";import"./use-id-9525279e.js";import"./use-isomorphic-effect-f46ba680.js";import"./use-input-props-0bcecfab.js";import"./index-d3ea75b5.js";import"./CloseButton-c44b8f52.js";import"./UnstyledButton-6bceb5b8.js";import"./Mantine.context-0732ca39.js";import"./use-media-query-404d9c84.js";import"./OptionalPortal-d3ff2b4f.js";import"./use-merged-ref-962e80ee.js";import"./DirectionProvider-3f93a9e9.js";import"./use-floating-auto-update-8b56efba.js";import"./use-did-update-4c7f685e.js";import"./Transition-7fd90e94.js";import"./use-reduced-motion-94535b68.js";import"./get-style-object-71cabcb5.js";import"./Loader-2934e180.js";import"./createReactComponent-1d99d95b.js";import"./index-9d475cdf.js";import"./index-44ceb156.js";import"./Paper-9304c07a.js";import"./create-safe-context-978e3819.js";import"./get-sorted-breakpoints-91e0685a.js";import"./px-90b8b31c.js";import"./notifications.store-cc6c29fc.js";import"./store-8002eacc.js";import"./IconBug-81bb8ee5.js";import"./types-5decf4ed.js";function U(e,t,r){let l=e;return t&&r&&(l=t.getFieldValue(r),l||(l="")),l}function x({dataSource:e,dataField:t,lookupField:r,iconSearch:l,disabled:k=!1,readOnly:b=!1,style:N,placeholder:s,label:D,description:F,error:y,required:Y,size:J,width:K,value:u,lookupValueDelegator:S,onLookupError:d,onLookupResult:E,validateMessage:p,tooltipIconSearch:Q="Clique aqui para Localizar",validateOnExit:P=!0,onFocusExit:O=()=>{},onFocusEnter:z=()=>{},onChangeValue:T=()=>{},onActionSearchExecute:X=()=>{},innerRef:Z,decimalSeparator:$,thousandSeparator:ee,precision:re=0,allowNegative:oe=!1,allowEmpty:ae=!0}){const g=we(),{colorScheme:ie}=xe(),[m,V]=f.useState(U(u,e,r)),I=Z||f.useRef(),[te,c]=f.useState(y);f.useEffect(()=>{c(void 0)},[m]);const q=()=>{const o=U(m,e,r);V(o),c(void 0)},R=f.useCallback(()=>{q()},[]),_=f.useCallback(o=>{e&&t&&((o.type===h.dataChanged||o.type===h.recordChanged||o.type===h.afterScroll||o.type===h.afterCancel)&&q(),o.type===h.onFieldError&&o.fieldName===t&&c(o.error))},[]);ce(()=>{q(),e&&r&&(e.addListener(_),e.addFieldChangeListener(r,R))}),fe(()=>{q()},[]),he(()=>{e&&t&&(e.removeListener(_),e.removeFieldChangeListener(t,R))});const ne=(o,i,n)=>{c(void 0),V(ze=>i),T&&T(n,i)},le=()=>{e&&t&&!e.isBrowsing()&&r?m!=e.getFieldValue(r)&&(!m||m==null?e.setFieldValue(t,null):S(m).then(i=>{(!i||i==null)&&P&&p&&d&&d(A(p,u)),E&&E(i),e.setFieldValue(t,i)}).catch(i=>{var n;e.setFieldValue(t,null),(n=I.current)==null||n.focus(),p&&c(A(p,u)),d&&d(i)})):u&&u!=null&&S(u).then(i=>{(!i||i==null)&&P&&p&&d&&d(A(p,u)),E&&E(i);let n=Ee.getNestedProperty(i,r);n||(n=""),V(n)}).catch(i=>{var n;V(void 0),p&&c(A(p,u)),(n=I.current)==null||n.focus(),d&&d(i)})},se=o=>{le(),O&&O(o)},ue=o=>{z&&z(o)},de=()=>{let o=b;return e&&!b&&(o=e.isBrowsing()),o},pe=l||a(De,{size:"1rem"});return a(Ae,{disabled:k,required:Y,value:m,readOnly:de(),onChangeValue:ne,innerRef:I,onFocusEnter:ue,onFocusExit:se,placeholder:s,description:F,label:D,error:te,style:N,size:J,width:K,decimalSeparator:$,thousandSeparator:ee,precision:re,allowNegative:oe,allowEmpty:ae,rightSection:a(ke,{withinPortal:!0,withArrow:!0,label:Q,children:a(Ne,{style:{backgroundColor:ie==="dark"?g.colors[g.primaryColor][5]:g.colors[g.primaryColor][6]},tabIndex:-1,variant:"filled",onClick:X,children:pe})})})}try{x.displayName="ArchbaseLookupNumber",x.__docgenInfo={description:"",displayName:"ArchbaseLookupNumber",props:{dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o valor do lookup edit",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o valor do lookup edit na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},lookupField:{defaultValue:null,description:"Campo da fonte de dados que será usado para apresentar o valor no lookup edit",name:"lookupField",required:!1,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"Indicador se o lookup edit está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:{value:"false"},description:"Indicador se o lookup edit é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"Indicador se o preenchimento do lookup edit é obrigatório",name:"required",required:!1,type:{name:"boolean"}},validateOnExit:{defaultValue:{value:"true"},description:"Validar ao sair do campo se localizou o valor",name:"validateOnExit",required:!1,type:{name:"boolean"}},validateMessage:{defaultValue:null,description:"Mensagem caso falhe ao localizar o valor",name:"validateMessage",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"Estilo do lookup edit",name:"style",required:!1,type:{name:"CSSProperties"}},size:{defaultValue:null,description:"Tamanho do campo",name:"size",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},width:{defaultValue:null,description:"Largura do lookup edit",name:"width",required:!1,type:{name:"string | number"}},placeholder:{defaultValue:null,description:"Texto sugestão do lookup edit",name:"placeholder",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"Título do lookup edit",name:"label",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"Descrição do lookup edit",name:"description",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Último erro ocorrido no lookup edit",name:"error",required:!1,type:{name:"string"}},iconSearch:{defaultValue:null,description:"Icone para apresentar lado direito do lookup edit que representa a busca",name:"iconSearch",required:!1,type:{name:"ReactNode"}},tooltipIconSearch:{defaultValue:{value:"Clique aqui para Localizar"},description:"Dica para botão localizar",name:"tooltipIconSearch",required:!1,type:{name:"string"}},decimalSeparator:{defaultValue:null,description:"Caracter separador decimal",name:"decimalSeparator",required:!1,type:{name:"string"}},thousandSeparator:{defaultValue:null,description:"Caracter separador de milhar",name:"thousandSeparator",required:!1,type:{name:"string"}},precision:{defaultValue:{value:"0"},description:"Número de casas decimais",name:"precision",required:!1,type:{name:"number"}},allowNegative:{defaultValue:{value:"false"},description:"Permite números negativos",name:"allowNegative",required:!1,type:{name:"boolean"}},allowEmpty:{defaultValue:{value:"true"},description:"Aceita em branco",name:"allowEmpty",required:!1,type:{name:"boolean"}},value:{defaultValue:null,description:"Valor atual caso não esteje usando fonte de dados",name:"value",required:!1,type:{name:"any"}},onActionSearchExecute:{defaultValue:{value:"() => {}"},description:"Evento ocorre quando clica no botão localizar",name:"onActionSearchExecute",required:!1,type:{name:"() => void"}},onFocusExit:{defaultValue:{value:"() => {}"},description:"Evento quando o foco sai do lookup edit",name:"onFocusExit",required:!1,type:{name:"FocusEventHandler<T>"}},onFocusEnter:{defaultValue:{value:"() => {}"},description:"Evento quando o lookup edit recebe o foco",name:"onFocusEnter",required:!1,type:{name:"FocusEventHandler<T>"}},onChangeValue:{defaultValue:{value:"() => {}"},description:"Evento quando o valor do lookup edit é alterado",name:"onChangeValue",required:!1,type:{name:"(value: any, event: any) => void"}},onLookupResult:{defaultValue:null,description:"Evento ocorre quando um valor é localizado",name:"onLookupResult",required:!1,type:{name:"(value: O) => void"}},onLookupError:{defaultValue:null,description:"Evento ocorre quando se obtém um erro ao localizar valor",name:"onLookupError",required:!1,type:{name:"(error: string) => void"}},lookupValueDelegator:{defaultValue:null,description:"Função responsável por localizar um valor",name:"lookupValueDelegator",required:!0,type:{name:"(value: any) => Promise<O>"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}}}}}catch{}const Pe=Se,Oe=()=>{const e=ye(),t=Ve(me.Pessoa),{dataSource:r}=be({initialData:Pe,name:"dsPedidos"});r!=null&&r.isBrowsing()&&!(r!=null&&r.isEmpty())&&r.edit(),ge({dataSource:r,listener:s=>{switch(s.type){case h.fieldChanged:{e();break}}}});const l=s=>new Promise(async(D,F)=>{try{const y=await t.findOne(parseInt(s));D(y)}catch(y){F(qe(y))}}),k=s=>{G.showError(s,"Atenção")},b=s=>{},N=()=>{G.showError("Clicou ação localizar.","Atenção")};return v(L,{children:[a(L.Col,{offset:1,span:4,children:v(w,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[a(w.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:a(j,{justify:"space-between",children:a(B,{fw:500,children:"Lookup Number Component"})})}),a(Ce,{style:{height:100},children:v(Fe,{justify:"flex-start",align:"center",direction:"row",wrap:"nowrap",gap:"xs",children:[a(x,{label:"Código",dataSource:r,dataField:"cliente",lookupField:"cliente.id",lookupValueDelegator:l,onLookupError:k,onLookupResult:b,onActionSearchExecute:N,validateOnExit:!0,required:!0,validateMessage:"Pessoa {0} não encontrada.",width:150}),a(ve,{label:"Nome",dataSource:r,dataField:"cliente.nome",disabled:!0,width:500})]})})]})}),a(L.Col,{span:4,children:v(w,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[a(w.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:a(j,{justify:"space-between",children:a(B,{fw:500,children:"DataSource dsPedidos"})})}),a(Ie,{style:{height:500},children:a(Le,{data:r})})]})})]})},Ur={title:"Editores/Lookup Number",component:x},C={name:"Exemplo simples",render:()=>a(Oe,{})};var H,M,W;C.parameters={...C.parameters,docs:{...(H=C.parameters)==null?void 0:H.docs,source:{originalSource:`{
  name: 'Exemplo simples',
  render: () => <ArchbaseLookupNumberExample />
}`,...(W=(M=C.parameters)==null?void 0:M.docs)==null?void 0:W.source}}};export{C as Primary,Ur as default};
