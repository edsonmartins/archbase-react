import{j as o,a as K}from"./jsx-runtime-29545a09.js";import{b as Te,d as Me,c as ze,u as Pe,a as ke}from"./useArchbaseDataSource-0bdc03a6.js";import{D as q,u as Le}from"./useArchbaseDataSourceListener-cbed610e.js";import"./index-1076ae77.js";import{R as s,r as f}from"./index-76fb7be0.js";import{u as je}from"./use-force-update-df6d2b99.js";import{I as $e}from"./Input-abb5d566.js";import{B as Y,f as Ue,u as Ge,h as He,i as We,q as Xe,m as Ke}from"./polymorphic-factory-e212381f.js";import{u as he}from"./DirectionProvider-3f93a9e9.js";import{c as Qe}from"./create-safe-context-978e3819.js";import{u as ue}from"./use-id-9525279e.js";import{u as Je}from"./use-uncontrolled-625105b4.js";import{u as Ye}from"./use-merged-ref-962e80ee.js";import{c as Ze}from"./clamp-73f6bef2.js";import{G as Q,C as T}from"./Grid-72b79d89.js";import{G as de}from"./Group-ec80c87c.js";import{T as ce}from"./Text-052cbebe.js";import{S as et}from"./ScrollArea-d1e51cef.js";import{A as tt}from"./ArchbaseObjectInspector-39e1a2c0.js";import{p as at}from"./pessoasData-6b8000da.js";import"./i18next-a4b2730f.js";import"./lodash-4d0be66a.js";import"./_commonjsHelpers-de833af9.js";import"./index-83127612.js";import"./create-optional-context-e52a7171.js";import"./Mantine.context-0732ca39.js";import"./use-isomorphic-effect-f46ba680.js";import"./Paper-9304c07a.js";import"./get-sorted-breakpoints-91e0685a.js";import"./px-90b8b31c.js";import"./use-mantine-color-scheme-940af2ab.js";import"./use-media-query-404d9c84.js";import"./types-5decf4ed.js";const[nt,ye]=Qe("Rating was not found in tree");function ge(t){const{width:e,height:r,style:p,...i}=t;return s.createElement("svg",{viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:e,height:r,...p},...i},s.createElement("path",{d:"M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z"}))}ge.displayName="@mantine/core/StarIcon";function Z({type:t}){const e=ye();return s.createElement(ge,{...e.getStyles("starSymbol"),"data-filled":t==="full"||void 0})}Z.displayName="@mantine/core/StarSymbol";function be({getSymbolLabel:t,emptyIcon:e,fullIcon:r,full:p,active:i,value:c,readOnly:E,fractionValue:h,color:x,id:v,onBlur:C,onChange:S,onInputChange:F,style:O,...V}){var d;const y=ye(),R=typeof r=="function"?r(c):r,u=typeof e=="function"?e(c):e,{dir:g}=he();return s.createElement(s.Fragment,null,!E&&s.createElement("input",{...y.getStyles("input"),onKeyDown:m=>m.key===" "&&S(c),id:v,type:"radio","data-active":i||void 0,"aria-label":t==null?void 0:t(c),value:c,onBlur:C,onChange:F,...V}),s.createElement(Y,{component:E?"div":"label",...y.getStyles("label"),"data-read-only":E||void 0,htmlFor:v,onClick:()=>S(c),__vars:{"--rating-item-z-index":(d=h===1?void 0:i?2:0)==null?void 0:d.toString()}},s.createElement(Y,{...y.getStyles("symbolBody"),__vars:{"--rating-symbol-clip-path":h===1?void 0:g==="ltr"?`inset(0 ${i?100-h*100:100}% 0 0)`:`inset(0 0 0 ${i?100-h*100:100}% )`}},p?R||s.createElement(Z,{type:"full"}):u||s.createElement(Z,{type:"empty"}))))}be.displayName="@mantine/core/RatingItem";var Ee={root:"m_f8d312f2",symbolGroup:"m_61734bb7",starSymbol:"m_5662a89a",input:"m_211007ba",label:"m_21342ee4",symbolBody:"m_fae05d6a"};function J(t,e){var i;const r=Math.round(t/e)*e,p=((i=`${e}`.split(".")[1])==null?void 0:i.length)||0;return Number(r.toFixed(p))}const rt={size:"sm",getSymbolLabel:t=>`${t}`,count:5,fractions:1,color:"yellow"},ot=We((t,{size:e,color:r})=>({root:{"--rating-size":Xe(e,"rating-size"),"--rating-color":Ke(r,t)}})),ee=Ue((t,e)=>{const r=Ge("Rating",rt,t),{classNames:p,className:i,style:c,styles:E,unstyled:h,vars:x,name:v,id:C,value:S,defaultValue:F,onChange:O,fractions:V,count:y,onMouseEnter:R,readOnly:u,onMouseMove:g,onHover:d,onMouseLeave:m,onTouchStart:_,onTouchEnd:D,size:P,variant:k,getSymbolLabel:L,color:te,emptySymbol:a,fullSymbol:ae,highlightSelectedOnly:ve,...Ve}=r,j=He({name:"Rating",classes:Ee,props:r,className:i,style:c,classNames:p,styles:E,unstyled:h,vars:x,varsResolver:ot}),{dir:Re}=he(),qe=ue(v),ne=ue(C),re=f.useRef(null),[Ce,$]=Je({value:S,defaultValue:F,finalValue:0,onChange:O}),[I,N]=f.useState(-1),[Se,oe]=f.useState(!0),U=Math.floor(V),G=Math.floor(y),w=1/U,se=J(Ce,w),H=I!==-1?I:se,ie=n=>{const{left:l,right:b,width:W}=re.current.getBoundingClientRect(),X=W/G,B=(Re==="rtl"?b-n:n-l)/X;return Ze(J(B+w/2,w),w,G)},_e=n=>{R==null||R(n),!u&&oe(!1)},De=n=>{if(g==null||g(n),u)return;const l=ie(n.clientX);N(l),l!==I&&(d==null||d(l))},we=n=>{m==null||m(n),!u&&(N(-1),oe(!0),I!==-1&&(d==null||d(-1)))},Ae=n=>{n.preventDefault();const{touches:l}=n;if(l.length!==1)return;const b=l[0];$(ie(b.clientX)),_==null||_(n)},xe=n=>{n.preventDefault(),D==null||D(n)},Fe=()=>Se&&N(-1),Ie=n=>{u||N(typeof n=="number"?n:parseFloat(n.target.value))},Ne=n=>{u||$(typeof n=="number"?n:parseFloat(n.target.value))},Be=Array(G).fill(0).map((n,l)=>{const b=l+1,W=Array.from(new Array(l===0?U+1:U)),X=!u&&Math.ceil(I)===b;return s.createElement("div",{key:b,"data-active":X||void 0,...j("symbolGroup")},W.map((Oe,B)=>{const le=w*(l===0?B:B+1),A=J(b-1+le,w);return s.createElement(be,{key:`${b}-${A}`,getSymbolLabel:L,emptyIcon:a,fullIcon:ae,full:ve?A===H:A<=H,active:A===H,checked:A===se,readOnly:u,fractionValue:le,value:A,name:qe,onChange:Ne,onBlur:Fe,onInputChange:Ie,id:`${ne}-${l}-${B}`})}))});return s.createElement(nt,{value:{getStyles:j}},s.createElement(Y,{ref:Ye(re,e),...j("root"),onMouseMove:De,onMouseEnter:_e,onMouseLeave:we,onTouchStart:Ae,onTouchEnd:xe,variant:k,size:P,id:ne,...Ve},Be))});ee.classes=Ee;ee.displayName="@mantine/core/Rating";function z({dataSource:t,dataField:e,readOnly:r=!1,style:p,size:i,innerRef:c,value:E,fractions:h,onFocusExit:x=()=>{},onFocusEnter:v=()=>{},onChangeValue:C=()=>{},error:S,label:F,description:O}){const[V,y]=f.useState(E),R=c||f.useRef(),[u,g]=f.useState(S),d=je();f.useEffect(()=>{g(void 0)},[V]);const m=()=>{let a=V;t&&e&&(a=t.getFieldValue(e),a||(a=0)),y(a)},_=f.useCallback(()=>{m()},[]),D=f.useCallback(a=>{t&&e&&((a.type===q.dataChanged||a.type===q.recordChanged||a.type===q.afterScroll||a.type===q.afterCancel||a.type===q.afterEdit)&&(m(),d()),a.type===q.onFieldError&&a.fieldName===e&&g(a.error))},[]);Te(()=>{m(),t&&e&&(t.addListener(D),t.addFieldChangeListener(e,_))}),Me(()=>{t&&e&&(t.removeListener(D),t.removeFieldChangeListener(e,_))}),ze(()=>{m()},[]);const P=a=>{y(ae=>a),t&&!t.isBrowsing()&&e&&t.getFieldValue(e)!==a&&t.setFieldValue(e,a),C&&C(a)},k=a=>{x&&x(a)},L=a=>{v&&v(a)},te=()=>{let a=r;return t&&!r&&(a=t.isBrowsing()),a};return o($e.Wrapper,{label:F,error:u,description:O,children:o(ee,{readOnly:te(),size:i,style:p,fractions:h,value:V,ref:R,onChange:P,onBlur:k,onFocus:L})})}try{z.displayName="ArchbaseRating",z.__docgenInfo={description:"",displayName:"ArchbaseRating",props:{dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o valor do rating",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o valor do rating na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"Indicador se o rating está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:{value:"false"},description:"Indicador se o rating é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"Indicador se o preenchimento do rating é obrigatório",name:"required",required:!1,type:{name:"boolean"}},count:{defaultValue:null,description:"Quantidade de controles a ser renderizado",name:"count",required:!0,type:{name:"number"}},value:{defaultValue:null,description:"Valor inicial",name:"value",required:!1,type:{name:"number"}},emptySymbol:{defaultValue:null,description:"O ícone que é exibido quando o símbolo está vazio",name:"emptySymbol",required:!1,type:{name:"ReactNode | ((value: number) => ReactNode)"}},fullSymbol:{defaultValue:null,description:"Este ícone que é exibido quando o símbolo está cheio",name:"fullSymbol",required:!1,type:{name:"ReactNode | ((value: number) => ReactNode)"}},fractions:{defaultValue:null,description:"Número de frações em que cada item pode ser dividido, 1 por padrão",name:"fractions",required:!1,type:{name:"number"}},onHover:{defaultValue:null,description:"Chamado quando o item é pairado",name:"onHover",required:!1,type:{name:"(value: number) => void"}},getSymbolLabel:{defaultValue:null,description:"A função deve retornar labelText para os símbolos",name:"getSymbolLabel",required:!1,type:{name:"(value: number) => string"}},name:{defaultValue:null,description:"Nome da avaliação, deve ser único na página",name:"name",required:!1,type:{name:"string"}},highlightSelectedOnly:{defaultValue:null,description:"Se verdadeiro, apenas o símbolo selecionado mudará para símbolo completo",name:"highlightSelectedOnly",required:!1,type:{name:"boolean"}},style:{defaultValue:null,description:"Estilo do rating",name:"style",required:!1,type:{name:"CSSProperties"}},label:{defaultValue:null,description:"Título do rating",name:"label",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"Descrição do rating",name:"description",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Último erro ocorrido no rating",name:"error",required:!1,type:{name:"string"}},size:{defaultValue:null,description:"Tamanho do rating",name:"size",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},onFocusExit:{defaultValue:{value:"() => {}"},description:"Evento quando o foco sai do rating",name:"onFocusExit",required:!1,type:{name:"FocusEventHandler<T>"}},onFocusEnter:{defaultValue:{value:"() => {}"},description:"Evento quando o rating recebe o foco",name:"onFocusEnter",required:!1,type:{name:"FocusEventHandler<T>"}},onChangeValue:{defaultValue:{value:"() => {}"},description:"Evento quando o valor do rating é alterado",name:"onChangeValue",required:!1,type:{name:"(value?: number) => void"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}}}}}catch{}const st=()=>{const t=Pe(),{dataSource:e}=ke({initialData:it,name:"dsPessoas"});return e!=null&&e.isBrowsing()&&!(e!=null&&e.isEmpty())&&e.edit(),Le({dataSource:e,listener:r=>{switch(r.type){case q.fieldChanged:{t();break}}}}),K(Q,{children:[o(Q.Col,{offset:1,span:4,children:K(T,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[o(T.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:o(de,{justify:"space-between",children:o(ce,{fw:500,children:"Rating Component"})})}),o(z,{label:"Avaliação",dataSource:e,dataField:"avaliacao",count:5})]})}),o(Q.Col,{span:4,children:K(T,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[o(T.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:o(de,{justify:"space-between",children:o(ce,{fw:500,children:"DataSource dsPessoas"})})}),o(et,{style:{height:500},children:o(tt,{data:e})})]})})]})},it=[at[0]],Lt={title:"Editores/Rating",component:z},M={name:"Exemplo simples",render:()=>o(st,{})};var me,pe,fe;M.parameters={...M.parameters,docs:{...(me=M.parameters)==null?void 0:me.docs,source:{originalSource:`{
  name: 'Exemplo simples',
  render: () => <ArchbaseRatingExample />
}`,...(fe=(pe=M.parameters)==null?void 0:pe.docs)==null?void 0:fe.source}}};export{M as Primary,Lt as default};
