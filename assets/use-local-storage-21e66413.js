import{r as c}from"./index-76fb7be0.js";function E(e,n,r){c.useEffect(()=>(window.addEventListener(e,n,r),()=>window.removeEventListener(e,n,r)),[e,n])}function C(e,n="use-local-storage"){try{return JSON.stringify(e)}catch{throw new Error(`@mantine/hooks ${n}: Failed to serialize the value`)}}function F(e){try{return e&&JSON.parse(e)}catch{return e}}function N(e){return{getItem:a=>{try{return window[e].getItem(a)}catch{return console.warn("use-local-storage: Failed to get value from storage, localStorage is blocked"),null}},setItem:(a,l)=>{try{window[e].setItem(a,l)}catch{console.warn("use-local-storage: Failed to set value to storage, localStorage is blocked")}},removeItem:a=>{try{window[e].removeItem(a)}catch{console.warn("use-local-storage: Failed to remove value from storage, localStorage is blocked")}}}}function O(e,n){const r=e==="localStorage"?"mantine-local-storage":"mantine-session-storage",{getItem:v,setItem:a,removeItem:l}=N(e);return function({key:o,defaultValue:s,getInitialValueInEffect:I=!0,deserialize:f=F,serialize:S=d=>C(d,n)}){const d=c.useCallback(t=>{let i;try{i=typeof window>"u"||!(e in window)||window[e]===null||!!t}catch{i=!0}if(i)return s;const u=v(o);return u!==null?f(u):s},[o,s]),[w,g]=c.useState(d(I)),m=c.useCallback(t=>{t instanceof Function?g(i=>{const u=t(i);return a(o,S(u)),window.dispatchEvent(new CustomEvent(r,{detail:{key:o,value:t(i)}})),u}):(a(o,S(t)),window.dispatchEvent(new CustomEvent(r,{detail:{key:o,value:t}})),g(t))},[o]),b=c.useCallback(()=>{l(o),window.dispatchEvent(new CustomEvent(r,{detail:{key:o,value:s}}))},[]);return E("storage",t=>{t.storageArea===window[e]&&t.key===o&&g(f(t.newValue??void 0))}),E(r,t=>{t.detail.key===o&&g(t.detail.value)}),c.useEffect(()=>{s!==void 0&&w===void 0&&m(s)},[s,w,m]),c.useEffect(()=>{const t=d();t!==void 0&&m(t)},[]),[w===void 0?s:w,m,b]}}function x(e){return O("localStorage","use-local-storage")(e)}export{E as a,x as u};
