import{j as H}from"./jsx-runtime-c9381026.js";import{r as u}from"./index-8b3efc3f.js";import{R as w}from"./index-a38d0dca.js";import{e as ge,d as z,b as he,c as W}from"./useArchbaseDataSource-c5d317be.js";import{u as ve}from"./use-force-update-11fe72c1.js";import{D as V}from"./useArchbaseDataSourceListener-92dd263c.js";import{C as be}from"./CloseButton-8aa53231.js";import{T as Ee}from"./TextInput-5c99df01.js";function I(t,a=2,x=".",y=",",A=!1,D="",q=""){if(a<0&&(a=0),a>20&&(a=20),t==null)return{value:0,maskedValue:""};if(t=String(t),t.length===0)return{value:0,maskedValue:""};let l=t.match(/\d/g)||["0"],h=!1;if(A){h=(t.match(/-/g)||[]).length%2===1;let d=!0;for(let p=0;p<l.length;p+=1)if(l[p]!=="0"){d=!1;break}d&&(h=!1)}for(;l.length<=a;)l.unshift("0");a>0&&l.splice(l.length-a,0,"."),l=Number(l.join("")).toFixed(a).split("");let v=Number(l.join("")),r=l.length-a-1;a>0?l[r]=x:r=l.length;for(let o=r-3;o>0;o-=3)l.splice(o,0,y);return D.length>0&&l.unshift(D),q.length>0&&l.push(q),A&&h&&(l.unshift("-"),v=-v),{value:v,maskedValue:l.join("").trim()}}function k({dataSource:t,dataField:a,disabled:x=!1,readOnly:y=!1,style:A,className:D="",onFocusExit:q=()=>{},onFocusEnter:l=()=>{},onChangeValue:h=()=>{},value:v=0,decimalSeparator:r=",",thousandSeparator:o=".",precision:d=2,allowNegative:p=!0,allowEmpty:R=!1,clearable:Z=!0,prefix:b="",suffix:c="",integer:Ve=!1,wrapperProps:ye,clearButtonProps:G,rightSection:J,unstyled:K,classNames:qe,width:Q,size:X,error:Y,innerRef:ee,...te}){const[ae,Ne]=u.useState(!1),[E,N]=u.useState(""),ne=ge(E),[le,C]=u.useState(),i=ee||u.useRef(),[Ce,M]=u.useState(0),[S,F]=u.useState(0),[re,P]=u.useState(Y),se=ve();u.useEffect(()=>{P(void 0)},[E,le]);const L=()=>{let e=v;t&&a&&(e=t.getFieldValue(a),e||(e="")),!e||e===null?e=R?null:"":(typeof e=="string"&&(o==="."&&(e=e.replace(/\./g,"")),r!=="."&&(e=e.replace(new RegExp(r,"g"),".")),e=e.replace(/[^0-9-.]/g,""),e=Number.parseFloat(e)),e=Number(e).toLocaleString(void 0,{style:"decimal",minimumFractionDigits:d,maximumFractionDigits:d}));const n=I(e,d,r,o,p,b,c);return{maskedValue:n.maskedValue,value:n.value}};z(()=>{t&&a&&(t.removeListener(O),t.removeFieldChangeListener(a,_))});const _=u.useCallback(()=>{j()},[]),j=()=>{if(t&&a){const e=t.getFieldValue(a),n=I(e,d,r,o,p,b,c);N(n.maskedValue),C(0)}},O=u.useCallback(e=>{t&&a&&((e.type===V.dataChanged||e.type===V.recordChanged||e.type===V.afterScroll||e.type===V.afterCancel||e.type===V.afterEdit)&&(j(),se()),e.type===V.onFieldError&&e.fieldName===a&&P(e.error))},[]);he(()=>{const e=L();N(e.maskedValue),C(e.value),t&&a&&(t.addListener(O),t.addFieldChangeListener(a,_));const n=w.findDOMNode(i.current),s=Math.min(n.selectionEnd?n.selectionEnd:0,n.value?n.value.length-c.length:0),m=Math.min(n.selectionStart?n.selectionStart:0,s);n.setSelectionRange(m,s)}),W(()=>{const e=w.findDOMNode(i.current),n=i!=null&&i.current?e.value:"",s=(n.match(/-/g)||[]).length%2===1,m=b.length+(s?1:0);let f=Math.max(m,Math.min(S,n.length-c.length)),g=Math.max(m,Math.min(S,f));const T=/[-[\]{}()*+?.,\\^$|#\s]/g,$=new RegExp(`${r.replace(T,"\\$&")}|${o.replace(T,"\\$&")}`,"g");if(E){const me=`${ne}`,ce=(E.match($)||[]).length,fe=(me.match($)||[]).length,U=Math.max(ce-fe,0);f+=U,g+=U;const pe=c.length+b.length+r.length+Number(d)+1;E.length===pe&&(f=n.length-c.length,g=f),e.setSelectionRange(g,f),F(f),M(g)}},[ae]),W(()=>{const e=L();N(e.maskedValue),C(e.value)},[]),z(()=>{t&&a&&(t.removeListener(O),t.removeFieldChangeListener(a,_))});const oe=e=>{e.preventDefault();const{maskedValue:n,value:s}=I(e.target.value,d,r,o,p,b,c);t&&!t.isBrowsing()&&a&&t.setFieldValue(a,s),e.persist(),N(m=>n),C(m=>s),h&&h(n,s,e)},B=e=>{F(0),M(0),q&&q(e)},ie=e=>{const n=w.findDOMNode(i.current),s=i!=null&&i.current?n.value:"",m=s.length-c.length,f=(s.match(/-/g)||[]).length%2===1,g=b.length+(f?1:0);e.target.setSelectionRange(g,m),F(m),M(g)},ue=J||(Z&&v&&!y?H(be,{variant:"transparent",onMouseDown:e=>e.preventDefault(),tabIndex:-1,onClick:()=>{N(e=>""),C(e=>0),t&&!t.isBrowsing()&&a&&t.setFieldValue(a,R?null:0)},unstyled:K,...G}):null),de=()=>{let e=y;return t&&!y&&(e=t.isBrowsing()),e};return H(Ee,{disabled:!!x,...te,className:D,ref:i,type:"text",value:E,rightSection:ue,size:X,error:re,style:{width:Q,...A},readOnly:de(),onChange:oe,onBlur:B,onFocus:ie,onMouseUp:B,styles:{input:{textAlign:"right"}}})}k.defaultProps={onChangeValue:()=>{},value:"0",decimalSeparator:",",thousandSeparator:".",precision:2,allowNegative:!1,prefix:"",suffix:"",readOnly:!1,integer:!1,disabled:!1,onFocusExit:()=>{},onFocusEnter:()=>{},allowEmpty:!0};k.displayName="ArchbaseNumberEdit";try{k.displayName="ArchbaseNumberEdit",k.__docgenInfo={description:"",displayName:"ArchbaseNumberEdit",props:{clearable:{defaultValue:{value:"true"},description:"Determina se o valor de entrada pode ser limpo, adiciona o botão limpar à seção direita, falso por padrão",name:"clearable",required:!1,type:{name:"boolean"}},clearButtonProps:{defaultValue:null,description:"Adereços adicionados ao botão limpar",name:"clearButtonProps",required:!1,type:{name:"CloseButtonProps"}},dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o valor do number edit",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o valor do number edit na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"Indicador se o number edit está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:{value:"false"},description:"Indicador se o number edit é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},style:{defaultValue:null,description:"Estilo do number edit",name:"style",required:!1,type:{name:"CSSProperties"}},size:{defaultValue:null,description:"Tamanho do number edit",name:"size",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},width:{defaultValue:null,description:"Largura do number edit",name:"width",required:!1,type:{name:"string | number"}},className:{defaultValue:{value:""},description:"Nome da classe para estilo do number edit",name:"className",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Último erro ocorrido no number edit",name:"error",required:!1,type:{name:"string"}},onFocusExit:{defaultValue:{value:"() => {}"},description:"Evento quando o foco sai do edit",name:"onFocusExit",required:!1,type:{name:"FocusEventHandler<T>"}},onFocusEnter:{defaultValue:{value:"() => {}"},description:"Evento quando o edit recebe o foco",name:"onFocusEnter",required:!1,type:{name:"FocusEventHandler<T>"}},onChangeValue:{defaultValue:{value:"() => {}"},description:"Evento quando o valor do edit é alterado",name:"onChangeValue",required:!1,type:{name:"(maskValue: any, value: number, event: any) => void"}},value:{defaultValue:{value:"0"},description:"Valor inicial do campo",name:"value",required:!1,type:{name:"string | number"}},decimalSeparator:{defaultValue:{value:","},description:"Caracter separador decimal",name:"decimalSeparator",required:!1,type:{name:"string"}},thousandSeparator:{defaultValue:{value:"."},description:"Caracter separador de milhar",name:"thousandSeparator",required:!1,type:{name:"string"}},precision:{defaultValue:{value:"2"},description:"Número de casas decimais",name:"precision",required:!1,type:{name:"number"}},allowNegative:{defaultValue:{value:"false"},description:"Permite números negativos",name:"allowNegative",required:!1,type:{name:"boolean"}},allowEmpty:{defaultValue:{value:"true"},description:"Aceita em branco",name:"allowEmpty",required:!1,type:{name:"boolean"}},prefix:{defaultValue:{value:""},description:"Prefixo",name:"prefix",required:!1,type:{name:"string"}},suffix:{defaultValue:{value:""},description:"Sufixo",name:"suffix",required:!1,type:{name:"string"}},integer:{defaultValue:{value:"false"},description:"Indicador se aceita apenas números inteiros",name:"integer",required:!1,type:{name:"boolean"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}}}}}catch{}export{k as A};
