import{r as d}from"./index-402471b7.js";import{a as u,K as l}from"./ArchbaseGlobalFilter-42984565.js";import"./ArchbaseRemoteApiService-1c9bc946.js";const y=i=>{const{initialData:e,name:t,initialDataSource:a,onLoadComplete:o,validator:r}=i,[n,m]=d.useState(a??new g(t,{records:e,grandTotalRecords:e.length,currentPage:0,totalPages:0,pageSize:0,validator:r}));return d.useEffect(()=>{m(s=>{const c={records:e,grandTotalRecords:e.length,totalPages:0,currentPage:0,pageSize:0,validator:r};return s.isActive()?s.setData(c):s.open(c),s}),o&&o(n)},[e,t]),{dataSource:n}};class h{constructor(e={}){Object.assign(this,e)}}class g extends u{getFilterById(e){if(this.locate({id:e}))return this.convertCurrentRecordToFilter()}convertCurrentRecordToFilter(){return l.createInstanceWithValues({id:this.getFieldValue("id"),name:this.getFieldValue("name"),code:this.getFieldValue("code"),companyId:this.getFieldValue("companyId"),viewName:this.getFieldValue("viewName"),componentName:this.getFieldValue("componentName"),userName:this.getFieldValue("userName"),shared:this.getFieldValue("shared"),filter:atob(this.getFieldValue("filter"))})}async addNewFilter(e,t){this.insert(new h({id:e.id,code:e.code,name:e.name,companyId:e.companyId,componentName:e.componentName,filter:btoa(JSON.stringify(e.filter)),shared:e.shared,viewName:e.viewName,userName:e.userName}));const a=await this.save();t(null,a.id)}async saveFilter(e,t){if(this.locate({id:e.id})){this.edit(),this.setFieldValue("filter",btoa(JSON.stringify(e.filter)));const a=await this.save();t(null,a.id)}else t("Filtro não encontrado.")}async removeFilterBy(e,t){this.locate({id:e.id})?(await this.remove(),t(null,e.id)):t("Filtro não encontrado.")}getFirstFilter(){if(this.getTotalRecords()>0)return this.first(),this.convertCurrentRecordToFilter()}getFilters(){return this.getTotalRecords()>0?this.browseRecords().map(e=>l.createInstanceWithValues({id:e.id,name:e.name,code:e.code,companyId:e.companyId,viewName:e.viewName,componentName:e.componentName,userName:e.userName,shared:e.shared,filter:atob(e.filter||"")})):[]}}export{y as u};
//# sourceMappingURL=ArchbaseLocalFilterDataSource-ea7a24a1.js.map
