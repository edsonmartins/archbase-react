import{a as C,j as a}from"./jsx-runtime-c9381026.js";import{b as Ce,c as Ee,d as Ie,u as Se,a as Me}from"./useArchbaseDataSource-c5d317be.js";import{D as P,u as Ne}from"./useArchbaseDataSourceListener-92dd263c.js";import"./index-9e992aa6.js";import{r as p,R as oe}from"./index-8b3efc3f.js";import{u as Re}from"./use-force-update-11fe72c1.js";import{I as ze}from"./Input-fd05546d.js";import{i as M}from"./i18next-a4b2730f.js";import{u as Ae}from"./useArchbaseTheme-1c7b72e2.js";import{I as Be}from"./IconX-efebeb5f.js";import{B as he}from"./Button-b5284ed4.js";import{c as j}from"./createReactComponent-60e598cf.js";import{T as Q}from"./Text-55a07f1f.js";import{u as Ve}from"./use-mantine-color-scheme-dd296b2f.js";import{r as ce,B as ke}from"./polymorphic-factory-0a97ecf2.js";import{T as O}from"./Tooltip-b63b5dad.js";import{A as X}from"./ActionIcon-fece95f6.js";import{I as $e}from"./IconTrash-6b16e91d.js";import{i as qe}from"./isBase64-b94d2017.js";import{G as te}from"./Grid-978f86f2.js";import{C as Y}from"./Card-e2fc5d87.js";import{G as ue}from"./Group-fc8e50aa.js";import{S as Te}from"./ScrollArea-f25d8cf3.js";import{A as Fe}from"./ArchbaseObjectInspector-e280f051.js";import{p as De}from"./pessoasData-6b8000da.js";import"./lodash-4d0be66a.js";import"./_commonjsHelpers-de833af9.js";import"./index-1905cc86.js";import"./index-d0400ba7.js";import"./create-optional-context-86e78b6c.js";import"./use-id-f896cdc5.js";import"./use-isomorphic-effect-aa890e3d.js";import"./Loader-f7f9dcb9.js";import"./Transition-5f279277.js";import"./index-a38d0dca.js";import"./use-reduced-motion-73d958ef.js";import"./use-media-query-91643880.js";import"./use-did-update-bccd292e.js";import"./UnstyledButton-b043fbb8.js";import"./index-9d475cdf.js";import"./noop-1bad6ac0.js";import"./Mantine.context-e727d900.js";import"./OptionalPortal-f36e0e00.js";import"./use-merged-ref-add91123.js";import"./use-floating-auto-update-be0bf837.js";import"./DirectionProvider-1e219af7.js";import"./get-style-object-71cabcb5.js";import"./create-safe-context-941c9e18.js";import"./get-sorted-breakpoints-e9679440.js";import"./px-90b8b31c.js";import"./Paper-97ef7d63.js";import"./types-5decf4ed.js";var He=j("check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]),Le=j("cloud-download","IconCloudDownload",[["path",{d:"M19 18a3.5 3.5 0 0 0 0 -7h-1a5 4.5 0 0 0 -11 -2a4.6 4.4 0 0 0 -2.1 8.4",key:"svg-0"}],["path",{d:"M12 13l0 9",key:"svg-1"}],["path",{d:"M9 19l3 3l3 -3",key:"svg-2"}]]),ie=j("cloud-upload","IconCloudUpload",[["path",{d:"M7 18a4.6 4.4 0 0 1 0 -9a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7h-1",key:"svg-0"}],["path",{d:"M9 15l3 -3l3 3",key:"svg-1"}],["path",{d:"M12 12l0 9",key:"svg-2"}]]),We=j("crop","IconCrop",[["path",{d:"M8 5v10a1 1 0 0 0 1 1h10",key:"svg-0"}],["path",{d:"M5 8h10a1 1 0 0 1 1 1v10",key:"svg-1"}]]),_e=j("photo-edit","IconPhotoEdit",[["path",{d:"M15 8h.01",key:"svg-0"}],["path",{d:"M11 20h-4a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v4",key:"svg-1"}],["path",{d:"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l3 3",key:"svg-2"}],["path",{d:"M14 14l1 -1c.31 -.298 .644 -.497 .987 -.596",key:"svg-3"}],["path",{d:"M18.42 15.61a2.1 2.1 0 0 1 2.97 2.97l-3.39 3.42h-3v-3l3.42 -3.39z",key:"svg-4"}]]);const Ue=25,be=(s,e=!1,t,i)=>{return new Promise(async(o,r)=>{let l=document.createElement("img");l.src=s+"",l.crossOrigin="Anonymous";let h=t.quality/100,c=t.maintainAspectRatio;l.onload=()=>{var f=document.createElement("canvas");let m=f.getContext("2d"),u=l.width/l.height,w=t.maxWidth,E=t.maxHeight;i!=null&&i.getDimFromImage&&(w=l.width,E=l.height),c?(f.width=w,f.height=w/u,e&&(f.width=E*u,f.height=E)):(f.width=w,f.height=E),t.basicFilters&&(m.filter=n(t.basicFilters)),m.drawImage(l,0,0,f.width,f.height);let y=t.format;var z=f.toDataURL(`image/${y}`,h);o({dataUri:z,width:f.width,height:f.height})}}).then(o=>(t.maxHeight=o.height,t.maxWidth=o.width,{imageUri:o.dataUri,state:ve(t,o.dataUri)}));function n(o){return Object.keys(o).map(r=>["blur"].includes(r)?`${r}(${o[r]}px)`:`${r}(${o[r]})`).join("")}},ve=(s,e)=>(s.arrayCopiedImages.length<=Ue?s.arrayCopiedImages.push({lastImage:e,width:s.maxWidth,height:s.maxHeight,quality:s.quality,format:s.format,originImageSrc:s.originImageSrc,basicFilters:s.basicFilters}):s.arrayCopiedImages[s.arrayCopiedImages.length-1]={lastImage:e,width:s.maxWidth,height:s.maxHeight,quality:s.quality,format:s.format,originImageSrc:s.originImageSrc,basicFilters:s.basicFilters},JSON.parse(JSON.stringify(s))),Pe=p.memo(s=>{const{onInputChangedEnd:e,onChangedDelayed:t,onChangedValue:i,delayMs:n,...o}=s,[r,l]=p.useState(s.value),h=p.useRef(),c=p.useRef(!0);p.useRef(!1),p.useEffect(()=>{if(t){if(c.current){c.current=!1;return}return clearTimeout(h.current),h.current=setTimeout(()=>{clearTimeout(h.current),t(r)},n||100),()=>{clearTimeout(h.current)}}},[r]);function f(m){["checkbox","radio"].includes(s.type)?(l(m.target.checked),i&&i(m.target.checked)):(l(m.target.value),i&&i(m.target.value))}return C(oe.Fragment,{children:[e&&a("input",{...o,className:o==null?void 0:o.className,style:o.style,value:s.value,onChange:f,onBlur:m=>{e(m.target.value)},onKeyDown:m=>{m.key=="Enter"&&e(r)}}),!e&&a("input",{...o,className:o==null?void 0:o.className,style:o.style,value:s.value,onChange:f})]})}),D=Pe,me={contrast:1,blur:0,brightness:1,grayscale:0,invert:0,saturate:1,sepia:0},Oe=p.memo(({color:s,initialState:e=me,changeFilter:t=()=>{}})=>{const[i,n]=p.useState(e);p.useEffect(()=>{n(e?JSON.parse(JSON.stringify({...i,...e})):me)},[e]);function o(m){t({...i,contrast:m})}function r(m){t({...i,brightness:m})}function l(m){t({...i,grayscale:m})}function h(m){t({...i,saturate:m})}function c(m){t({...i,sepia:m})}function f(m){t({...i,blur:m})}return C("div",{children:[C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Contrast")}`}),a("p",{className:"item-panel",children:(+i.contrast).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(D,{className:"input-range",onChangedDelayed:o,delayMs:100,onChangedValue:m=>{n({...i,contrast:m})},style:{maxWidth:"100%",width:"100%",color:s},type:"range",min:"0",max:"5",step:"0.01",value:i.contrast})}),C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Brightness")}`}),a("p",{className:"item-panel",children:(+i.brightness).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(D,{className:"input-range",onChangedDelayed:r,onChangedValue:m=>{n({...i,brightness:m})},style:{maxWidth:"100%",width:"100%",color:s},type:"range",min:"0",max:"5",step:"0.01",value:i.brightness})}),C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Grayscale")}`}),a("p",{className:"item-panel",children:(+i.grayscale).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(D,{className:"input-range",onChangedDelayed:l,onChangedValue:m=>{n({...i,grayscale:m})},style:{maxWidth:"100%",width:"100%",color:s},type:"range",min:"0",max:"5",step:"0.01",value:i.grayscale})}),C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Saturate")}`}),a("p",{className:"item-panel",children:(+i.saturate).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(D,{className:"input-range",onChangedDelayed:h,onChangedValue:m=>{n({...i,saturate:m})},style:{maxWidth:"100%",width:"100%",color:s},type:"range",min:"0",max:"5",step:"0.01",value:i.saturate})}),C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Sepia")}`}),a("p",{className:"item-panel",children:(+i.sepia).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(D,{className:"input-range",onChangedDelayed:c,onChangedValue:m=>{n({...i,sepia:m})},style:{maxWidth:"100%",width:"100%",color:s},type:"range",min:"0",max:"5",step:"0.01",value:i.sepia})}),C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Blur")}`}),a("p",{className:"item-panel",children:(+i.blur).toFixed(2)})]}),a("div",{className:"flex-row-start",children:a(D,{className:"input-range",onChangedDelayed:f,onChangedValue:m=>{n({...i,blur:m})},style:{maxWidth:"100%",width:"100%",color:s},type:"range",min:"0",max:"5",step:"0.01",value:i.blur})})]})}),Xe=Oe;class je{constructor(e,t,i,n){var o=this;this.position=e,this.constraints=t,this.cursor=i,this.eventBus=n,this.el=document.createElement("div"),this.el.className="croppr-handle",this.el.style.cursor=i,this.el.addEventListener("mousedown",r);function r(c){c.stopPropagation(),document.addEventListener("mouseup",l),document.addEventListener("mousemove",h),o.eventBus.dispatchEvent(new CustomEvent("handlestart",{detail:{handle:o}}))}function l(c){c.stopPropagation(),document.removeEventListener("mouseup",l),document.removeEventListener("mousemove",h),o.eventBus.dispatchEvent(new CustomEvent("handleend",{detail:{handle:o}}))}function h(c){c.stopPropagation(),o.eventBus.dispatchEvent(new CustomEvent("handlemove",{detail:{mouseX:c.clientX,mouseY:c.clientY}}))}}}class ne{constructor(e,t,i,n){this.x1=e,this.y1=t,this.x2=i,this.y2=n}set(e=null,t=null,i=null,n=null){return this.x1=e??this.x1,this.y1=t??this.y1,this.x2=i??this.x2,this.y2=n??this.y2,this}width(){return Math.abs(this.x2-this.x1)}height(){return Math.abs(this.y2-this.y1)}resize(e,t,i=[0,0]){const n=this.x1+this.width()*i[0],o=this.y1+this.height()*i[1];return this.x1=n-e*i[0],this.y1=o-t*i[1],this.x2=this.x1+e,this.y2=this.y1+t,this}scale(e,t=[0,0]){const i=this.width()*e,n=this.height()*e;return this.resize(i,n,t),this}move(e=null,t=null){let i=this.width(),n=this.height();return e=e===null?this.x1:e,t=t===null?this.y1:t,this.x1=e,this.y1=t,this.x2=e+i,this.y2=t+n,this}getRelativePoint(e=[0,0]){const t=this.width()*e[0],i=this.height()*e[1];return[t,i]}getAbsolutePoint(e=[0,0]){const t=this.x1+this.width()*e[0],i=this.y1+this.height()*e[1];return[t,i]}constrainToRatio(e,t=[0,0],i="height"){if(e!==null){switch(this.width(),this.height(),i){case"height":this.resize(this.width(),this.width()*e,t);break;case"width":this.resize(this.height()*1/e,this.height(),t);break;default:this.resize(this.width(),this.width()*e,t)}return this}}constrainToBoundary(e,t,i=[0,0]){const[n,o]=this.getAbsolutePoint(i),r=n,l=o,h=e-n,c=t-o,f=-2*i[0]+1,m=-2*i[1]+1;let[u,w]=[null,null];switch(f){case-1:u=r;break;case 0:u=Math.min(r,h)*2;break;case 1:u=h;break}switch(m){case-1:w=l;break;case 0:w=Math.min(l,c)*2;break;case 1:w=c;break}if(this.width()>u){const E=u/this.width();this.scale(E,i)}if(this.height()>w){const E=w/this.height();this.scale(E,i)}return this}constrainToSize(e=null,t=null,i=null,n=null,o=[0,0],r=null){if(r&&(r>1?(e=t*1/r,n=n*r):r<1&&(t=e*r,i=n*1/r)),e&&this.width()>e){const l=e,h=r===null?this.height():t;this.resize(l,h,o)}if(t&&this.height()>t){const l=r===null?this.width():e,h=t;this.resize(l,h,o)}if(i&&this.width()<i){const l=i,h=r===null?this.height():n;this.resize(l,h,o)}if(n&&this.height()<n){const l=r===null?this.width():i,h=n;this.resize(l,h,o)}return this}}function Ye(s){s.addEventListener("touchstart",ae),s.addEventListener("touchend",ae),s.addEventListener("touchmove",ae)}function ae(s){s.preventDefault();const e=s.changedTouches[0],t={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"};e.target.dispatchEvent(new MouseEvent(t[s.type],{bubbles:!0,cancelable:!0,view:window,clientX:e.clientX,clientY:e.clientY,screenX:e.screenX,screenY:e.screenY}))}const J=[{position:[0,0],constraints:[1,0,0,1],cursor:"nw-resize"},{position:[.5,0],constraints:[1,0,0,0],cursor:"n-resize"},{position:[1,0],constraints:[1,1,0,0],cursor:"ne-resize"},{position:[1,.5],constraints:[0,1,0,0],cursor:"e-resize"},{position:[1,1],constraints:[0,1,1,0],cursor:"se-resize"},{position:[.5,1],constraints:[0,0,1,0],cursor:"s-resize"},{position:[0,1],constraints:[0,0,1,1],cursor:"sw-resize"},{position:[0,.5],constraints:[0,0,0,1],cursor:"w-resize"}];class le{constructor(e,t,i=!1){if(this.options=le.parseOptions(t||{}),!e.nodeName&&(e=document.querySelector(e),e==null))throw"Unable to find element.";if(!e.getAttribute("src"))throw"Image src not provided.";this._initialized=!1,this._restore={parent:e.parentNode,element:e},i||(e.width===0||e.height===0?e.onload=()=>{this.initialize(e)}:this.initialize(e))}initialize(e){this.createDOM(e),this.options.convertToPixels(this.cropperEl),this.attachHandlerEvents(),this.attachRegionEvents(),this.attachOverlayEvents(),this.box=this.initializeBox(this.options),this.redraw(),this._initialized=!0,this.options.onInitialize!==null&&this.options.onInitialize(this)}createDOM(e){this.containerEl=document.createElement("div"),this.containerEl.className="croppr-container",this.eventBus=this.containerEl,Ye(this.containerEl),this.cropperEl=document.createElement("div"),this.cropperEl.className="croppr",this.imageEl=document.createElement("img"),this.imageEl.setAttribute("src",e.getAttribute("src")),this.imageEl.setAttribute("alt",e.getAttribute("alt")),this.imageEl.className="croppr-image",this.imageClippedEl=this.imageEl.cloneNode(),this.imageClippedEl.className="croppr-imageClipped",this.regionEl=document.createElement("div"),this.regionEl.innerHTML=new Array(9).fill(1).map(()=>'<div style="border: 1px dashed #fafafa"></div>').join(""),this.regionEl.className="croppr-region",this.overlayEl=document.createElement("div"),this.overlayEl.className="croppr-overlay";let t=document.createElement("div");t.className="croppr-handleContainer",this.handles=[];for(let i=0;i<J.length;i++){const n=new je(J[i].position,J[i].constraints,J[i].cursor,this.eventBus);this.handles.push(n),t.appendChild(n.el)}this.cropperEl.appendChild(this.imageEl),this.cropperEl.appendChild(this.imageClippedEl),this.cropperEl.appendChild(this.regionEl),this.cropperEl.appendChild(this.overlayEl),this.cropperEl.appendChild(t),this.containerEl.appendChild(this.cropperEl),e.parentElement.replaceChild(this.containerEl,e)}setImage(e){return this.imageEl.onload=()=>{this.box=this.initializeBox(this.options),this.redraw()},this.imageEl.src=e,this.imageClippedEl.src=e,this}destroy(){this._restore.parent.replaceChild(this._restore.element,this.containerEl)}initializeBox(e){const t=e.startSize.width,i=e.startSize.height;let n=new ne(0,0,t,i);n.constrainToRatio(e.aspectRatio,[.5,.5]);const o=e.minSize,r=e.maxSize;n.constrainToSize(r.width,r.height,o.width,o.height,[.5,.5],e.aspectRatio);const l=this.cropperEl.offsetWidth,h=this.cropperEl.offsetHeight;n.constrainToBoundary(l,h,[.5,.5]);const c=this.cropperEl.offsetWidth/2-n.width()/2,f=this.cropperEl.offsetHeight/2-n.height()/2;return n.move(c,f),n}redraw(){const e=Math.round(this.box.width()),t=Math.round(this.box.height()),i=Math.round(this.box.x1),n=Math.round(this.box.y1),o=Math.round(this.box.x2),r=Math.round(this.box.y2);window.requestAnimationFrame(()=>{this.regionEl.style.transform=`translate(${i}px, ${n}px)`,this.regionEl.style.width=e+"px",this.regionEl.style.height=t+"px",this.imageClippedEl.style.clip=`rect(${n}px, ${o}px, ${r}px, ${i}px)`;const l=this.box.getAbsolutePoint([.5,.5]),h=l[0]-this.cropperEl.offsetWidth/2>>31,c=l[1]-this.cropperEl.offsetHeight/2>>31,m=-2*((h^c)+c+c+4)+8;for(let u=0;u<this.handles.length;u++){let w=this.handles[u];const E=w.el.offsetWidth,y=w.el.offsetHeight,z=i+e*w.position[0]-E/2,x=n+t*w.position[1]-y/2;w.el.style.transform=`translate(${Math.round(z)}px, ${Math.round(x)}px)`,w.el.style.zIndex=m==u?5:4}})}attachHandlerEvents(){const e=this.eventBus;e.addEventListener("handlestart",this.onHandleMoveStart.bind(this)),e.addEventListener("handlemove",this.onHandleMoveMoving.bind(this)),e.addEventListener("handleend",this.onHandleMoveEnd.bind(this))}attachRegionEvents(){const e=this.eventBus;this.regionEl.addEventListener("mousedown",t),e.addEventListener("regionstart",this.onRegionMoveStart.bind(this)),e.addEventListener("regionmove",this.onRegionMoveMoving.bind(this)),e.addEventListener("regionend",this.onRegionMoveEnd.bind(this));function t(o){o.stopPropagation(),document.addEventListener("mouseup",n),document.addEventListener("mousemove",i),e.dispatchEvent(new CustomEvent("regionstart",{detail:{mouseX:o.clientX,mouseY:o.clientY}}))}function i(o){o.stopPropagation(),e.dispatchEvent(new CustomEvent("regionmove",{detail:{mouseX:o.clientX,mouseY:o.clientY}}))}function n(o){o.stopPropagation(),document.removeEventListener("mouseup",n),document.removeEventListener("mousemove",i),e.dispatchEvent(new CustomEvent("regionend",{detail:{mouseX:o.clientX,mouseY:o.clientY}}))}}attachOverlayEvents(){const t=this;let i=null;this.overlayEl.addEventListener("mousedown",n);function n(l){l.stopPropagation(),document.addEventListener("mouseup",r),document.addEventListener("mousemove",o);const h=t.cropperEl.getBoundingClientRect(),c=l.clientX-h.left,f=l.clientY-h.top;i=t.box,t.box=new ne(c,f,c+1,f+1),t.eventBus.dispatchEvent(new CustomEvent("handlestart",{detail:{handle:t.handles[4]}}))}function o(l){l.stopPropagation(),t.eventBus.dispatchEvent(new CustomEvent("handlemove",{detail:{mouseX:l.clientX,mouseY:l.clientY}}))}function r(l){if(l.stopPropagation(),document.removeEventListener("mouseup",r),document.removeEventListener("mousemove",o),t.box.width()===1&&t.box.height()===1){t.box=i;return}t.eventBus.dispatchEvent(new CustomEvent("handleend",{detail:{mouseX:l.clientX,mouseY:l.clientY}}))}}onHandleMoveStart(e){let t=e.detail.handle;const i=[1-t.position[0],1-t.position[1]];let[n,o]=this.box.getAbsolutePoint(i);this.activeHandle={handle:t,originPoint:i,originX:n,originY:o},this.options.onCropStart!==null&&this.options.onCropStart(this.getValue())}onHandleMoveMoving(e){let{mouseX:t,mouseY:i}=e.detail,n=this.cropperEl.getBoundingClientRect();t=t-n.left,i=i-n.top,t<0?t=0:t>n.width&&(t=n.width),i<0?i=0:i>n.height&&(i=n.height);let o=this.activeHandle.originPoint.slice();const r=this.activeHandle.originX,l=this.activeHandle.originY,h=this.activeHandle.handle,c=h.constraints[0]===1,f=h.constraints[1]===1,m=h.constraints[2]===1,u=h.constraints[3]===1,w=(u||f)&&(c||m);let E=u||f?r:this.box.x1,y=u||f?r:this.box.x2,z=c||m?l:this.box.y1,x=c||m?l:this.box.y2;E=u?t:E,y=f?t:y,z=c?i:z,x=m?i:x;let[I,N]=[!1,!1];if((u||f)&&(I=u?t>r:t<r),(c||m)&&(N=c?i>l:i<l),I){const $=E;E=y,y=$,o[0]=1-o[0]}if(N){const $=z;z=x,x=$,o[1]=1-o[1]}let k=new ne(E,z,y,x);if(this.options.aspectRatio){const $=this.options.aspectRatio;let T=!1;w?T=i>k.y1+$*k.width()||i<k.y2-$*k.width():(c||m)&&(T=!0);const q=T?"width":"height";k.constrainToRatio($,o,q)}const F=this.options.minSize,L=this.options.maxSize;k.constrainToSize(L.width,L.height,F.width,F.height,o,this.options.aspectRatio);const U=this.cropperEl.offsetWidth,W=this.cropperEl.offsetHeight;k.constrainToBoundary(U,W,o),this.box=k,this.redraw(),this.options.onCropMove!==null&&this.options.onCropMove(this.getValue())}onHandleMoveEnd(e){this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue())}onRegionMoveStart(e){let{mouseX:t,mouseY:i}=e.detail,n=this.cropperEl.getBoundingClientRect();t=t-n.left,i=i-n.top,this.currentMove={offsetX:t-this.box.x1,offsetY:i-this.box.y1},this.options.onCropStart!==null&&this.options.onCropStart(this.getValue())}onRegionMoveMoving(e){let{mouseX:t,mouseY:i}=e.detail,{offsetX:n,offsetY:o}=this.currentMove,r=this.cropperEl.getBoundingClientRect();t=t-r.left,i=i-r.top,this.box.move(t-n,i-o),this.box.x1<0&&this.box.move(0,null),this.box.x2>r.width&&this.box.move(r.width-this.box.width(),null),this.box.y1<0&&this.box.move(null,0),this.box.y2>r.height&&this.box.move(null,r.height-this.box.height()),this.redraw(),this.options.onCropMove!==null&&this.options.onCropMove(this.getValue())}onRegionMoveEnd(e){this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue())}getValue(e=null){if(e===null&&(e=this.options.returnMode),e=="real"){const t=this.imageEl.naturalWidth,i=this.imageEl.naturalHeight,{width:n,height:o}=this.imageEl.getBoundingClientRect(),r=t/n,l=i/o;return{x:Math.round(this.box.x1*r),y:Math.round(this.box.y1*l),width:Math.round(this.box.width()*r),height:Math.round(this.box.height()*l)}}else if(e=="ratio"){const{width:t,height:i}=this.imageEl.getBoundingClientRect();return{x:G(this.box.x1/t,3),y:G(this.box.y1/i,3),width:G(this.box.width()/t,3),height:G(this.box.height()/i,3)}}else if(e=="raw")return{x:Math.round(this.box.x1),y:Math.round(this.box.y1),width:Math.round(this.box.width()),height:Math.round(this.box.height())}}static parseOptions(e){const t={aspectRatio:null,maxSize:{width:null,height:null},minSize:{width:null,height:null},startSize:{width:100,height:100,unit:"%"},returnMode:"real",onInitialize:null,onCropStart:null,onCropMove:null,onCropEnd:null};let i=null;e.aspectRatio!==void 0&&(typeof e.aspectRatio=="number"?i=e.aspectRatio:e.aspectRatio instanceof Array&&(i=e.aspectRatio[1]/e.aspectRatio[0]));let n=null;e.maxSize!==void 0&&e.maxSize!==null&&(n={width:e.maxSize[0]||null,height:e.maxSize[1]||null,unit:e.maxSize[2]||"px"});let o=null;e.minSize!==void 0&&e.minSize!==null&&(o={width:e.minSize[0]||null,height:e.minSize[1]||null,unit:e.minSize[2]||"px"});let r=null;e.startSize!==void 0&&e.startSize!==null&&(r={width:e.startSize[0]||null,height:e.startSize[1]||null,unit:e.startSize[2]||"%"});let l=null;typeof e.onInitialize=="function"&&(l=e.onInitialize);let h=null;typeof e.onCropStart=="function"&&(h=e.onCropStart);let c=null;typeof e.onCropEnd=="function"&&(c=e.onCropEnd);let f=null;typeof e.onUpdate=="function"&&(console.warn("Croppr.js: `onUpdate` is deprecated and will be removed in the next major release. Please use `onCropMove` or `onCropEnd` instead."),f=e.onUpdate),typeof e.onCropMove=="function"&&(f=e.onCropMove);let m=null;if(e.returnMode!==void 0){const E=e.returnMode.toLowerCase();if(["real","ratio","raw"].indexOf(E)===-1)throw"Invalid return mode.";m=E}const u=function(E){const y=E.offsetWidth,z=E.offsetHeight,x=["maxSize","minSize","startSize"];for(let I=0;I<x.length;I++){const N=x[I];this[N]!==null&&(this[N].unit=="%"&&(this[N].width!==null&&(this[N].width=this[N].width/100*y),this[N].height!==null&&(this[N].height=this[N].height/100*z)),delete this[N].unit)}},w=(E,y)=>E!==null?E:y;return{aspectRatio:w(i,t.aspectRatio),maxSize:w(n,t.maxSize),minSize:w(o,t.minSize),startSize:w(r,t.startSize),returnMode:w(m,t.returnMode),onInitialize:w(l,t.onInitialize),onCropStart:w(h,t.onCropStart),onCropMove:w(f,t.onCropMove),onCropEnd:w(c,t.onCropEnd),convertToPixels:u}}}function G(s,e){return+(Math.round(s+"e"+e)+"e-"+e)}class Je extends le{constructor(e,t,i=!1){super(e,t,i)}getValue(e){return super.getValue(e)}setImage(e){return super.setImage(e)}destroy(){return super.destroy()}moveTo(e,t){return this.box.move(e,t),this.redraw(),this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue()),this}resizeTo(e,t,i=[.5,.5]){this.box.resize(e,t,i);const n=this.cropperEl.offsetWidth,o=this.cropperEl.offsetHeight;return this.box.constrainToBoundary(n,o,[.5,.5]),this.redraw(),this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue()),this}scaleBy(e,t=[.5,.5]){return this.box.scale(e,t),this.redraw(),this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue()),this}reset(e){return e&&(this.options={...this.options,newOptions:e}),this.box=this.initializeBox(this.options),this.redraw(),this.options.onCropEnd!==null&&this.options.onCropEnd(this.getValue()),this}enableVisibility(e){let t=document.querySelector(".croppr-container");if(!t)throw new Error("THere is not any croppr");e?t.style.display="block":t.style.display="none"}}const se=p.memo(({src:s,size:e,croppUpdate:t})=>{const[i,n]=p.useState(),[o,r]=p.useState({width:150,height:150}),l=p.useRef(null),h=p.useRef();return p.useEffect(()=>{e&&(r({...e}),l.current&&l.current.resizeTo(e.width,e.height))},[e]),p.useEffect(()=>{s&&n(s)},[s]),p.useEffect(()=>(h.current&&i&&(l.current=new Je("#croppr",{minSize:[32,32,"px"],startSize:[o.width,o.height,"px"],onInitialize:c=>{t(c==null?void 0:c.getValue())},onCropEnd:c=>{t(c)}})),()=>{var c;return(c=l==null?void 0:l.current)==null?void 0:c.destroy()}),[h.current,i]),a("div",{className:"ArchbaseCropprWrapper",children:a("img",{ref:h,src:i,id:"croppr"})})});try{se.displayName="ArchbaseCropperWrapper",se.__docgenInfo={description:"",displayName:"ArchbaseCropperWrapper",props:{src:{defaultValue:null,description:"",name:"src",required:!0,type:{name:"string"}},size:{defaultValue:null,description:"",name:"size",required:!0,type:{name:"any"}},croppUpdate:{defaultValue:null,description:"",name:"croppUpdate",required:!0,type:{name:"(data: { x: number; y: number; width: number; height: number; }) => void"}}}}}catch{}const Ge=p.memo(({activeIndex:s=0,children:e,backgroundColor:t="inherit",color:i="#428CFF",indicatorStyle:n="bottomLine",onTabChange:o=f=>{},transitionMs:r=375,borderLine:l=!1,fontColor:h="inherit",lazy:c=!1})=>{const[f,m]=p.useState([]),[u,w]=p.useState(s),E=p.useRef(null);p.useEffect(()=>{const x=e instanceof Array?e:[e];y(x);const I=x.map(N=>({label:N.props.name,icon:N.props.icon,disabled:N.props.disabled}));if(s>I.length-1||s<0)throw new Error(`Intervalo inválido para activeIndex ${s}`);m(I)},[e]),p.useEffect(()=>{var I,N;const x=e instanceof Array?e:[e];if(s>x.length-1||s<0)throw new Error(`Intervalo inválido para activeIndex ${s}`);w((N=(I=x[s])==null?void 0:I.props)!=null&&N.disabled?0:s)},[s]),p.useEffect(()=>{f&&f.length&&o(u)},[u]);function y(x){try{x.map(I=>{if(!I.props.name)throw new Error("Dentro do componente TabContainer só pode ser renderizado o componente TabItem e precisa de um suporte de nome");return!0})}catch{throw new Error("O componente TabContainer deve ter um TabItem como componente filho")}}const z=e instanceof Array?e:[e];return C("div",{ref:E,className:"tab-pp",children:[a("div",{className:"header",style:{backgroundColor:t,borderBottom:l?"1px solid #323232":"undet"},children:f.map((x,I)=>C("button",{onClick:()=>{x.disabled||w(I)},style:{color:I==u&&(n==="simple"||n==="bottomLine")?i:h,backgroundColor:I==u&&n==="button"?i:"inherit"},className:I==u?`itemlabel ${n} active`:"itemlabel",disabled:x.disabled,children:[x.icon," ",x.label,n==="bottomLine"&&a("div",{style:{backgroundColor:i}})]},x.label))}),a("div",{className:"body",children:z.map((x,I)=>I<u?a("div",{style:{transform:"translate3d(-100%, 0px, 0px)",height:"0px",overflow:"hidden",transition:`transform ${r/1e3}s ease`},className:"body-content",children:!c&&x},I):I>u?a("div",{style:{transform:"translate3d(100%, 0px, 0px)",height:"0px",overflow:"hidden",transition:`transform ${r/1e3}s ease`},className:"body-content",children:!c&&x},I):a("div",{style:{visibility:"inherit",overflow:"auto",height:"auto",position:"relative",transition:`transform ${r/1e3}s ease`},className:"body-content",children:x},I))})]})}),Z=p.memo(({name:s,children:e,icon:t=null,type:i="TabItem",disabled:n=!1})=>a("div",{style:{padding:"1rem 0.5rem"},children:e})),Ke=Ge;try{Z.displayName="TabItem",Z.__docgenInfo={description:"",displayName:"TabItem",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"string | Element"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"string"}}}}}catch{}const Qe={quality:92,maxHeight:1e3,maxWidth:1e3,cropHeight:150,cropWidth:150,maintainAspectRatio:!0,format:"png",arrayCopiedImages:[],originImageSrc:""},Ze=p.memo(({image:s="",color:e="#1e88e5",initialState:t=Qe,saveUpdates:i=()=>{}})=>{const[n,o]=p.useState(t),[r,l]=p.useState(""),[h,c]=p.useState(!1),[f,m]=p.useState({width:150,height:150}),[u,w]=p.useState(),E=p.useRef(!1),y=["webp","jpeg","png"];p.useEffect(()=>{E.current=window.innerWidth<800,o(JSON.parse(JSON.stringify({...n,...t})))},[t]),p.useEffect(()=>{l(s)},[s]),p.useEffect(()=>{h||m({width:150,height:150})},[h]);async function z(d,b=!1){try{const{state:R,imageUri:B}=await be(n.originImageSrc,b,d);l(B),o(R)}catch(R){console.log("🚀 ~ file: EditImage.tsx ~ line 73 ~ applyChanges ~ error",R)}}async function x(d){d=Math.max(Math.min(d,100),1);const b={...n,quality:d};o(b);try{await z(b,!1)}catch(R){console.log("onUpdateQuality ~ error",R)}}async function I(d,b=!1){const R=Math.max(Math.min(d,4e3),32),B={...n};if(b){if(B.maxHeight===R)return;B.maxHeight=R}else{if(B.maxWidth===R)return;B.maxWidth=R}o(B);try{await z(B,b)}catch(g){console.log("onChangeSize ~ error",g)}}async function N(d){const b={...n,format:d.target.value};try{o(b),await z(b,!1)}catch(R){console.log("onChangeFormat ~ error",R)}}function k(d,b){d&&(o({...n,cropWidth:d}),m({...f,width:d})),b&&(o({...n,cropHeight:b}),m({...f,height:b}))}function F(){let d=q(n);const b=document.createElement("canvas");return new Promise((R,B)=>{const g=b.getContext("2d"),S=new Image;S.src=r,S.onload=()=>{const V=u==null?void 0:u.width,v=u==null?void 0:u.height;return b.height=v,b.width=V,g.drawImage(S,Math.abs(u==null?void 0:u.x),Math.abs(u==null?void 0:u.y),u==null?void 0:u.width,u==null?void 0:u.height,0,0,u==null?void 0:u.width,u==null?void 0:u.height),R(b.toDataURL(`image/${d.format}`,d.quality))},S.onerror=V=>{B(V)}}).then(R=>{d.maxWidth=b.width,d.maxHeight=b.height,d.originImageSrc=R,d=ve(d,R),o(d),l(R),c(!1)}).catch(R=>{console.log(R)})}function L(d){w(d),o({...n,cropHeight:d.height,cropWidth:d.width})}function U(d=!1){c(!1),i(d?{state:n,imageSrc:r}:null)}async function W(){try{let d=q(n);if(d.arrayCopiedImages.length>1){d.arrayCopiedImages.pop();const b=d.arrayCopiedImages[d.arrayCopiedImages.length-1];d={...n,arrayCopiedImages:d.arrayCopiedImages,maxHeight:b.height,maxWidth:b.width,quality:b.quality,format:b.format,originImageSrc:b.originImageSrc,basicFilters:b.basicFilters},o(d),l(b.lastImage)}}catch(d){console.log("🚀 ~ file: edit-image.component.ts ~ line 126 ~ EditImageComponent ~ onRestore ~ e",d)}}async function $(d){try{const b=q(n);b.basicFilters?b.basicFilters={...b.basicFilters,...d}:b.basicFilters=d,await z(b,!1)}catch(b){console.log("🚀 ~ file: EditImage.tsx ~ line 259 ~ onChangeFilters ~ e",b)}}const T=p.useMemo(()=>r&&r.length?Math.ceil(3/4*r.length/1024):"",[r]);function q(d){return JSON.parse(JSON.stringify(d))}return a("div",{className:"ArchbaseEditImage",children:C("div",{id:"popup",className:"popup",children:[a("div",{style:{flexDirection:"row",boxSizing:"border-box",display:"flex",placeContent:"center flex-end",alignItems:"center",padding:"0px 16px"},children:a("button",{className:"icon-btn",onClick:()=>{U(!1)},children:a("span",{className:"material-icons",children:a(Be,{})})})}),C("div",{className:"image-container",children:[C("div",{className:"image-holder-full",children:[!h&&a("img",{id:"image-full",src:r}),h&&a(se,{src:r,size:f,croppUpdate:L})]}),C("div",{className:"control-panel",children:[C(Ke,{lazy:!0,borderLine:!0,children:[C(Z,{name:`${M.t("Basic")}`,children:[(!E.current||E.current&&!h)&&C(oe.Fragment,{children:[C("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[a("p",{className:"item-panel",children:`${M.t("Quality")}`}),a("p",{className:"item-panel",children:n.quality+"%"})]}),a("div",{className:"flex-row-start",children:a(D,{readOnly:h,disabled:h,className:"input-range",onChangedDelayed:x,onChangedValue:d=>{o({...n,quality:d})},style:{maxWidth:"100%",width:"100%",color:e},type:"range",min:1,max:100,value:n.quality})}),C("div",{className:"item-panel",style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[`${M.t("Max dimensions")}`,C("div",{style:{display:"flex",alignItems:"center"},children:[a("input",{disabled:h,readOnly:h,type:"checkbox",checked:n.maintainAspectRatio,onChange:d=>o({...n,maintainAspectRatio:d.target.checked}),style:{color:e}}),a("span",{className:"caption",children:`${M.t("aspect-ratio")}`})]})]}),C("div",{className:"flex-row-start",style:{marginTop:"10px",justifyContent:"space-between"},children:[C("div",{className:"form-field",style:{maxWidth:"48%",width:"48%"},children:[a("label",{children:`${M.t("max-width(px)")}`}),a(D,{readOnly:h,disabled:h,placeholder:`${M.t("max-width(px)")}`,value:n.maxWidth,onChangedValue:d=>o({...n,maxWidth:d}),type:"number",min:0,max:2e3,onInputChangedEnd:d=>{I(d,!1)}})]}),C("div",{className:"form-field",style:{maxWidth:"48%",width:"48%"},children:[a("label",{children:`${M.t("max-height(px)")}`}),a(D,{readOnly:h,disabled:h,placeholder:`${M.t("max-height(px)")}`,value:n.maxHeight,onChangedValue:d=>o({...n,maxHeight:d}),type:"number",min:0,max:2e3,onInputChangedEnd:d=>{I(d,!0)}})]})]}),a("p",{className:"item-panel",children:`${M.t("Format")}`}),a("div",{className:"flex-row-start",style:{marginTop:"10px",justifyContent:"space-between"},children:a("div",{className:"form-field",style:{width:"100%"},children:a("select",{disabled:h,value:n.format,onChange:N,children:y.map((d,b)=>a("option",{value:d,children:d},b))})})})]}),a("div",{className:"flex-row-start",style:{marginTop:"5px",justifyContent:"space-between"},children:C("span",{style:{display:"flex",alignItems:"center"},children:[a("input",{type:"checkbox",onChange:d=>{c(d.target.checked)},checked:h,style:{color:e,marginBottom:"3px"}}),a("span",{className:"item-panel",style:{marginLeft:"4px"},children:`${M.t("Crop")}`})]})}),h&&C(oe.Fragment,{children:[C("div",{className:"flex-row-start",style:{marginTop:"10px",justifyContent:"space-between"},children:[C("div",{className:"form-field",style:{maxWidth:"48%",width:"48%"},children:[a("label",{children:`${M.t("width(px)")}`}),a(D,{type:"number",min:0,value:n.cropWidth,onChangedValue:d=>o({...n,cropWidth:d}),onInputChangedEnd:d=>{k(+d,null)},placeholder:`${M.t("width(px)")}`})]}),C("div",{className:"form-field",style:{maxWidth:"48%",width:"48%"},children:[a("label",{children:`${M.t("height(px)")}`}),a(D,{type:"number",min:0,value:n.cropHeight,onInputChangedEnd:d=>{k(null,+d)},onChangedValue:d=>o({...n,cropHeight:d}),placeholder:`${M.t("height(px)")}`})]})]}),a("p",{style:{marginBottom:"4px !important"},children:a(he,{onClick:F,leftSection:a(We,{color:"orange"}),children:`${M.t("Crop")}`})})]})]}),a(Z,{disabled:h,name:`${M.t("Filters")}`,children:a(Xe,{color:e,initialState:n.basicFilters,changeFilter:$})})]}),a("button",{title:`${M.t("Undo")}`,disabled:n.arrayCopiedImages.length<=1,style:{position:"absolute",right:"10px",top:"30px"},className:"icon-btn",onClick:W,children:a("span",{className:"material-icons",children:`${M.t("Refresh")}`})}),C("div",{className:"flex-row-start",style:{marginTop:"10px",justifyContent:"space-between",alignItems:"center"},children:[a(he,{leftSection:a(He,{}),color:"green",onClick:()=>{U(!0)},children:`${M.t("archbase:Apply")}`}),T&&a("p",{className:"caption image-caption",style:{color:T>120?"#f44336":"unset",fontWeight:T>120?"500":"unset"},children:a(Q,{children:`${M.t("archbase:size")}: ${T}Kb ${n.format}`})})]})]})]})]})})}),et=Ze;const tt={objectFit:"cover",hideDeleteBtn:!1,hideDownloadBtn:!1,hideEditBtn:!1,hideAddBtn:!1,compressInitial:null},pe={maxHeight:3e3,maxWidth:3e3,cropHeight:150,cropWidth:150,maintainAspectRatio:!0,format:"png",arrayCopiedImages:[],originImageSrc:"",basicFilters:void 0,quality:100},re=p.memo(({config:s={},imageSrcProp:e="",color:t="#1e88e5",imageChanged:i=()=>{},variant:n="transparent"})=>{const o=Ae(),{colorScheme:r}=Ve(),[l,h]=p.useState({...pe}),[c,f]=p.useState(""),[m,u]=p.useState(!1),[w,E]=p.useState(!1),[y,z]=p.useState(tt),x=p.useRef(null),I=p.useRef(""),N=p.useRef(""),k=Date.now().toString(20),F=p.useRef("download");p.useRef(!1),p.useEffect(()=>{U()},[s]),p.useEffect(()=>{L()},[e]);async function L(){if(e){const g=await d(e),S=g.state;S.originImageSrc=e,S.arrayCopiedImages=[{lastImage:g.imageUri,width:S.maxWidth,height:S.maxHeight,quality:S.quality,format:S.format,originImageSrc:e}],f(g.imageUri),h(S),u(!0)}else{const g={...l};g.originImageSrc=null,g.arrayCopiedImages=[],u(!1),f(null),h(g)}}p.useEffect(()=>{i(c)},[c]);function U(){const g={...y,...s};z(g)}function W(g){var S;g.preventDefault(),(S=x==null?void 0:x.current)==null||S.click()}function $(g){var V;const S=(V=g.target)==null?void 0:V.files;if(S){const v=S[0];if(F.current=v.name.split(".")[0],I.current=v.type,!I.current.includes("image"))return;if(N.current=`data:${v.type};base64,`,v){const _=new FileReader;_.onload=T.bind(this),_.readAsBinaryString(v)}}}async function T(g){const S=g.target.result,V=btoa(S);let v={...l};const _=N.current+V;if(v.originImageSrc=N.current+V,v.format=I.current.split("image/")[1],y.compressInitial){v={...v,quality:Math.min(y.compressInitial||92,100),maintainAspectRatio:!0,format:v.format?v.format:"png"};const A=await be(v.originImageSrc,!1,v,{getDimFromImage:!0});h(A.state),f(A.imageUri),u(!0),y.onChangeImage&&y.onChangeImage(A.imageUri)}else{const A=document.createElement("img");A.src=_,A.onload=()=>{v.arrayCopiedImages=[],v.maxHeight=A.height,v.maxWidth=A.width,v.format=I.current.split("image/")[1],v.arrayCopiedImages.push({lastImage:_,width:A.width,height:A.height,quality:v.quality,format:I.current.split("image/")[1],originImageSrc:v.originImageSrc}),h(v),f(_),u(!0),y.onChangeImage&&y.onChangeImage(_)}}}const q=p.useMemo(()=>c&&c.length?Math.ceil(3/4*c.length/1024):"",[c]);function d(g){let S={...l},V;if(g.startsWith("data:image/")){const v=g.match(/data:image\/([a-zA-Z]+);base64,/);v&&v[1]?V=v[1]:V="png"}else{const v=g.split(".");V=v[v.length-1],["png","jpeg","webp"].includes(V)||(V="png")}if(S.format=V,s.compressInitial!=null){let v=1;s.compressInitial>=0&&s.compressInitial<=100&&(v=s.compressInitial),S.quality=v}return new Promise((v,_)=>{const A=document.createElement("img");A.crossOrigin="Anonymous",S.maxHeight=A.height,S.maxWidth=A.width,A.onload=()=>{const H=document.createElement("canvas"),we=H.getContext("2d"),de=1;H.width=A.width*de,H.height=A.height*de,we.drawImage(A,0,0,H.width,H.height);const xe=H.toDataURL(`image/${V}`,S.quality/100);return v({dataUri:xe,width:H.width,height:H.height})},A.onerror=H=>_(H.message||`Error loading the src = ${g}`),A.src=g}).then(v=>(S={...S,maxHeight:v.height,maxWidth:v.width},{imageUri:v.dataUri,state:S}))}function b(){E(!0)}function R(g){E(!1),g&&(h(g.state),f(g.imageSrc),y.onChangeImage&&y.onChangeImage(g.imageSrc))}function B(){f(null),u(!1);const g={...l,...pe};h(g),E(!1),y.onChangeImage&&y.onChangeImage(void 0)}return C("div",{className:"ArchbaseImagePickerEditor",children:[!m&&a("div",{className:"place-image",children:C("div",{className:"image-holder",style:{width:y.width,height:y.height,borderRadius:y.borderRadius,aspectRatio:y.aspectRatio+"",backgroundColor:s.imageBackgroundColor??(r==="dark"?o.colors.dark[7]:o.white),border:`${ce(1)} solid ${r==="dark"?o.colors.dark[4]:o.colors.gray[3]}`},children:[a(O,{withinPortal:!0,withArrow:!0,label:`${M.t("archbase:Upload a image")}`,children:a(X,{component:"button",color:"blue",variant:n,className:"icon-btn image-upload-btn",onClick:W,children:a(ie,{color:"purple"})})}),a("input",{ref:x,type:"file",style:{display:"none"},id:"filePicker-"+k,onChange:$})]})}),m&&C("div",{className:"place-image",children:[C("div",{className:"image-holder-loaded",style:{width:y.width,height:y.height,borderRadius:y.borderRadius,aspectRatio:y.aspectRatio+"",background:r==="dark"?o.colors.dark[7]:o.white,border:`${ce(1)} solid ${r==="dark"?o.colors.dark[4]:o.colors.gray[3]}`},children:[a("img",{src:c,alt:"image-loaded",style:{height:y.height,borderRadius:y.borderRadius,objectFit:y.objectFit,backgroundColor:s.imageBackgroundColor??(r==="dark"?o.colors.dark[7]:o.white)}}),!y.hideEditBtn&&C(p.Fragment,{children:[a("div",{className:"curtain",onClick:W,children:a(O,{withinPortal:!0,withArrow:!0,label:`${M.t("archbase:Upload a image")}`,children:a(X,{component:"button",color:"blue",variant:n,children:a(ie,{color:"white"})})})}),a("input",{ref:x,type:"file",style:{display:"none"},id:"filePicker-"+k,onChange:$})]})]}),q&&y.showImageSize&&a("div",{className:"caption image-caption",style:{color:q>120?"#f44336":"unset",fontWeight:q>120?"500":"unset"},children:a(Q,{children:`${M.t("archbase:size")}: ${q}Kb ${l.format}`})}),C("div",{style:{flexDirection:"row",boxSizing:"border-box",display:"flex",placeContent:"flex-start",alignItems:"flex-start"},className:"editing-bar-btn",children:[!y.hideAddBtn&&a(O,{withinPortal:!0,withArrow:!0,label:`${M.t("archbase:Upload a image")}`,children:a(X,{id:"upload-img",color:"blue",variant:n,onClick:W,children:a(ie,{color:"purple"})})}),!y.hideEditBtn&&a(O,{withinPortal:!0,withArrow:!0,label:`${M.t("archbase:Open the editor panel")}`,children:a(X,{id:"edit-img",color:"blue",variant:n,onClick:b,children:a(_e,{color:"teal"})})}),!y.hideDownloadBtn&&a(O,{withinPortal:!0,withArrow:!0,label:`${M.t("archbase:Download the image")}`,children:a(X,{component:"a",id:"download-img",href:c,color:"green",download:F.current,variant:n,children:a(Le,{color:"green"})})}),!y.hideDeleteBtn&&a(O,{withinPortal:!0,withArrow:!0,label:`${M.t("archbase:Remove")}`,children:a(X,{id:"delete-img",color:"red",variant:n,onClick:()=>B(),children:a($e,{color:"#C91A25"})})})]})]}),w&&a(et,{saveUpdates:R,color:t,image:c,initialState:l})]})});try{re.displayName="ArchbaseImagePickerEditor",re.__docgenInfo={description:"",displayName:"ArchbaseImagePickerEditor",props:{config:{defaultValue:null,description:"",name:"config",required:!0,type:{name:"ArchbaseImagePickerConf"}},imageSrcProp:{defaultValue:null,description:"",name:"imageSrcProp",required:!1,type:{name:"string"}},color:{defaultValue:null,description:"",name:"color",required:!1,type:{name:"string"}},imageChanged:{defaultValue:null,description:"",name:"imageChanged",required:!1,type:{name:"Function"}},variant:{defaultValue:null,description:"",name:"variant",required:!1,type:{name:"enum",value:[{value:'"light"'},{value:'"filled"'},{value:'"outline"'},{value:'"default"'},{value:'"transparent"'},{value:'"white"'},{value:'"subtle"'},{value:'"gradient"'}]}}}}}catch{}function ee({width:s=240,height:e=240,dataSource:t,dataField:i,disabled:n,readOnly:o,required:r,label:l,description:h,error:c,src:f,radius:m="4px",aspectRatio:u,objectFit:w="contain",compressInitial:E=80,onChangeImage:y,disabledBase64Convertion:z,innerRef:x,variant:I,imageBackgroundColor:N,...k}){const[F,L]=p.useState(void 0),U=p.useRef(),[W,$]=p.useState(c),T=Re();p.useEffect(()=>{$(void 0)},[F]);const q=()=>{let g=F;t&&i&&(g=t.getFieldValue(i),g||(g="")),qe(g)&&!z&&(g=atob(g)),L(g)},d=p.useCallback(()=>{q()},[]),b=p.useCallback(g=>{t&&i&&((g.type===P.dataChanged||g.type===P.recordChanged||g.type===P.afterScroll||g.type===P.afterCancel||g.type===P.afterEdit)&&(q(),T()),g.type===P.onFieldError&&g.fieldName===i&&$(g.error))},[]);Ce(()=>{q(),t&&i&&(t.addListener(b),t.addFieldChangeListener(i,d))}),Ee(()=>{q()},[]),Ie(()=>{t&&i&&(t.removeListener(b),t.removeFieldChangeListener(i,d))});const R=g=>{const S=g;L(V=>S),t&&!t.isBrowsing()&&i&&t.getFieldValue(i)!==S&&(S?t.setFieldValue(i,z?S:btoa(S)):t.setFieldValue(i,void 0)),y&&y(g)},B=()=>{let g=o;return t&&!o&&(g=t.isBrowsing()),g};return a("div",{style:{position:"relative",display:"inline-block"},children:a(ze.Wrapper,{withAsterisk:r,label:l,description:h,error:W,ref:x||U,children:a(re,{imageSrcProp:F,variant:I,config:{borderRadius:m,width:s,height:e,objectFit:w,compressInitial:E,showImageSize:!B(),hideDeleteBtn:B(),hideDownloadBtn:B(),hideEditBtn:B(),hideAddBtn:B(),onChangeImage:R,imageBackgroundColor:N}})})})}try{ee.displayName="ArchbaseImageEdit",ee.__docgenInfo={description:"",displayName:"ArchbaseImageEdit",props:{dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o valor do rich edit",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o valor do rich edit na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"Indicador se o rich edit está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"Indicador se o rich edit é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"Indicador se o preenchimento do rich edit é obrigatório",name:"required",required:!1,type:{name:"boolean"}},style:{defaultValue:null,description:"Estilo do checkbox",name:"style",required:!1,type:{name:"CSSProperties"}},label:{defaultValue:null,description:"Título do rich edit",name:"label",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"Descrição do rich edit",name:"description",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Último erro ocorrido no rich edit",name:"error",required:!1,type:{name:"string"}},variant:{defaultValue:null,description:'Controla a aparência dos botões, sendo padrão "transparent". ("filled" | "light" | "outline" | "transparent" | "white" | "subtle" | "default" | "gradient")',name:"variant",required:!1,type:{name:"enum",value:[{value:'"light"'},{value:'"filled"'},{value:'"outline"'},{value:'"default"'},{value:'"transparent"'},{value:'"white"'},{value:'"subtle"'},{value:'"gradient"'}]}},src:{defaultValue:null,description:"Image src",name:"src",required:!1,type:{name:"string"}},alt:{defaultValue:null,description:"Texto alternativo da imagem, usado como título para espaço reservado se a imagem não foi carregada",name:"alt",required:!1,type:{name:"string"}},width:{defaultValue:{value:"240"},description:"Largura da imagem, padrão de 100%, não pode exceder 100%",name:"width",required:!1,type:{name:"string | number"}},height:{defaultValue:{value:"240"},description:"Altura da imagem, o padrão é a altura da imagem original ajustada para determinada largura",name:"height",required:!1,type:{name:"string | number"}},radius:{defaultValue:{value:"4px"},description:"Chave de theme.radius ou qualquer valor CSS válido para definir border-radius, 0 por padrão",name:"radius",required:!1,type:{name:"string | number"}},imageRef:{defaultValue:null,description:"Obter ref do elemento de imagem",name:"imageRef",required:!1,type:{name:"ForwardedRef<HTMLImageElement>"}},caption:{defaultValue:null,description:"Legenda da imagem, exibida abaixo da imagem",name:"caption",required:!1,type:{name:"ReactNode"}},aspectRatio:{defaultValue:null,description:"",name:"aspectRatio",required:!1,type:{name:"number"}},objectFit:{defaultValue:{value:"contain"},description:"",name:"objectFit",required:!1,type:{name:"enum",value:[{value:'"revert"'},{value:'"fill"'},{value:'"cover"'},{value:'"contain"'},{value:'"scale-down"'}]}},compressInitial:{defaultValue:{value:"80"},description:"",name:"compressInitial",required:!1,type:{name:"number"}},onChangeImage:{defaultValue:null,description:"",name:"onChangeImage",required:!1,type:{name:"(image: any) => void"}},disabledBase64Convertion:{defaultValue:null,description:"Desabilita conversão do conteúdo em base64 antes de salvar na fonte de dados",name:"disabledBase64Convertion",required:!1,type:{name:"boolean"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}},imageBackgroundColor:{defaultValue:null,description:"Cor de fundo da imagem",name:"imageBackgroundColor",required:!1,type:{name:"string"}}}}}catch{}const it=()=>{const s=Se(),{dataSource:e}=Me({initialData:nt,name:"dsPessoas"});return e!=null&&e.isBrowsing()&&!(e!=null&&e.isEmpty())&&e.edit(),Ne({dataSource:e,listener:t=>{switch(t.type){case P.fieldChanged:{s();break}}}}),C(te,{children:[a(te.Col,{offset:1,span:4,children:C(Y,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[a(Y.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:a(ue,{justify:"space-between",children:a(Q,{fw:500,children:"Image Editor Component"})})}),a(ke,{style:{height:400},children:a(ee,{dataSource:e,dataField:"foto",width:140,height:150,label:"Foto",description:"teste",error:"tessss"})})]})}),a(te.Col,{span:4,children:C(Y,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[a(Y.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:a(ue,{justify:"space-between",children:a(Q,{fw:500,children:"DataSource dsPessoas"})})}),a(Te,{style:{height:500},children:a(Fe,{data:e})})]})})]})},nt=[De[0]],ii={title:"Editores/Image Edit",component:ee},K={name:"Exemplo simples",render:()=>a(it,{})};var ge,fe,ye;K.parameters={...K.parameters,docs:{...(ge=K.parameters)==null?void 0:ge.docs,source:{originalSource:`{
  name: 'Exemplo simples',
  render: () => <ArchbaseImageEditExample />
}`,...(ye=(fe=K.parameters)==null?void 0:fe.docs)==null?void 0:ye.source}}};export{K as Primary,ii as default};
