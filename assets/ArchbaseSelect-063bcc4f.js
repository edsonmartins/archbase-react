import{j as r,a as te}from"./jsx-runtime-c9381026.js";import{l as O}from"./lodash-4d0be66a.js";import{r as t,R as M}from"./index-8b3efc3f.js";import{b as re,d as oe,c as ue}from"./useArchbaseDataSource-c192df6e.js";import"./index-9e992aa6.js";import{C as ie}from"./ArchbaseAsyncSelect-62435bad.js";import{u as se,C as b,a as de,b as ce}from"./Combobox-de7c8f4c.js";import{D as p,A as w}from"./useArchbaseDataSourceListener-a0bbc6ee.js";import{I as pe}from"./InputBase-3bc61936.js";import{I as me}from"./Input-da8fd83e.js";function fe(o,m,n={leading:!1}){const[l,i]=t.useState(o),d=t.useRef(null),a=t.useRef(!0),c=()=>window.clearTimeout(d.current);t.useEffect(()=>c,[]);const y=t.useCallback(D=>{c(),a.current&&n.leading?i(D):d.current=window.setTimeout(()=>{a.current=!0,i(D)},m),a.current=!1},[n.leading]);return[l,y]}const be=M.createContext({}),ye=be.Provider;function ve(o,m,n,l,i,d){if(!m&&!n&&!o)return[];if(o&&o instanceof w&&l&&i&&d){const a=o;a.first();const c=[];for(;!a.isEOF();)c.push({label:a.getFieldValue(d),value:a.getCurrentRecord(),origin:a.getCurrentRecord(),key:O.uniqueId("select")}),a.next();return a.first(),c}return o&&!(o instanceof w)?o.map(a=>({label:a.label?a.label:l(a),value:a.value?a.value:i(a),origin:a.origin?a.origin:a,key:O.uniqueId("select")})):n?M.Children.toArray(n).map(a=>({label:a.props.label,value:a.props.value,origin:a.props.value,key:O.uniqueId("select")})):m.map(a=>({label:l(a),value:i(a),origin:a,key:O.uniqueId("select")}))}function S({allowDeselect:o=!0,clearable:m=!0,dataSource:n,dataField:l,disabled:i=!1,debounceTime:d=500,readOnly:a=!1,placeholder:c,initialOptions:y=[],searchable:D=!1,label:U,description:Z,error:v,icon:J,iconWidth:K,required:Q,width:X,getOptionLabel:R,getOptionValue:A,optionsLabelField:F,onFocusEnter:I,onFocusExit:T,onSelectValue:k,value:P,defaultValue:he,filter:qe,size:Ee,initiallyOpened:Ve,itemComponent:h,onDropdownOpen:ge,onDropdownClose:Ce,limit:Oe,nothingFound:we,zIndex:Y,dropdownPosition:$,children:z,innerRef:De,options:s,customGetDataSourceFieldValue:q,customSetDataSourceFieldValue:L}){const E=se({onDropdownClose:()=>E.resetSelectedOption()}),[V,N]=t.useState(P);fe("",d);const[_,x]=t.useState(v),[G,B]=t.useState(0),f=t.useMemo(()=>ve(s,y,z,R,A,F),[G,s,y,z,R,A,F]);t.useEffect(()=>{x(void 0)},[V]),t.useEffect(()=>{v!==_&&x(v)},[v]);const g=()=>{let e=P;n&&l&&!n.isEmpty()&&(e=q?q():n.getFieldValue(l),e||(e="")),N(e)},j=t.useCallback(()=>{g()},[]),W=t.useCallback(e=>{n&&l&&((e.type===p.dataChanged||e.type===p.recordChanged||e.type===p.afterScroll||e.type===p.afterCancel)&&g(),e.type===p.onFieldError&&e.fieldName===l&&(x(e.error),B(u=>u+1)))},[]),H=t.useCallback(e=>{n&&l&&e.type===p.dataChanged&&B(u=>u+1)},[]),C=t.useCallback(()=>{if(!f)return{};const e=f.find(u=>u.value===V);return e||{}},[V,f]);re(()=>{g(),n&&l&&(n.addListener(W),n.addFieldChangeListener(l,j)),s&&s instanceof w&&s.addListener(H)}),oe(()=>{n&&l&&(n.removeListener(W),n.removeFieldChangeListener(l,j)),s&&s instanceof w&&s.removeListener(H)}),ue(()=>{g()},[]);const ee=e=>{if(N(u=>e),n&&!n.isBrowsing()&&l&&(q?q():n.getFieldValue(l))!==e&&(L?L(e):n.setFieldValue(l,e)),k){const u=f.find(le=>le.value===e);k(e,u?u.origin:void 0)}},ae=e=>{T&&T(e)},ne=e=>{I&&I(e)};return r(ye,{value:{handleDropdownScrollEnded:()=>{}},children:te(b,{disabled:i,readOnly:(()=>{let e=a;return n&&!a&&(e=n.isBrowsing()),e})(),store:E,withinPortal:!0,position:$,zIndex:Y,onOptionSubmit:e=>{ee(e),E.closeDropdown()},children:[r(de,{children:r(pe,{w:X,required:Q,leftSection:J,leftSectionWidth:K,label:U,description:Z,error:_,onBlur:ae,onFocus:ne,component:"button",type:"button",pointer:!0,rightSection:r(b.Chevron,{}),onClick:()=>E.toggleDropdown(),rightSectionPointerEvents:"none",multiline:!0,children:V?r(b.Option,{value:C().value,children:h?r(h,{...C()}):C().label},C().key):r(me.Placeholder,{children:c})})}),r(ce,{children:r(b.Options,{children:r(ie,{mah:280,children:f.map(e=>r(b.Option,{value:e.value,children:h?r(h,{...e}):e.label},e.key))})})})]})})}S.displayName="ArchbaseSelect";try{S.displayName="ArchbaseSelect",S.__docgenInfo={description:"",displayName:"ArchbaseSelect",props:{allowDeselect:{defaultValue:{value:"true"},description:"Permite ou não delecionar um item",name:"allowDeselect",required:!1,type:{name:"boolean"}},clearable:{defaultValue:{value:"true"},description:"Indicador se permite limpar o select",name:"clearable",required:!1,type:{name:"boolean"}},dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o item selecionado",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o item selecionado na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},debounceTime:{defaultValue:{value:"500"},description:"Tempo de espero antes de realizar a busca",name:"debounceTime",required:!1,type:{name:"number"}},disabled:{defaultValue:{value:"false"},description:"Indicador se o select está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:{value:"false"},description:"Indicador se o select é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},style:{defaultValue:null,description:"Estilo do select",name:"style",required:!1,type:{name:"CSSProperties"}},placeholder:{defaultValue:null,description:"Texto explicativo do select",name:"placeholder",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"Título do select",name:"label",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"Descrição do select",name:"description",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Último erro ocorrido no select",name:"error",required:!1,type:{name:"string"}},searchable:{defaultValue:{value:"false"},description:"Permite pesquisar no select",name:"searchable",required:!1,type:{name:"boolean"}},icon:{defaultValue:null,description:"Icon a esquerda do select",name:"icon",required:!1,type:{name:"ReactNode"}},iconWidth:{defaultValue:null,description:"Largura do icone a esquerda do select",name:"iconWidth",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},value:{defaultValue:null,description:"Valor de entrada controlado",name:"value",required:!1,type:{name:"any"}},defaultValue:{defaultValue:null,description:"Valor padrão de entrada não controlado",name:"defaultValue",required:!1,type:{name:"any"}},filter:{defaultValue:null,description:"Função com base em quais itens no menu suspenso são filtrados",name:"filter",required:!1,type:{name:"OptionsFilter"}},size:{defaultValue:null,description:"Tamanho de entrada",name:"size",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},initiallyOpened:{defaultValue:null,description:"Estado aberto do menu suspenso inicial",name:"initiallyOpened",required:!1,type:{name:"boolean"}},itemComponent:{defaultValue:null,description:"Alterar renderizador de item",name:"itemComponent",required:!1,type:{name:"FC<any>"}},width:{defaultValue:null,description:"Largura do select",name:"width",required:!1,type:{name:"string | number"}},onDropdownOpen:{defaultValue:null,description:"Chamado quando o menu suspenso é aberto",name:"onDropdownOpen",required:!1,type:{name:"() => void"}},onDropdownClose:{defaultValue:null,description:"Chamado quando o menu suspenso é aberto",name:"onDropdownClose",required:!1,type:{name:"() => void"}},limit:{defaultValue:null,description:"Limite a quantidade de itens exibidos por vez para seleção pesquisável",name:"limit",required:!1,type:{name:"number"}},nothingFound:{defaultValue:null,description:"Rótulo nada encontrado",name:"nothingFound",required:!1,type:{name:"ReactNode"}},zIndex:{defaultValue:null,description:"Índice z dropdown",name:"zIndex",required:!1,type:{name:"ZIndex"}},dropdownPosition:{defaultValue:null,description:"Comportamento de posicionamento dropdown",name:"dropdownPosition",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"right"'},{value:'"bottom"'},{value:'"left"'},{value:'"top-end"'},{value:'"top-start"'},{value:'"right-end"'},{value:'"right-start"'},{value:'"bottom-end"'},{value:'"bottom-start"'},{value:'"left-end"'},{value:'"left-start"'}]}},onSelectValue:{defaultValue:null,description:"Evento quando um valor é selecionado",name:"onSelectValue",required:!1,type:{name:"(value: O, origin: any) => void"}},onFocusExit:{defaultValue:null,description:"Evento quando o foco sai do select",name:"onFocusExit",required:!1,type:{name:"FocusEventHandler<T>"}},onFocusEnter:{defaultValue:null,description:"Evento quando o select recebe o foco",name:"onFocusEnter",required:!1,type:{name:"FocusEventHandler<T>"}},initialOptions:{defaultValue:{value:"[]"},description:"Opções de seleção iniciais",name:"initialOptions",required:!1,type:{name:"O[]"}},getOptionLabel:{defaultValue:null,description:"Function que retorna o label de uma opção",name:"getOptionLabel",required:!0,type:{name:"(option: O) => ReactNode"}},getOptionValue:{defaultValue:null,description:"Function que retorna o valor de uma opção",name:"getOptionValue",required:!0,type:{name:"(option: O) => any"}},children:{defaultValue:null,description:"Coleção de ArchbaseSelectItem[] que representam as opções do select",name:"children",required:!1,type:{name:"ReactNode | ReactNode[]"}},required:{defaultValue:null,description:"Indica se o select tem o preenchimento obrigatório",name:"required",required:!1,type:{name:"boolean"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}},options:{defaultValue:null,description:"Selecione os dados usados ​​para renderizar itens no menu suspenso",name:"options",required:!1,type:{name:"ArchbaseDataSource<any, any> | O[] | ArchbaseSelectItemProps<O>[]"}},optionsLabelField:{defaultValue:null,description:"",name:"optionsLabelField",required:!1,type:{name:"string"}},customGetDataSourceFieldValue:{defaultValue:null,description:"",name:"customGetDataSourceFieldValue",required:!1,type:{name:"() => any"}},customSetDataSourceFieldValue:{defaultValue:null,description:"",name:"customSetDataSourceFieldValue",required:!1,type:{name:"(value: any) => void"}}}}}catch{}export{S as A};
