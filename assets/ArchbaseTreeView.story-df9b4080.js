import{j as i,a as le}from"./jsx-runtime-29545a09.js";import{a as pe}from"./lodash-4d0be66a.js";import{r as l}from"./index-76fb7be0.js";import"./index-1076ae77.js";import{u as Be}from"./useArchbaseTheme-69c231ab.js";import{u as Ce}from"./use-force-update-df6d2b99.js";import{A as J}from"./ActionIcon-23bc393d.js";import{c as Ve}from"./createReactComponent-1d99d95b.js";import{I as Me}from"./IconChevronRight-0c81e76f.js";import{I as Pe}from"./IconChevronDown-4d1cc0d3.js";import{S as De}from"./Space-3f7303e6.js";import{T as qe}from"./Text-052cbebe.js";import{u as Re}from"./use-mantine-color-scheme-940af2ab.js";import{r as me}from"./polymorphic-factory-e212381f.js";import{G as he,C as ye}from"./Grid-72b79d89.js";import{G as ze}from"./Group-ec80c87c.js";import"./_commonjsHelpers-de833af9.js";import"./Loader-2934e180.js";import"./Transition-7fd90e94.js";import"./index-d3ea75b5.js";import"./use-reduced-motion-94535b68.js";import"./use-media-query-404d9c84.js";import"./use-did-update-4c7f685e.js";import"./UnstyledButton-6bceb5b8.js";import"./index-9d475cdf.js";import"./Mantine.context-0732ca39.js";import"./Paper-9304c07a.js";import"./create-safe-context-978e3819.js";import"./get-sorted-breakpoints-91e0685a.js";import"./px-90b8b31c.js";var Fe=Ve("square-check","IconSquareCheck",[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 12l2 2l4 -4",key:"svg-1"}]]),Le=Ve("square","IconSquare",[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}]]);const X=({node:s,options:u,level:$,onSelectedStatusChanged:k,onExpandedCollapsedChanged:C,onFocusedChanged:V,getFocused:x,onNodeDoubleClicked:q,onLoadDataSource:B,addNode:A,removeNode:M,id:j,customRenderText:S,update:P})=>{const[b,T]=l.useState(!1),[f,I]=l.useState(!1),_=Ce(),w=l.useCallback(d=>{const h=!b;T(h),C(s.id,h),d.stopPropagation()},[b,s.id,C,s.state.expanded]);l.useEffect(()=>{s.state&&T(s.state.expanded),s.state&&I(s.state.selected)},[s.state.expanded,s.state.selected]);const N=l.useCallback(d=>{const h=!f;I(h),k(s.id,h),d.stopPropagation(),_()},[f,s.id,k,s.state.selected]),D=l.useCallback(d=>{V(s.id),_(),d.stopPropagation()},[s.id,V]),R=l.useCallback(d=>{q(s.id,f),d.stopPropagation()},[s.id,f,q]),p=l.useMemo(()=>{const d={};return u.highlightSelected&&f?(d.color=u.selectedColor,d.backgroundColor=u.selectedBackgroundColor):(d.color=s.color||u.color,d.backgroundColor=s.backgroundColor||u.backgroundColor),d},[f,s,u]),z=l.useMemo(()=>{if(u.selectable)return f?i(J,{onClick:N,variant:"transparent",children:i(Fe,{size:"1.2rem",style:p})}):i(J,{onClick:N,variant:"transparent",children:i(Le,{size:"1.2rem",style:p})})},[u.selectable,f,p,N]),F=l.useMemo(()=>{var d;return b?((d=s.state)==null?void 0:d.loading)===!0?i("i",{style:{...p,width:"1rem"},className:"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-lg"}):i(J,{onClick:w,variant:"transparent",children:i(Pe,{size:"1.2rem",style:{...p}})}):i(J,{onClick:w,variant:"transparent",children:i(Me,{size:"1.2rem",style:{...p}})})},[b,f,s,p,w,N]),L=l.useMemo(()=>{const d=x();return d&&d.id===s.id?{color:u.focusedColor,backgroundColor:u.focusedBackgroundColor}:{}},[s.id,x,u.focusedColor,u.focusedBackgroundColor,b,f]),c=l.useMemo(()=>{const d=[];return s.nodes&&s.state.expanded&&s.nodes.forEach(h=>{d.push(i(X,{id:`${u.id}_${h.id}`,node:h,level:$+1,onSelectedStatusChanged:k,onExpandedCollapsedChanged:C,onFocusedChanged:V,getFocused:x,onNodeDoubleClicked:q,addNode:A,removeNode:M,options:u,onLoadDataSource:B,customRenderText:S,update:P},h.id))}),d},[s.nodes,s.state,s,b,f,$,k,C,V,x,q,A,M,u,P]);return le("li",{style:p,onDoubleClick:R,id:j,children:[le("div",{style:{display:"flex"},children:[s.isleaf?i(De,{w:"md"}):F,z,le("span",{style:{...L,display:"flex"},className:"archbase-treeview-item",onClick:D,children:[s.icon,s.image?i("img",{alt:"",style:{padding:"0.2rem"},src:s.image}):null,S?S(s):i(qe,{truncate:!0,children:s.text})]})]}),i("ul",{children:c})]},`${u.id}_${s.id}`)};try{X.displayName="ArchbaseTreeViewItem",X.__docgenInfo={description:"",displayName:"ArchbaseTreeViewItem",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},node:{defaultValue:null,description:"",name:"node",required:!0,type:{name:"ArchbaseTreeNode"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"ArchbaseTreeViewOptions"}},level:{defaultValue:null,description:"",name:"level",required:!0,type:{name:"number"}},onLoadDataSource:{defaultValue:null,description:"",name:"onLoadDataSource",required:!0,type:{name:"(id: string) => void"}},onSelectedStatusChanged:{defaultValue:null,description:"",name:"onSelectedStatusChanged",required:!0,type:{name:"(id: string, selected: boolean) => void"}},onExpandedCollapsedChanged:{defaultValue:null,description:"",name:"onExpandedCollapsedChanged",required:!0,type:{name:"(id: string, expanded: boolean) => void"}},onFocusedChanged:{defaultValue:null,description:"",name:"onFocusedChanged",required:!0,type:{name:"(id: string) => void"}},getFocused:{defaultValue:null,description:"",name:"getFocused",required:!0,type:{name:"() => ArchbaseTreeNode"}},onNodeDoubleClicked:{defaultValue:null,description:"",name:"onNodeDoubleClicked",required:!0,type:{name:"(id: string, selected: boolean) => void"}},addNode:{defaultValue:null,description:"",name:"addNode",required:!0,type:{name:"(id: string, text: string) => void"}},removeNode:{defaultValue:null,description:"",name:"removeNode",required:!0,type:{name:"(id: string) => void"}},customRenderText:{defaultValue:null,description:"",name:"customRenderText",required:!1,type:{name:"(node: ArchbaseTreeNode) => ReactNode"}},update:{defaultValue:null,description:"",name:"update",required:!0,type:{name:"number"}}}}}catch{}const oe=({id:s,selectable:u=!0,color:$="#428bca",backgroundColor:k,borderColor:C,hoverColor:V,hoverBackgroundColor:x="#e7f4f9",focusedColor:q,focusedBackgroundColor:B,selectedColor:A,selectedBackgroundColor:M="auto",iconColor:j="black",iconBackgroundColor:S,enableLinks:P=!1,highlightSelected:b=!0,withBorder:T=!0,showTags:f=!1,onDoubleClick:I,onFocusedNode:_,onLoosedFocusNode:w,onSelectedNode:N,onUnSelectedNode:D,onRemovedNode:R,onLoadDataSource:p,onAddedNode:z,onExpandedNode:F,onCollapsedNode:L,onChangedDataSource:c,dataSource:d,style:h,height:Z,width:ee,focusedNode:Ne,customRenderText:ve,update:Ue=Math.random()})=>{const v=Be(),{colorScheme:te}=Re(),[o,G]=l.useState([]),[m,xe]=l.useState(Ne),g=l.useRef([]),Te=l.useRef(0),[de,we]=l.useState(0),Ae=Ce(),ae=l.useCallback(a=>a.nodes?a.nodes.map(e=>(g.current.push(e.id),{id:e.id,nodes:ae(e),parentNode:a,isleaf:e.isleaf?e.isleaf:!1,state:{selected:e.state?!!e.state.selected:!1,expanded:e.state?!!e.state.expanded:!1,loading:e.state?!!e.state.loading:!1},text:e.text,icon:e.icon,color:e.color,image:e.image,data:e.data,type:e.type})):[],[]),y=l.useCallback((a,e)=>{let t;return a&&a.forEach(function(r){r.id===e?t=r:r.nodes&&(t=y(r.nodes,e)||t)}),t},[]),K=l.useCallback((a,e)=>{let t=!1;for(let r=g.current.length-1;r>=0;r--){if(t){const n=y(o,g.current[r]);if(e&&n&&n.parentNode&&n.parentNode.state&&n.parentNode.state.expanded||e&&n&&n.state&&n.state.expanded)return n}g.current[r]===a&&(t=!0)}},[o]),O=l.useCallback((a,e)=>{let t=!1;for(let r=0;r<g.current.length;r++){if(t){const n=y(o,g.current[r]);if(e&&n&&n.parentNode&&n.parentNode.state.expanded||e&&n&&n.state&&n.state.expanded)return n}g.current[r]===a&&(t=!0)}},[o]),re=l.useCallback((a,e)=>{if(!a||a.length<=0)return[];const t=[];return pe.each(a,r=>{r.nodes&&r.nodes.length>0&&(r.nodes=re(r.nodes,e)),r.id!==e&&t.push(r)}),t},[]),se=l.useCallback((a,e)=>{const t=[];return a&&a.forEach(function(r){r&&r.state&&(r.state.selected=e),t.push(r),t.push(...se(r.nodes||[],e))}),t},[]),Se=l.useCallback(a=>{const e=[];return a.forEach(t=>{t&&t.state&&t.state.selected&&e.push(t),e.push(...Se(t.nodes||[]))}),e},[]),Ie=l.useCallback(a=>{!a.parentNode||!a.parentNode.state||(a.parentNode.state.selected=!0,Ie(a.parentNode))},[]),ne=a=>{const e=[];for(const t of a)if(t.state.selected&&e.push(t),t.nodes&&t.nodes.length>0){const r=ne(t.nodes);e.push(...r)}return e},Q=l.useCallback((a,e)=>{const t=[],r=[...o],n=y(r,a);n&&n.state&&(n.state.selected=e,t.push(n),t.push(...se(n.nodes||[],e)),G(r),c&&c(r),e===!0?N&&N(r,n,ne(r)):D&&D(r,n,ne(r)))},[o,c,N,D,se]);l.useEffect(()=>{we(a=>a+1),Ae()},[o]);const Y=l.useCallback(a=>{if(p){const e=[...o],t=y(e,a);if(t){const r=p(t);r&&r.then(n=>{t&&(t.nodes=n,t.state.loading=!1),G(e),c&&c(e)},()=>{console.log("erro loaded")})}}},[o,c,p]),U=l.useCallback((a,e)=>{const t=[...o],r=[],n=y(t,a);if(n&&n.state){let H=!n.nodes&&!n.isleaf;!p&&H&&(H=!1),n.state.expanded=e,n.state.loading=H,r.push(n),G(t),c&&c(t),e===!0?F&&F(t,r):L&&L(t,r),H&&Y(n.id)}},[o,c,p,Y,F,L]),E=l.useCallback(a=>{w&&m&&w(m);const e=y(o,a);e&&(xe(e),_&&_(e))},[o,m,_,w]),ie=l.useCallback(()=>m,[m]),ue=l.useCallback((a,e)=>{if(I){const t=y(o,a);t&&I(o,t)}},[o,I]),ce=l.useCallback((a,e)=>{const t=y(o,a);if(t){const r={text:e,state:{selected:!1,expanded:!1,loading:!1},parentNode:t,id:`${Te.current++}`,icon:"",color:"",image:""};t.nodes?t.nodes.push(r):t.nodes=[r],c&&c(o),z&&z(r,o)}},[o,c,z]),fe=l.useCallback(a=>{const e=re([...o],a);if(e.length===0)return!1;G(e),c&&c(e),R&&R(e)},[o,re,c,R]),_e=l.useCallback(a=>{if(m){if(a.keyCode===38){a.preventDefault();const e=K(m.id,!0);if(e){E(e.id);const t=document.getElementById(`${s}_${e.id}`);t&&t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}}else if(a.keyCode===40){a.preventDefault();const e=O(m.id,!0);if(e){E(e.id);const t=document.getElementById(`${s}_${e.id}`);t&&t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}}else if(a.keyCode===33){a.preventDefault();let e=0,t=K(m.id,!0),r=t;for(;e<5&&r;)r=K(r.id,!0),r&&(t=r),e++;if(t){E(t.id);const n=document.getElementById(`${s}_${t.id}`);n&&n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}}else if(a.keyCode===34){a.preventDefault();let e=O(m.id,!0),t=e,r=0;for(;r<5&&t;)t=O(t.id,!0),t&&(e=t),r++;if(e){E(e.id);const n=document.getElementById(`${s}_${e.id}`);n&&n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}}else if(a.keyCode===32){a.preventDefault();const e=y(o,m.id);if(e){let t=!0;e.state.selected&&(t=!e.state.selected),Q(e.id,t)}}else if(a.keyCode===107){a.preventDefault();const e=y(o,m.id);e&&(e.state.expanded||U(e.id,!0))}else if(a.keyCode===109){a.preventDefault();const e=y(o,m.id);e&&e.state.expanded&&U(e.id,!1)}}},[m,o,g.current,K,O,Q,U]);l.useEffect(()=>{g.current=[],G(ae(pe.clone({nodes:d})))},[d,ae]);const Ee=l.useMemo(()=>({...T?{border:C&&`${me(1)} solid ${te==="dark"?v.colors.dark[4]:v.colors.gray[3]}`}:{border:"none"},...Z?{height:Z}:{},...ee?{width:ee}:{},marginLeft:"-20px",...h}),[h,T,C,Z,ee]),$e=l.useMemo(()=>o.map(a=>i(X,{id:`${s}_${a.id}`,node:a,level:1,onSelectedStatusChanged:Q,onExpandedCollapsedChanged:U,onFocusedChanged:E,onNodeDoubleClicked:ue,onLoadDataSource:Y,getFocused:ie,addNode:ce,removeNode:fe,customRenderText:ve,update:de,options:{selectable:u,color:$,backgroundColor:k||"transparent",hoverColor:V||v.black,hoverBackgroundColor:x,focusedColor:q||v.white,focusedBackgroundColor:B||v.colors[v.primaryColor][5],selectedColor:A||"orange",selectedBackgroundColor:M,iconColor:j,iconBackgroundColor:S,enableLinks:P,highlightSelected:b,borderColor:C||`${me(1)} solid ${te==="dark"?v.colors.dark[4]:v.colors.gray[3]}`,withBorder:T,showTags:f,id:s}},a.id)),[o,u,$,k,V,x,q,B,A,M,j,S,P,b,T,f,Q,U,E,ue,Y,ie,ce,fe,de]);return i("div",{tabIndex:-1,className:"archbase-treeview",onKeyDown:_e,style:Ee,children:i("ul",{style:{height:"100%",overflowY:"auto"},children:$e})})};try{oe.displayName="ArchbaseTreeView",oe.__docgenInfo={description:"",displayName:"ArchbaseTreeView",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},selectable:{defaultValue:{value:"true"},description:"",name:"selectable",required:!1,type:{name:"boolean"}},color:{defaultValue:{value:"#428bca"},description:"",name:"color",required:!1,type:{name:"string"}},backgroundColor:{defaultValue:null,description:"",name:"backgroundColor",required:!1,type:{name:"string"}},borderColor:{defaultValue:null,description:"",name:"borderColor",required:!1,type:{name:"string"}},hoverColor:{defaultValue:null,description:"",name:"hoverColor",required:!1,type:{name:"string"}},hoverBackgroundColor:{defaultValue:{value:"#e7f4f9"},description:"",name:"hoverBackgroundColor",required:!1,type:{name:"string"}},focusedColor:{defaultValue:null,description:"",name:"focusedColor",required:!1,type:{name:"string"}},focusedBackgroundColor:{defaultValue:null,description:"",name:"focusedBackgroundColor",required:!1,type:{name:"string"}},selectedColor:{defaultValue:null,description:"",name:"selectedColor",required:!1,type:{name:"string"}},selectedBackgroundColor:{defaultValue:{value:"auto"},description:"",name:"selectedBackgroundColor",required:!1,type:{name:"string"}},iconColor:{defaultValue:{value:"black"},description:"",name:"iconColor",required:!1,type:{name:"string"}},iconBackgroundColor:{defaultValue:null,description:"",name:"iconBackgroundColor",required:!1,type:{name:"string"}},enableLinks:{defaultValue:{value:"false"},description:"",name:"enableLinks",required:!1,type:{name:"boolean"}},highlightSelected:{defaultValue:{value:"true"},description:"",name:"highlightSelected",required:!1,type:{name:"boolean"}},withBorder:{defaultValue:{value:"true"},description:"",name:"withBorder",required:!1,type:{name:"boolean"}},showTags:{defaultValue:{value:"false"},description:"",name:"showTags",required:!1,type:{name:"boolean"}},nodes:{defaultValue:null,description:"",name:"nodes",required:!1,type:{name:"ArchbaseTreeNode[]"}},onDoubleClick:{defaultValue:null,description:"",name:"onDoubleClick",required:!1,type:{name:"(dataSource: ArchbaseTreeNode[], node: ArchbaseTreeNode) => void"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"() => void"}},onFocusedNode:{defaultValue:null,description:"",name:"onFocusedNode",required:!1,type:{name:"(node: ArchbaseTreeNode) => void"}},onLoosedFocusNode:{defaultValue:null,description:"",name:"onLoosedFocusNode",required:!1,type:{name:"(focused: ArchbaseTreeNode) => void"}},onSelectedNode:{defaultValue:null,description:"",name:"onSelectedNode",required:!1,type:{name:"(dataSource: ArchbaseTreeNode[], node: ArchbaseTreeNode, selectedNodes: ArchbaseTreeNode[]) => void"}},onUnSelectedNode:{defaultValue:null,description:"",name:"onUnSelectedNode",required:!1,type:{name:"(dataSource: ArchbaseTreeNode[], node: ArchbaseTreeNode, selectedNodes: ArchbaseTreeNode[]) => void"}},onRemovedNode:{defaultValue:null,description:"",name:"onRemovedNode",required:!1,type:{name:"(dataSource: ArchbaseTreeNode[]) => void"}},onLoadDataSource:{defaultValue:null,description:"",name:"onLoadDataSource",required:!1,type:{name:"(node: ArchbaseTreeNode) => Promise<ArchbaseTreeNode[]>"}},onAddedNode:{defaultValue:null,description:"",name:"onAddedNode",required:!1,type:{name:"(node: ArchbaseTreeNode, dataSource: ArchbaseTreeNode[]) => void"}},onExpandedNode:{defaultValue:null,description:"",name:"onExpandedNode",required:!1,type:{name:"(dataSource: ArchbaseTreeNode[], expandedNodes: ArchbaseTreeNode[]) => void"}},onCollapsedNode:{defaultValue:null,description:"",name:"onCollapsedNode",required:!1,type:{name:"(dataSource: ArchbaseTreeNode[], expandedNodes: ArchbaseTreeNode[]) => void"}},onChangedDataSource:{defaultValue:null,description:"",name:"onChangedDataSource",required:!1,type:{name:"(dataSource: ArchbaseTreeNode[]) => void"}},dataSource:{defaultValue:null,description:"",name:"dataSource",required:!0,type:{name:"ArchbaseTreeNode[]"}},focusedNode:{defaultValue:null,description:"",name:"focusedNode",required:!1,type:{name:"ArchbaseTreeNode"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},height:{defaultValue:null,description:"",name:"height",required:!1,type:{name:"string"}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"string"}},customRenderText:{defaultValue:null,description:"",name:"customRenderText",required:!1,type:{name:"(node: ArchbaseTreeNode) => ReactNode"}},update:{defaultValue:{value:"Math.random()"},description:"",name:"update",required:!1,type:{name:"number"}}}}}catch{}const Ge=()=>i(he,{children:i(he.Col,{span:12,children:i(ye,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:i(ye.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:i(ze,{justify:"space-between",children:i(qe,{fw:500,children:"TreeView"})})})})})}),Ct={title:"Listas e tabelas/Treeview",component:oe},W={name:"Exemplo simples",render:()=>i(Ge,{})};var be,ge,ke;W.parameters={...W.parameters,docs:{...(be=W.parameters)==null?void 0:be.docs,source:{originalSource:`{
  name: 'Exemplo simples',
  render: () => <ArchbaseTreeViewExample />
}`,...(ke=(ge=W.parameters)==null?void 0:ge.docs)==null?void 0:ke.source}}};export{W as Primary,Ct as default};
