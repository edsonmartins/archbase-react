import{j as r,a as le}from"./jsx-runtime-29545a09.js";import{l as C}from"./lodash-4d0be66a.js";import{r as t,R as H}from"./index-76fb7be0.js";import{b as te,d as re,c as oe}from"./useArchbaseDataSource-0bdc03a6.js";import"./index-1076ae77.js";import{C as ue}from"./ArchbaseAsyncSelect-5db62bb5.js";import{u as ie,C as b,a as se,b as de}from"./Combobox-acbe011d.js";import{D as p,A as O}from"./useArchbaseDataSourceListener-cbed610e.js";import{I as ce}from"./InputBase-b1a2e9dc.js";import{I as pe}from"./Input-abb5d566.js";function me(o,m,n={leading:!1}){const[l,i]=t.useState(o),d=t.useRef(null),a=t.useRef(!0),c=()=>window.clearTimeout(d.current);t.useEffect(()=>c,[]);const y=t.useCallback(w=>{c(),a.current&&n.leading?i(w):d.current=window.setTimeout(()=>{a.current=!0,i(w)},m),a.current=!1},[n.leading]);return[l,y]}const fe=H.createContext({}),be=fe.Provider;function ye(o,m,n,l,i,d){if(!m&&!n&&!o)return[];if(o&&o instanceof O&&l&&i&&d){const a=o;a.first();const c=[];for(;!a.isEOF();)c.push({label:a.getFieldValue(d),value:a.getCurrentRecord(),origin:a.getCurrentRecord(),key:C.uniqueId("select")}),a.next();return a.first(),c}return o&&!(o instanceof O)?o.map(a=>({label:a.label?a.label:l(a),value:a.value?a.value:i(a),origin:a.origin?a.origin:a,key:C.uniqueId("select")})):n?H.Children.toArray(n).map(a=>({label:a.props.label,value:a.props.value,origin:a.props.value,key:C.uniqueId("select")})):m.map(a=>({label:l(a),value:i(a),origin:a,key:C.uniqueId("select")}))}function D({allowDeselect:o=!0,clearable:m=!0,dataSource:n,dataField:l,disabled:i=!1,debounceTime:d=500,readOnly:a=!1,placeholder:c,initialOptions:y=[],searchable:w=!1,label:M,description:U,error:x,icon:Z,iconWidth:J,required:K,width:Q,getOptionLabel:S,getOptionValue:R,optionsLabelField:A,onFocusEnter:F,onFocusExit:I,onSelectValue:T,value:k,defaultValue:ve,filter:he,size:qe,initiallyOpened:Ee,itemComponent:v,onDropdownOpen:Ve,onDropdownClose:ge,limit:Ce,nothingFound:Oe,zIndex:X,dropdownPosition:Y,children:P,innerRef:we,options:s,customGetDataSourceFieldValue:h,customSetDataSourceFieldValue:z}){const q=ie({onDropdownClose:()=>q.resetSelectedOption()}),[E,L]=t.useState(k);me("",d);const[De,N]=t.useState(x),[$,_]=t.useState(0),f=t.useMemo(()=>ye(s,y,P,S,R,A),[$,s,y,P,S,R,A]);t.useEffect(()=>{N(void 0)},[E]);const V=()=>{let e=k;n&&l&&!n.isEmpty()&&(e=h?h():n.getFieldValue(l),e||(e="")),L(e)},B=t.useCallback(()=>{V()},[]),j=t.useCallback(e=>{n&&l&&((e.type===p.dataChanged||e.type===p.recordChanged||e.type===p.afterScroll||e.type===p.afterCancel)&&V(),e.type===p.onFieldError&&e.fieldName===l&&(N(e.error),_(u=>u+1)))},[]),W=t.useCallback(e=>{n&&l&&e.type===p.dataChanged&&_(u=>u+1)},[]),g=t.useCallback(()=>{if(!f)return{};const e=f.find(u=>u.value===E);return e||{}},[E,f]);te(()=>{V(),n&&l&&(n.addListener(j),n.addFieldChangeListener(l,B)),s&&s instanceof O&&s.addListener(W)}),re(()=>{n&&l&&(n.removeListener(j),n.removeFieldChangeListener(l,B)),s&&s instanceof O&&s.removeListener(W)}),oe(()=>{V()},[]);const G=e=>{if(L(u=>e),n&&!n.isBrowsing()&&l&&(h?h():n.getFieldValue(l))!==e&&(z?z(e):n.setFieldValue(l,e)),T){const u=f.find(ne=>ne.value===e);T(e,u?u.origin:void 0)}},ee=e=>{I&&I(e)},ae=e=>{F&&F(e)};return r(be,{value:{handleDropdownScrollEnded:()=>{}},children:le(b,{disabled:i,readOnly:(()=>{let e=a;return n&&!a&&(e=n.isBrowsing()),e})(),store:q,withinPortal:!0,position:Y,zIndex:X,onOptionSubmit:e=>{G(e),q.closeDropdown()},children:[r(se,{children:r(ce,{w:Q,required:K,leftSection:Z,leftSectionWidth:J,label:M,description:U,error:x,onBlur:ee,onFocus:ae,component:"button",type:"button",pointer:!0,rightSection:r(b.Chevron,{}),onClick:()=>q.toggleDropdown(),rightSectionPointerEvents:"none",multiline:!0,children:E?r(b.Option,{value:g().value,children:v?r(v,{...g()}):g().label},g().key):r(pe.Placeholder,{children:c})})}),r(de,{children:r(b.Options,{children:r(ue,{mah:280,children:f.map(e=>r(b.Option,{value:e.value,children:v?r(v,{...e}):e.label},e.key))})})})]})})}D.displayName="ArchbaseSelect";try{D.displayName="ArchbaseSelect",D.__docgenInfo={description:"",displayName:"ArchbaseSelect",props:{allowDeselect:{defaultValue:{value:"true"},description:"Permite ou não delecionar um item",name:"allowDeselect",required:!1,type:{name:"boolean"}},clearable:{defaultValue:{value:"true"},description:"Indicador se permite limpar o select",name:"clearable",required:!1,type:{name:"boolean"}},dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o item selecionado",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o item selecionado na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},debounceTime:{defaultValue:{value:"500"},description:"Tempo de espero antes de realizar a busca",name:"debounceTime",required:!1,type:{name:"number"}},disabled:{defaultValue:{value:"false"},description:"Indicador se o select está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:{value:"false"},description:"Indicador se o select é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},style:{defaultValue:null,description:"Estilo do select",name:"style",required:!1,type:{name:"CSSProperties"}},placeholder:{defaultValue:null,description:"Texto explicativo do select",name:"placeholder",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"Título do select",name:"label",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"Descrição do select",name:"description",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Último erro ocorrido no select",name:"error",required:!1,type:{name:"string"}},searchable:{defaultValue:{value:"false"},description:"Permite pesquisar no select",name:"searchable",required:!1,type:{name:"boolean"}},icon:{defaultValue:null,description:"Icon a esquerda do select",name:"icon",required:!1,type:{name:"ReactNode"}},iconWidth:{defaultValue:null,description:"Largura do icone a esquerda do select",name:"iconWidth",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},value:{defaultValue:null,description:"Valor de entrada controlado",name:"value",required:!1,type:{name:"any"}},defaultValue:{defaultValue:null,description:"Valor padrão de entrada não controlado",name:"defaultValue",required:!1,type:{name:"any"}},filter:{defaultValue:null,description:"Função com base em quais itens no menu suspenso são filtrados",name:"filter",required:!1,type:{name:"OptionsFilter"}},size:{defaultValue:null,description:"Tamanho de entrada",name:"size",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},initiallyOpened:{defaultValue:null,description:"Estado aberto do menu suspenso inicial",name:"initiallyOpened",required:!1,type:{name:"boolean"}},itemComponent:{defaultValue:null,description:"Alterar renderizador de item",name:"itemComponent",required:!1,type:{name:"FC<any>"}},width:{defaultValue:null,description:"Largura do select",name:"width",required:!1,type:{name:"string | number"}},onDropdownOpen:{defaultValue:null,description:"Chamado quando o menu suspenso é aberto",name:"onDropdownOpen",required:!1,type:{name:"() => void"}},onDropdownClose:{defaultValue:null,description:"Chamado quando o menu suspenso é aberto",name:"onDropdownClose",required:!1,type:{name:"() => void"}},limit:{defaultValue:null,description:"Limite a quantidade de itens exibidos por vez para seleção pesquisável",name:"limit",required:!1,type:{name:"number"}},nothingFound:{defaultValue:null,description:"Rótulo nada encontrado",name:"nothingFound",required:!1,type:{name:"ReactNode"}},zIndex:{defaultValue:null,description:"Índice z dropdown",name:"zIndex",required:!1,type:{name:"ZIndex"}},dropdownPosition:{defaultValue:null,description:"Comportamento de posicionamento dropdown",name:"dropdownPosition",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"right"'},{value:'"bottom"'},{value:'"left"'},{value:'"top-end"'},{value:'"top-start"'},{value:'"right-end"'},{value:'"right-start"'},{value:'"bottom-end"'},{value:'"bottom-start"'},{value:'"left-end"'},{value:'"left-start"'}]}},onSelectValue:{defaultValue:null,description:"Evento quando um valor é selecionado",name:"onSelectValue",required:!1,type:{name:"(value: O, origin: any) => void"}},onFocusExit:{defaultValue:null,description:"Evento quando o foco sai do select",name:"onFocusExit",required:!1,type:{name:"FocusEventHandler<T>"}},onFocusEnter:{defaultValue:null,description:"Evento quando o select recebe o foco",name:"onFocusEnter",required:!1,type:{name:"FocusEventHandler<T>"}},initialOptions:{defaultValue:{value:"[]"},description:"Opções de seleção iniciais",name:"initialOptions",required:!1,type:{name:"O[]"}},getOptionLabel:{defaultValue:null,description:"Function que retorna o label de uma opção",name:"getOptionLabel",required:!0,type:{name:"(option: O) => ReactNode"}},getOptionValue:{defaultValue:null,description:"Function que retorna o valor de uma opção",name:"getOptionValue",required:!0,type:{name:"(option: O) => any"}},children:{defaultValue:null,description:"Coleção de ArchbaseSelectItem[] que representam as opções do select",name:"children",required:!1,type:{name:"ReactNode | ReactNode[]"}},required:{defaultValue:null,description:"Indica se o select tem o preenchimento obrigatório",name:"required",required:!1,type:{name:"boolean"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}},options:{defaultValue:null,description:"Selecione os dados usados ​​para renderizar itens no menu suspenso",name:"options",required:!1,type:{name:"ArchbaseDataSource<any, any> | O[] | ArchbaseSelectItemProps<O>[]"}},optionsLabelField:{defaultValue:null,description:"",name:"optionsLabelField",required:!1,type:{name:"string"}},customGetDataSourceFieldValue:{defaultValue:null,description:"",name:"customGetDataSourceFieldValue",required:!1,type:{name:"() => any"}},customSetDataSourceFieldValue:{defaultValue:null,description:"",name:"customSetDataSourceFieldValue",required:!1,type:{name:"(value: any) => void"}}}}}catch{}export{D as A};
