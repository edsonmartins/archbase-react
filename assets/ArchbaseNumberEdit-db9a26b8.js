import{j as W}from"./jsx-runtime-c9381026.js";import{r as d}from"./index-8b3efc3f.js";import{R as w}from"./index-a38d0dca.js";import{e as ve,d as Z,b as be,c as J}from"./useArchbaseDataSource-c5d317be.js";import{u as Ve}from"./use-force-update-11fe72c1.js";import{D as v}from"./useArchbaseDataSourceListener-92dd263c.js";import{C as ye}from"./CloseButton-4d8718b4.js";import{T as Ne}from"./TextInput-64766eb5.js";function T(t,a=2,I=".",b=",",_=!1,M="",V="",P=Number.MIN_SAFE_INTEGER,C=Number.MAX_SAFE_INTEGER){if(a<0&&(a=0),a>20&&(a=20),t==null)return{value:0,maskedValue:""};if(t=String(t),t.length===0)return{value:0,maskedValue:""};let l=t.match(/\d/g)||["0"],s=!1;if(_){s=(t.match(/-/g)||[]).length%2===1;let y=!0;for(let N=0;N<l.length;N+=1)if(l[N]!=="0"){y=!1;break}y&&(s=!1)}for(;l.length<=a;)l.unshift("0");a>0&&l.splice(l.length-a,0,".");let r=Number(l.join(""));r=Math.min(Math.max(r,P),C),l=r.toFixed(a).split("");let i=l.length-a-1;a>0?l[i]=I:i=l.length;for(let c=i-3;c>0;c-=3)l.splice(c,0,b);return M.length>0&&l.unshift(M),V.length>0&&l.push(V),_&&s&&(l.unshift("-"),r=-r),{value:r,maskedValue:l.join("").trim()}}function F({dataSource:t,dataField:a,disabled:I=!1,readOnly:b=!1,style:_,className:M="",onFocusExit:V=()=>{},onFocusEnter:P=()=>{},onChangeValue:C=()=>{},value:l=0,decimalSeparator:s=",",thousandSeparator:r=".",precision:i=2,allowNegative:c=!0,allowEmpty:y=!1,clearable:N=!0,prefix:h="",suffix:f="",integer:qe=!1,wrapperProps:Ae,clearButtonProps:K,rightSection:Q,unstyled:Y,classNames:_e,width:ee,size:te,error:ae,innerRef:ne,onClear:L,minValue:x=Number.MIN_SAFE_INTEGER,maxValue:D=Number.MAX_SAFE_INTEGER,...le}){const[re,Me]=d.useState(!1),[E,q]=d.useState(""),se=ve(E),[oe,A]=d.useState(),u=ne||d.useRef(),[Ce,R]=d.useState(0),[B,S]=d.useState(0),[ie,j]=d.useState(ae),ue=Ve();d.useEffect(()=>{j(void 0)},[E,oe]);const G=()=>{let e=l;t&&a&&(e=t.getFieldValue(a),e||(e="")),!e||e===null?e=y?null:"":(typeof e=="string"&&(r==="."&&(e=e.replace(/\./g,"")),s!=="."&&(e=e.replace(new RegExp(s,"g"),".")),e=e.replace(/[^0-9-.]/g,""),e=Number.parseFloat(e)),e=Number(e).toLocaleString(void 0,{style:"decimal",minimumFractionDigits:i,maximumFractionDigits:i}));const n=T(e,i,s,r,c,h,f,x,D);return{maskedValue:n.maskedValue,value:n.value}};Z(()=>{t&&a&&(t.removeListener(O),t.removeFieldChangeListener(a,k))});const k=d.useCallback(()=>{$()},[]),$=()=>{if(t&&a){const e=t.getFieldValue(a),n=T(e,i,s,r,c,h,f,x,D);q(n.maskedValue),A(0)}},O=d.useCallback(e=>{t&&a&&((e.type===v.dataChanged||e.type===v.recordChanged||e.type===v.afterScroll||e.type===v.afterCancel||e.type===v.afterEdit)&&($(),ue()),e.type===v.onFieldError&&e.fieldName===a&&j(e.error))},[]);be(()=>{const e=G();q(e.maskedValue),A(e.value),t&&a&&(t.addListener(O),t.addFieldChangeListener(a,k));const n=w.findDOMNode(u.current),o=Math.min(n.selectionEnd?n.selectionEnd:0,n.value?n.value.length-f.length:0),m=Math.min(n.selectionStart?n.selectionStart:0,o);n.setSelectionRange(m,o)}),J(()=>{const e=w.findDOMNode(u.current),n=u!=null&&u.current?e.value:"",o=(n.match(/-/g)||[]).length%2===1,m=h.length+(o?1:0);let p=Math.max(m,Math.min(B,n.length-f.length)),g=Math.max(m,Math.min(B,p));const H=/[-[\]{}()*+?.,\\^$|#\s]/g,X=new RegExp(`${s.replace(H,"\\$&")}|${r.replace(H,"\\$&")}`,"g");if(E){const pe=`${se}`,ge=(E.match(X)||[]).length,he=(pe.match(X)||[]).length,z=Math.max(ge-he,0);p+=z,g+=z;const Ee=f.length+h.length+s.length+Number(i)+1;E.length===Ee&&(p=n.length-f.length,g=p),e.setSelectionRange(g,p),S(p),R(g)}},[re]),J(()=>{const e=G();q(e.maskedValue),A(e.value)},[]),Z(()=>{t&&a&&(t.removeListener(O),t.removeFieldChangeListener(a,k))});const de=e=>{e.preventDefault();const{maskedValue:n,value:o}=T(e.target.value,i,s,r,c,h,f,x,D);t&&!t.isBrowsing()&&a&&t.setFieldValue(a,o),e.persist(),q(m=>n),A(m=>o),C&&C(n,o,e)},U=e=>{S(0),R(0),V&&V(e)},me=e=>{const n=w.findDOMNode(u.current),o=u!=null&&u.current?n.value:"",m=o.length-f.length,p=(o.match(/-/g)||[]).length%2===1,g=h.length+(p?1:0);e.target.setSelectionRange(g,m),S(m),R(g)},ce=Q||(N&&l&&!b?W(ye,{variant:"transparent",onMouseDown:e=>e.preventDefault(),tabIndex:-1,onClick:()=>{q(e=>""),A(e=>0),t&&!t.isBrowsing()&&a&&t.setFieldValue(a,y?null:0),L&&L()},unstyled:Y,...K}):null),fe=()=>{let e=b;return t&&!b&&(e=t.isBrowsing()),e};return W(Ne,{disabled:!!I,...le,className:M,ref:u,type:"text",value:E,rightSection:ce,size:te,error:ie,style:{width:ee,..._},readOnly:fe(),onChange:de,onBlur:U,onFocus:me,onMouseUp:U,styles:{input:{textAlign:"right"}}})}F.defaultProps={onChangeValue:()=>{},value:"0",decimalSeparator:",",thousandSeparator:".",precision:2,allowNegative:!1,prefix:"",suffix:"",readOnly:!1,integer:!1,disabled:!1,onFocusExit:()=>{},onFocusEnter:()=>{},allowEmpty:!0};F.displayName="ArchbaseNumberEdit";try{F.displayName="ArchbaseNumberEdit",F.__docgenInfo={description:"",displayName:"ArchbaseNumberEdit",props:{clearable:{defaultValue:{value:"true"},description:"Determina se o valor de entrada pode ser limpo, adiciona o botão limpar à seção direita, falso por padrão",name:"clearable",required:!1,type:{name:"boolean"}},clearButtonProps:{defaultValue:null,description:"Adereços adicionados ao botão limpar",name:"clearButtonProps",required:!1,type:{name:"CloseButtonProps"}},dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o valor do number edit",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o valor do number edit na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"Indicador se o number edit está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:{value:"false"},description:"Indicador se o number edit é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},style:{defaultValue:null,description:"Estilo do number edit",name:"style",required:!1,type:{name:"CSSProperties"}},size:{defaultValue:null,description:"Tamanho do number edit",name:"size",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},width:{defaultValue:null,description:"Largura do number edit",name:"width",required:!1,type:{name:"string | number"}},className:{defaultValue:{value:""},description:"Nome da classe para estilo do number edit",name:"className",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Último erro ocorrido no number edit",name:"error",required:!1,type:{name:"string"}},onFocusExit:{defaultValue:{value:"() => { }"},description:"Evento quando o foco sai do edit",name:"onFocusExit",required:!1,type:{name:"FocusEventHandler<T>"}},onFocusEnter:{defaultValue:{value:"() => { }"},description:"Evento quando o edit recebe o foco",name:"onFocusEnter",required:!1,type:{name:"FocusEventHandler<T>"}},onChangeValue:{defaultValue:{value:"() => { }"},description:"Evento quando o valor do edit é alterado",name:"onChangeValue",required:!1,type:{name:"(maskValue: any, value: number, event: any) => void"}},value:{defaultValue:{value:"0"},description:"Valor inicial do campo",name:"value",required:!1,type:{name:"string | number"}},decimalSeparator:{defaultValue:{value:","},description:"Caracter separador decimal",name:"decimalSeparator",required:!1,type:{name:"string"}},thousandSeparator:{defaultValue:{value:"."},description:"Caracter separador de milhar",name:"thousandSeparator",required:!1,type:{name:"string"}},precision:{defaultValue:{value:"2"},description:"Número de casas decimais",name:"precision",required:!1,type:{name:"number"}},allowNegative:{defaultValue:{value:"false"},description:"Permite números negativos",name:"allowNegative",required:!1,type:{name:"boolean"}},allowEmpty:{defaultValue:{value:"true"},description:"Aceita em branco",name:"allowEmpty",required:!1,type:{name:"boolean"}},prefix:{defaultValue:{value:""},description:"Prefixo",name:"prefix",required:!1,type:{name:"string"}},suffix:{defaultValue:{value:""},description:"Sufixo",name:"suffix",required:!1,type:{name:"string"}},integer:{defaultValue:{value:"false"},description:"Indicador se aceita apenas números inteiros",name:"integer",required:!1,type:{name:"boolean"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}},onClear:{defaultValue:null,description:"Evento quando o valor for limpado",name:"onClear",required:!1,type:{name:"() => void"}},minValue:{defaultValue:{value:"Number.MIN_SAFE_INTEGER"},description:"Valor mínimo permitido",name:"minValue",required:!1,type:{name:"number"}},maxValue:{defaultValue:{value:"Number.MAX_SAFE_INTEGER"},description:"Valor máximo permitido",name:"maxValue",required:!1,type:{name:"number"}}}}}catch{}export{F as A};
