import{j as v,F as Ae,a as X}from"./jsx-runtime-c9381026.js";import{d as F}from"./dayjs.min-5b59225a.js";import{r as c}from"./index-8b3efc3f.js";import{I as Ie}from"./input-30511812.js";import{c as _e,a as xe}from"./string-utils-046f5c60.js";import{b as Te,c as Ne,d as Oe}from"./useArchbaseDataSource-bc04723a.js";import"./index-9e992aa6.js";import{u as Le}from"./use-input-props-5361677b.js";import{u as je,C as Be,H as Re,p as He}from"./pick-calendar-levels-props-31ce4af0.js";import{u as L}from"./use-uncontrolled-f56237fb.js";import{u as ze}from"./use-force-update-11fe72c1.js";import{D}from"./useArchbaseDataSourceListener-92dd263c.js";import{C as Ue,I as j}from"./Input-7a6e621e.js";import{u as We}from"./use-did-update-bccd292e.js";import{P as B}from"./Popover-62e4c870.js";const b={"DD/MM/YYYY":{mask:"00/00/0000",format:a=>{if(!a)return"";const t=String(a.getDate()).padStart(2,"0"),o=String(a.getMonth()+1).padStart(2,"0"),n=a.getFullYear();return[t,o,n].join("/")},parse:a=>{const[t,o,n]=a.split("/");return new Date(n,o-1,t)}},"DD-MM-YYYY":{mask:"00-00-0000",format:a=>{if(!a)return"";const t=String(a.getDate()).padStart(2,"0"),o=String(a.getMonth()+1).padStart(2,"0"),n=a.getFullYear();return[t,o,n].join("-")},parse:a=>{const[t,o,n]=a.split("-");return new Date(n,o-1,t)}},"YYYY/MM/DD":{mask:"`0000/00/00",format:a=>{if(!a)return"";const t=String(a.getDate()).padStart(2,"0"),o=String(a.getMonth()+1).padStart(2,"0");return[a.getFullYear(),o,t].join("/")},parse:a=>{const[t,o,n]=a.split("/");return new Date(t,o-1,n)}},"YYYY-MM-DD":{mask:"`0000-00-00",format:a=>{if(!a)return"";const t=String(a.getDate()).padStart(2,"0"),o=String(a.getMonth()+1).padStart(2,"0");return[a.getFullYear(),o,t].join("-")},parse:a=>{const[t,o,n]=a.split("-");return new Date(t,o-1,n)}}};function Ge(a){const t=new Date(a);return Number.isNaN(t.getTime())||!a?null:t}function Je(a,t){if(!a||!t)return t;const o=a.getHours(),n=a.getMinutes(),V=a.getSeconds(),P=a.getMilliseconds(),f=new Date(t);return f.setHours(o),f.setMinutes(n),f.setSeconds(V),f.setMilliseconds(P),f}function Z({date:a,maxDate:t,minDate:o}){return!(a==null||Number.isNaN(a.getTime())||t&&F(a).isAfter(t,"date")||o&&F(a).isBefore(o,"date"))}const Ke={fixOnBlur:!0,preserveTime:!0,size:"sm",readOnly:!1,disabled:!1,clearable:!0,required:!1,placeholderChar:"_",showPlaceholderFormat:!0,dateFormat:"DD/MM/YYYY"};function R(a){const{inputProps:t,wrapperProps:o,value:n,defaultValue:V,onChange:P,clearable:f,clearButtonProps:$,popoverProps:ee,getDayProps:Y,locale:Qe,dateParser:ae,minDate:M,maxDate:k,fixOnBlur:te,onFocus:w,onBlur:A,onClick:I,readOnly:_,name:H,form:z,rightSection:re,unstyled:U,classNames:oe,styles:ne,allowDeselect:le,preserveTime:ue,date:se,defaultDate:ie,onDateChange:de,showPlaceholderFormat:ce,placeholderChar:pe,dateFormat:E,dataSource:u,dataField:s,width:me,innerRef:fe,title:ve,...he}=Le("ArchbaseDatePickerEdit",Ke,a),{calendarProps:ye,others:De}=He(he),Ee=fe||c.useRef(),W=je(),[p,m,G]=L({value:n,defaultValue:V,finalValue:null,onChange:P}),[ge,x]=c.useState(a.error),be=ze(),[T,h]=L({value:se,defaultValue:V||ie,finalValue:null,onChange:de}),y=e=>e?b[E].format(e):"",[N,i]=L({value:y(p)}),Ve=e=>{const r=b[E].parse(e);return Number.isNaN(r.getTime())?Ge(e):r},d=()=>{let e=_;return u&&!_&&(e=u.isBrowsing()),e},qe=ae||Ve,q=f||le,J=c.useCallback(()=>{S()},[]),K=c.useCallback(e=>{u&&s&&((e.type===D.dataChanged||e.type===D.recordChanged||e.type===D.afterScroll||e.type===D.afterCancel||e.type===D.afterEdit)&&(S(),be()),e.type===D.onFieldError&&e.fieldName===s&&x(e.error))},[]),S=c.useCallback(()=>{if(u&&s){const e=u.getFieldValue(s);if(e){const r=_e(e),l=b[E].format(r);l!==N&&(i(l),h(r),m(r))}else i(""),h(null),m(null)}},[]),g=c.useCallback(e=>{if(u&&s){const r=u.getFieldValue(s);if(!e||e===null)e!==r&&u.setFieldValue(s,e);else{const l=xe(e);l!==r&&u.setFieldValue(s,l)}}},[]);Te(()=>{S(),u&&s&&(u.addListener(K),u.addFieldChangeListener(s,J))}),Ne(()=>{S()},[]),Oe(()=>{u&&s&&(u.removeListener(K),u.removeFieldChangeListener(s,J))}),c.useEffect(()=>{x(void 0)},[p,T,N]),c.useEffect(()=>{G&&h(n)},[G,n]),c.useEffect(()=>{i(y(p))},[W.locale]);const[Q,C]=c.useState(!1),Se=e=>{if(!d()){const r=e.currentTarget.value;if(i(r),r.trim()===""&&q)m(null),g(null);else{const l=qe(r);Z({date:l,minDate:M,maxDate:k})&&(m(l),h(l))}}},Ce=e=>{if(!d()){if(e.trim()===""&&q)m(null),g(null);else if(e&&e.length===10){const r=b[E].parse(e);Z({date:r,minDate:M,maxDate:k})&&(m(r),h(r),i(y(r)),g(r))}}},Fe=(e,r)=>{d()||r.masked.rawInputValue===""&&q&&(m(null),h(null),g(null),i(""))},Pe=e=>{A==null||A(e),C(!1),d()||te&&i(y(p))},Ye=e=>{d()||(w==null||w(e),C(!0))},Me=e=>{d()||(I==null||I(e),C(!0))},ke=e=>({...Y==null?void 0:Y(e),selected:F(p).isSame(e,"day"),onClick:()=>{if(!d()){const r=ue?Je(p,e):e,l=q&&F(p).isSame(e,"day")?null:r;m(l),i(y(l)),x(void 0),C(!1)}}}),we=re||(f&&p&&!d()?v(Ue,{variant:"transparent",onMouseDown:e=>e.preventDefault(),tabIndex:-1,onClick:()=>{m(null),i(""),g(null)},unstyled:U,...$}):null);return We(()=>{n!==void 0&&!Q&&i(y(n))},[n]),v(Ae,{children:X(j.Wrapper,{...o,error:ge,label:ve||a.label,children:[X(B,{opened:Q,trapFocus:!1,position:"bottom-start",disabled:d(),withinPortal:!0,withRoles:!1,...ee,children:[v(B.Target,{children:v(j.Wrapper,{required:a.required,__staticSelector:"ArchbaseDatePickerEdit",children:v(j,{"data-dates-input":!0,"data-read-only":_||void 0,autoComplete:"off",ref:Ee,component:Ie,rightSection:we,lazy:!ce,placeholderChar:pe,mask:b[E].mask,onBlur:Pe,onFocus:Ye,onClick:Me,onComplete:Ce,onChange:Se,onAccept:Fe,readOnly:d(),value:N,style:{width:me,...a.style},...t,...De,format:e=>{if(!e)return"";const r=String(e.getDate()).padStart(2,"0"),l=String(e.getMonth()+1).padStart(2,"0"),O=e.getFullYear();return[r,l,O].join("/")},parse:e=>{const[r,l,O]=e.split("/");return new Date(O,l-1,r)}})})}),v(B.Dropdown,{onMouseDown:e=>e.preventDefault(),"data-dates-dropdown":!0,children:v(Be,{__staticSelector:"ArchbaseDatePickerEdit",...ye,classNames:oe,styles:ne,unstyled:U,__preventFocus:!0,minDate:M,maxDate:k,locale:W.locale,getDayProps:ke,size:t.size,date:T||void 0,onDateChange:h})})]}),v(Re,{name:H||"",form:z||"",value:p,type:"default"})]})})}R.displayName="ArchbaseDatePickerEdit";try{R.displayName="ArchbaseDatePickerEdit",R.__docgenInfo={description:"",displayName:"ArchbaseDatePickerEdit",props:{dateParser:{defaultValue:null,description:"Analisa a entrada do usuário para convertê-la em um objeto Date",name:"dateParser",required:!1,type:{name:"(value: string) => Date"}},value:{defaultValue:null,description:"Valor do componente controlado",name:"value",required:!1,type:{name:"Date"}},defaultValue:{defaultValue:null,description:"Valor padrão para componente não controlado",name:"defaultValue",required:!1,type:{name:"Date"}},onChange:{defaultValue:null,description:"Chamado quando o valor muda",name:"onChange",required:!1,type:{name:"(value: Date) => void"}},popoverProps:{defaultValue:null,description:"Adereços adicionados ao componente Popover",name:"popoverProps",required:!1,type:{name:'Partial<Omit<PopoverProps, "children">>'}},clearable:{defaultValue:null,description:"Determina se o valor de entrada pode ser limpo, adiciona o botão limpar à seção direita, falso por padrão",name:"clearable",required:!1,type:{name:"boolean"}},clearButtonProps:{defaultValue:null,description:"Adereços adicionados ao botão limpar",name:"clearButtonProps",required:!1,type:{name:"CloseButtonProps"}},fixOnBlur:{defaultValue:null,description:"Determina se o valor de entrada deve ser revertido para o último valor válido conhecido no desfoque, verdadeiro por padrão",name:"fixOnBlur",required:!1,type:{name:"boolean"}},allowDeselect:{defaultValue:null,description:"Determina se o valor pode ser desmarcado quando o usuário clica na data selecionada no calendário ou apaga o conteúdo da entrada, verdadeiro se prop limpável estiver definido, falso por padrão",name:"allowDeselect",required:!1,type:{name:"boolean"}},preserveTime:{defaultValue:null,description:"Determina se o tempo (horas, minutos, segundos e milissegundos) deve ser preservado quando uma nova data é escolhida, verdadeiro por padrão",name:"preserveTime",required:!1,type:{name:"boolean"}},maxLevel:{defaultValue:null,description:"Nível máximo que o usuário pode atingir (década, ano, mês), o padrão é década",name:"maxLevel",required:!1,type:{name:"enum",value:[{value:'"month"'},{value:'"year"'},{value:'"decade"'}]}},defaultLevel:{defaultValue:null,description:"Nível inicial exibido ao usuário (década, ano, mês), usado para componente não controlado",name:"defaultLevel",required:!1,type:{name:"enum",value:[{value:'"month"'},{value:'"year"'},{value:'"decade"'}]}},level:{defaultValue:null,description:"Nível atual exibido ao usuário (década, ano, mês), usado para componente controlado",name:"level",required:!1,type:{name:"enum",value:[{value:'"month"'},{value:'"year"'},{value:'"decade"'}]}},onLevelChange:{defaultValue:null,description:"Chamado quando o nível muda",name:"onLevelChange",required:!1,type:{name:"(level: CalendarLevel) => void"}},dataSource:{defaultValue:null,description:"Fonte de dados onde será atribuido o valor do datePicker",name:"dataSource",required:!1,type:{name:"ArchbaseDataSource<T, ID>"}},dataField:{defaultValue:null,description:"Campo onde deverá ser atribuido o valor do datePicker na fonte de dados",name:"dataField",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"Indicador se o date picker está desabilitado",name:"disabled",required:!1,type:{name:"boolean"}},readOnly:{defaultValue:null,description:"Indicador se o date picker é somente leitura. Obs: usado em conjunto com o status da fonte de dados",name:"readOnly",required:!1,type:{name:"boolean"}},style:{defaultValue:null,description:"Estilo do date picker",name:"style",required:!1,type:{name:"CSSProperties"}},size:{defaultValue:null,description:"Tamanho do date picker",name:"size",required:!1,type:{name:"enum",value:[{value:'"xs"'},{value:'"sm"'},{value:'"md"'},{value:'"lg"'},{value:'"xl"'}]}},width:{defaultValue:null,description:"Largura do date picker",name:"width",required:!1,type:{name:"string | number"}},dateFormat:{defaultValue:null,description:"Possíveis formatos para a data",name:"dateFormat",required:!1,type:{name:"enum",value:[{value:'"DD/MM/YYYY"'},{value:'"DD-MM-YYYY"'},{value:'"YYYY/MM/DD"'},{value:'"YYYY-MM-DD"'}]}},placeholderChar:{defaultValue:null,description:"Caracter a ser mostrado quando não houver um valor",name:"placeholderChar",required:!1,type:{name:"string"}},showPlaceholderFormat:{defaultValue:null,description:"Indicador se o caracter deve ser mostrado quando não houver um valor",name:"showPlaceholderFormat",required:!1,type:{name:"boolean"}},onFocusExit:{defaultValue:null,description:"Evento quando o foco sai do date picker",name:"onFocusExit",required:!1,type:{name:"FocusEvent<HTMLInputElement, Element>"}},onFocusEnter:{defaultValue:null,description:"Evento quando o date picker recebe o foco",name:"onFocusEnter",required:!1,type:{name:"FocusEvent<HTMLInputElement, Element>"}},required:{defaultValue:null,description:"Indica se o date picker tem o preenchimento obrigatório",name:"required",required:!1,type:{name:"boolean"}},innerRef:{defaultValue:null,description:"Referência para o componente interno",name:"innerRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}},error:{defaultValue:null,description:"Último erro ocorrido no datepicker",name:"error",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"Título do edit",name:"title",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"Título do edit",name:"label",required:!1,type:{name:"string"}}}}}catch{}export{R as A};
